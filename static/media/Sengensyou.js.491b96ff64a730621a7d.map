{:version=>3, :sections=>[{:offset=>{:line=>0, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/Sengensyou.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module GameSystem\n    class Sengensyou < Base\n      # ゲームシステムの識別子\n      ID = 'Sengensyou'\n\n      # ゲームシステム名\n      NAME = '千幻抄'\n\n      # ゲームシステム名の読みがな\n      SORT_KEY = 'せんけんしよう'\n\n      # ダイスボットの使い方\n      HELP_MESSAGE = <<~INFO_MESSAGE_TEXT\n        ・SGS　命中判定・回避判定\n      INFO_MESSAGE_TEXT\n\n      register_prefix('SGS')\n\n      def eval_game_system_specific_command(command)\n        # 命中判定・回避判定\n        parser = Command::Parser.new('SGS', round_type: @round_type).restrict_cmp_op_to(nil)\n        command = parser.parse(command)\n\n        unless command\n          return nil\n        end\n\n        dice_list = @randomizer.roll_barabara(3, 6)\n        dice_total = dice_list.sum()\n        is_critical = dice_total >= 16\n        is_fumble = dice_total <= 5\n        additional_text =\n          if is_critical\n            \"クリティカル\"\n          elsif is_fumble\n            \"ファンブル\"\n          end\n        modify_text = \"\#{dice_total}\#{Format.modifier(command.modify_number)}\" if command.modify_number != 0\n        sequence = [\n          \"(3D6\#{Format.modifier(command.modify_number)})\",\n          \"\#{dice_total}[\#{dice_list.join(',')}]\",\n          modify_text,\n          (dice_total + command.modify_number).to_s,\n          additional_text,\n        ].compact\n\n        result = Result.new.tap do |r|\n          r.text = sequence.join(\" ＞ \")\n          r.critical = is_critical\n          r.fumble = is_fumble\n        end\n        return result\n      end\n    end\n  end\nend\n"], :names=>["<main>", "<module:BCDice>", "<module:GameSystem>", "<class:Sengensyou>", "self", "register_prefix", "eval_game_system_specific_command", "command", "parser", "Command::Parser", "Command", "new", "@round_type", "restrict_cmp_op_to", "parse", "dice_list", "@randomizer", "roll_barabara", "3", "6", "dice_total", "sum", "is_critical", ">=", "16", "is_fumble", "<=", "5", "additional_text", "modify_number", "0", "modify_text", "Format", "modifier", "sequence", "join", "+", "to_s", "compact", "result", "tap", "Result", "block in eval_game_system_specific_command", "r", "block (2 levels) in eval_game_system_specific_command", "text=", "critical=", "fumble=", "Base"], :mappings=>"AAAAA,2BAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAEE,8BAAKA,YAAL;QAGA,gCAAOA,KAAP;QAGA,oCAAWA,SAAX;QAGA,wCAAeA,kBAAf;QAIAC,IAAAC,iBAAAA,CAAgBF,KAAhBE;QAEAF,OAAAG,iDAAAA,6CAAsCC,OAAtCD;AAAAA,UAAAA;;;UAEEE,SAASC,IAAAC,aAAAD,WAAeE,KAAAA,CAAKL,KAApB,EAA2B,wBAAA,cAAYM,eAAZ,EAAZD,CAAoCE,oBAAAA,CAAoB,GAApBA;UAC5DN,UAAUC,MAAMM,OAAAA,CAAOP,OAAPO;UAEhB,KAAA,QAAOP,OAAP,CAAA;YACE,OAAO;UADT;UAIAQ,YAAYC,eAAWC,eAAAA,CAAeC,CAA1B,EAA6BC,CAAlBF;UACvBG,aAAaL,SAASM,KAAAA,CAAAA;UACtBC,cAAyBC,OAAXH,UAAWG,EAAGC,EAAHD;UACzBE,YAAuBC,OAAXN,UAAWM,EAAGC,CAAHD;UACvBE,kBACE,CAAA,QAAGN,WAAH,CAAA,GAAA,CACEhB,QADF,IAEA,CAAA,QAAMmB,SAAN,CAAA,GAAA,CACEnB,OADF,IAAA,GAAA,CAFA;UAKF,IAAA,OAA0EC,OAAOsB,eAAAA,CAAAA,CAAjF,EAAmGC,CAAnG,CAAA;YAAAC,cAAc,EAAA,GAAA,CAAGX,UAAH,CAAA,GAAA,CAAgBY,YAAMC,UAAAA,CAAU1B,OAAOsB,eAAAA,CAAAA,CAAjBI,CAAtB;UAAd;UACAC,WAAW,CACR5B,MAAD,GAAA,CAAO0B,YAAMC,UAAAA,CAAU1B,OAAOsB,eAAAA,CAAAA,CAAjBI,CAAb,CAAA,GAA8C3B,GADrC,EAET,EAAA,GAAA,CAAGc,UAAH,CAAA,GAAcd,GAAd,GAAA,CAAiBS,SAASoB,MAAAA,CAAM7B,GAAN6B,CAA1B,CAAA,GAAqC7B,GAF5B,EAGTyB,WAHS,EAIGK,SAAXhB,UAAWgB,EAAE7B,OAAOsB,eAAAA,CAAAA,CAATO,CAAwBC,MAAAA,CAAAA,CAJ3B,EAKTT,eALS,CAMVU,SAAAA,CAAAA;UAEDC,SAAmBC,MAAVC,YAAM9B,KAAAA,CAAAA,CAAI6B,OAAAA,EAAAA,EAAAA,EAAVE,aAAmBC,CAAnBD,EAAAE;;;YAAmB;YAC1BD,CAACE,UAAAA,CAAQX,QAAQC,MAAAA,CAAMS,KAANT,CAAhBU;YACDF,CAACG,cAAAA,CAAYxB,WAAZwB;YACDF,OAACG,MAAAA,CAAUtB,SAAVsB,CAAAA,EAAAA,MAADJ,CAACI,WAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAHML,CAAUF;UAKnB,OAAOD;QAjCTjC,CAAAA;MAjBFH,GAAAA,WAAAA,EAAmB6C,UAAnB7C;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}]}