{:version=>3, :sections=>[{:offset=>{:line=>0, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/SharedFantasia.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module GameSystem\n    class SharedFantasia < Base\n      # ゲームシステムの識別子\n      ID = 'SharedFantasia'\n\n      # ゲームシステム名\n      NAME = 'Shared†Fantasia'\n\n      # ゲームシステム名の読みがな\n      SORT_KEY = 'しえああとふあんたしあ'\n\n      # ダイスボットの使い方\n      HELP_MESSAGE = <<~MESSAGETEXT\n        2D6の成功判定に 自動成功、自動失敗、致命的失敗、劇的成功 の判定があります。\n\n        SF/ST = 2D6のショートカット\n\n        例) SF+4>=9 : 2D6して4を足した値が9以上なら成功\n      MESSAGETEXT\n\n      register_prefix('SF', 'ST')\n\n      def change_text(string)\n        string.gsub(/S[FT]/i, \"2D6\")\n      end\n\n      def result_2d6(total, dice_total, _dice_list, cmp_op, target)\n        return Result.nothing if target == '?'\n        return nil unless [:>=, :>].include?(cmp_op)\n\n        critical = false\n        fumble   = false\n\n        if dice_total == 12\n          critical = true\n        elsif dice_total == 2\n          fumble = true\n        end\n\n        totalValueBonus = (cmp_op == :>= ? 1 : 0)\n\n        if (total + totalValueBonus) > target\n          if critical\n            Result.critical(\"自動成功(劇的成功)\")\n          elsif fumble\n            Result.failure(\"自動失敗\")\n          else\n            Result.success(\"成功\")\n          end\n        else\n          if critical\n            Result.success(\"自動成功\")\n          elsif fumble\n            Result.fumble(\"自動失敗(致命的失敗)\")\n          else\n            Result.failure(\"失敗\")\n          end\n        end\n      end\n    end\n  end\nend\n"], :names=>["<main>", "<module:BCDice>", "<module:GameSystem>", "<class:SharedFantasia>", "self", "register_prefix", "change_text", "string", "gsub", "result_2d6", "total", "dice_total", "_dice_list", "cmp_op", "target", "Result", "nothing", "include?", "critical", "fumble", "12", "2", "totalValueBonus", "1", "0", ">", "+", "failure", "success", "Base"], :mappings=>"AAAAA,2BAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;;QAEE,8BAAKA,gBAAL;QAGA,gCAAOA,iBAAP;QAGA,oCAAWA,aAAX;QAGA,wCACNA,4CADqB,GAErBA,IAFqB,GAGrBA,uBAHqB,GAIrBA,IAJqB,GAKrBA,oCALM;QAQAC,IAAAC,iBAAAA,CAAgBF,IAAhB,EAAsBA,IAAtBE;;AAEAC,QAAAA,2BAAAA,uBAAgBC,MAAhBD;AAAAA;UACEA,OAAAC,MAAMC,MAAAA,CAAM,QAAZ,EAAsBF,KAAhBE;QADRF,CAAAA;QAIAH,OAAAM,0BAAAA,sBAAeC,KAAD,EAAQC,UAAR,EAAoBC,UAApB,EAAgCC,MAAhC,EAAwCC,MAAtDL;AAAAA,UAAAA;;;UACE,IAAA,MAAyBK,MAAzB,EAAmCL,GAAnC,CAAA;YAAA,OAAOM,YAAMC,SAAAA,CAAAA;UAAb;UACA,KAAA,QAAkB,CAAC,IAAD,EAAM,GAAN,CAASC,aAAAA,CAAUJ,MAAVI,CAA3B,CAAA;YAAA,OAAO;UAAP;UAEAC,WAAW;UACXC,SAAW;UAEX,IAAA,MAAGR,UAAH,EAAiBS,EAAjB,CAAA;YACEF,WAAW;UADb,OAEA,IAAA,MAAMP,UAAN,EAAoBU,CAApB,CAAA;YACEF,SAAS;UADX;UAIAG,kBAAmB,CAAA,MAAAT,MAAA,EAAU,IAAV,CAAA,GAAA,CAAgBU,CAAhB,IAAA,CAAoBC,CAApB,CAAA;UAEnB,IAAA,QAA6BC,OAAnBC,SAANhB,KAAMgB,EAAEJ,eAAFI,CAAmBD,EAAEX,MAAFW,CAA7B,CAAA;YACE,IAAA,QAAGP,QAAH,CAAA;cACET,OAAAM,YAAMG,UAAAA,CAAUT,YAAVS;YADR,OAEA,IAAA,QAAMC,MAAN,CAAA;cACEV,OAAAM,YAAMY,SAAAA,CAASlB,MAATkB;YADR;cAGElB,OAAAM,YAAMa,SAAAA,CAASnB,IAATmB;YAHR;UAHF,OASE,IAAA,QAAGV,QAAH,CAAA;YACET,OAAAM,YAAMa,SAAAA,CAASnB,MAATmB;UADR,OAEA,IAAA,QAAMT,MAAN,CAAA;YACEV,OAAAM,YAAMI,QAAAA,CAAQV,aAARU;UADR;YAGEV,OAAAM,YAAMY,SAAAA,CAASlB,IAATkB;UAHR;QA1BJlB,CAAAA;MAzBFN,GAAAA,WAAAA,EAAuB0B,UAAvB1B;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}]}