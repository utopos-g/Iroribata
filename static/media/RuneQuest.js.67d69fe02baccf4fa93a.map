{:version=>3, :sections=>[{:offset=>{:line=>0, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/RuneQuest.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module GameSystem\n    class RuneQuest < Base\n      # ゲームシステムの識別子\n      ID = 'RuneQuest'\n\n      # ゲームシステム名\n      NAME = 'ルーンクエスト'\n\n      # ゲームシステム名の読みがな\n      SORT_KEY = 'るうんくえすと'\n\n      # ダイスボットの使い方\n      HELP_MESSAGE = <<~INFO_MESSAGE_TEXT\n        クリティカル、エフェクティブ(効果的成功)、ファンブルの自動判定を行います。\n      INFO_MESSAGE_TEXT\n\n      # ゲーム別成功度判定(1d100)\n      def result_1d100(total, _dice_total, cmp_op, target)\n        return Result.nothing if target == '?'\n        return nil unless cmp_op == :<=\n\n        # RuneQuest QUICK-START RULESを元に修正\n        # https://www.chaosium.com/content/FreePDFs/RuneQuest/CHA4027%20-%20RuneQuest%20Quickstart.pdf\n        critical_value = (target.to_f / 20).round\n\n        if (total <= 1) || (total <= critical_value)\n          # 1は常に決定的成功\n          Result.critical(\"決定的成功\")\n        elsif total >= 100\n          # 100は常に致命的失敗\n          Result.fumble(\"致命的失敗\")\n        elsif total <= (target.to_f / 5).round\n          Result.success(\"効果的成功\")\n        elsif total <= target\n          Result.success(\"成功\")\n        elsif total >= 95 + critical_value\n          Result.fumble(\"致命的失敗\")\n        else\n          Result.failure(\"失敗\")\n        end\n      end\n    end\n  end\nend\n"], :names=>["<main>", "<module:BCDice>", "<module:GameSystem>", "<class:RuneQuest>", "result_1d100", "total", "_dice_total", "cmp_op", "target", "Result", "nothing", "critical_value", "/", "to_f", "20", "round", "<=", "1", "critical", ">=", "100", "fumble", "5", "success", "+", "95", "failure", "Base"], :mappings=>"AAAAA,2BAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;;QAEE,8BAAKA,WAAL;QAGA,gCAAOA,SAAP;QAGA,oCAAWA,SAAX;QAGA,wCAAeA,0CAAf;QAKAA,OAAAC,4BAAAA,wBAAiBC,KAAD,EAAQC,WAAR,EAAqBC,MAArB,EAA6BC,MAA7CJ;AAAAA,UAAAA;;;UACE,IAAA,MAAyBI,MAAzB,EAAmCJ,GAAnC,CAAA;YAAA,OAAOK,YAAMC,SAAAA,CAAAA;UAAb;UACA,KAAA,MAAkBH,MAAlB,EAA4B,IAA5B,CAAA;YAAA,OAAO;UAAP;UAIAI,iBAA8BC,WAAZJ,MAAMK,MAAAA,CAAAA,CAAMD,EAAEE,EAAFF,CAAKG,OAAAA,CAAAA;UAEnC,IAAG,CAAA,QAAOC,OAANX,KAAMW,EAAGC,CAAHD,CAAP,CAAA,IAAA,CAAA,QAAuBA,OAANX,KAAMW,EAAGL,cAAHK,CAAvB,CAAA,CAAA,CAAH;YAEEZ,OAAAK,YAAMS,UAAAA,CAAUd,OAAVc;UAFR,OAGA,IAAA,QAAYC,OAANd,KAAMc,EAAGC,GAAHD,CAAZ,CAAA;YAEEf,OAAAK,YAAMY,QAAAA,CAAQjB,OAARiB;UAFR,OAGA,IAAA,QAAYL,OAANX,KAAMW,EAAgBJ,WAAZJ,MAAMK,MAAAA,CAAAA,CAAMD,EAAEU,CAAFV,CAAIG,OAAAA,CAAAA,CAApBC,CAAZ,CAAA;YACEZ,OAAAK,YAAMc,SAAAA,CAASnB,OAATmB;UADR,OAEA,IAAA,QAAYP,OAANX,KAAMW,EAAGR,MAAHQ,CAAZ,CAAA;YACEZ,OAAAK,YAAMc,SAAAA,CAASnB,IAATmB;UADR,OAEA,IAAA,QAAYJ,OAANd,KAAMc,EAAMK,SAAHC,EAAGD,EAAEb,cAAFa,CAANL,CAAZ,CAAA;YACEf,OAAAK,YAAMY,QAAAA,CAAQjB,OAARiB;UADR;YAGEjB,OAAAK,YAAMiB,SAAAA,CAAStB,IAATsB;UAHR;QAlBFtB,CAAAA;MAhBFD,GAAAA,WAAAA,EAAkBwB,UAAlBxB;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}]}