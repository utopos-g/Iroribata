{:version=>3, :sections=>[{:offset=>{:line=>0, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/arithmetic_evaluator.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module ArithmeticEvaluator\n    class << self\n      # 四則演算を評価する\n      # @deprecated +Arithmetic.#eval+ を利用してください。\n      # @param expr [String, nil] 評価する式\n      # @param round_type [Symbol] 端数処理の種類\n      # @return [Integer] 評価結果を返す。不正な式の場合には0を返す。\n      def eval(expr, round_type: RoundType::FLOOR)\n        return 0 unless expr\n\n        Arithmetic.eval(expr, round_type) || 0\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:ArithmeticEvaluator>", "eval", "expr", "$kwargs", "RoundType::FLOOR", "RoundType", "0", "$ret_or_1", "Arithmetic", "round_type", "self"], :mappings=>"AAAAA,8CAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAA;QAAA;;QAME,OAAAC,oBAAAA,iBAASC,IAAD,EAVdC,OAUMF,GAAAA,MAAAA,IAAAA,wCAAAA;AAAAA,UAAAA;;;UAVN;;UAUqB,0CAAA,qCAAYG,IAAAC,eAAAD;UACzB,KAAA,QAAgBF,IAAhB,CAAA;YAAA,OAAOI;UAAP;UAEA,IAAA,QAAAC,CAAAA,YAAAC,gBAAUP,MAAAA,CAAMC,IAAhB,EAAsBO,UAAZR,CAAVM,CAAA,CAAA;YAAAN,OAAA;UAAA;YAAqCA,OAAAK;UAArC,EAHFL;YAAAA;YAAAA;UAAAA;QAAAA,CAAAA,IAAAA;MANF,4BAASS,IAAT;IADFV,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>40, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["i18n/backend/fallbacks.rb"], :sourcesContent=>["# frozen_string_literal: true\n\n# I18n locale fallbacks are useful when you want your application to use\n# translations from other locales when translations for the current locale are\n# missing. E.g. you might want to use :en translations when translations in\n# your applications main locale :de are missing.\n#\n# To enable locale fallbacks you can simply include the Fallbacks module to\n# the Simple backend - or whatever other backend you are using:\n#\n#   I18n::Backend::Simple.include(I18n::Backend::Fallbacks)\nmodule I18n\n  @@fallbacks = nil\n\n  class << self\n    # Returns the current fallbacks implementation. Defaults to +I18n::Locale::Fallbacks+.\n    def fallbacks\n      @@fallbacks ||= I18n::Locale::Fallbacks.new\n      Thread.current[:i18n_fallbacks] || @@fallbacks\n    end\n\n    # Sets the current fallbacks implementation. Use this to set a different fallbacks implementation.\n    def fallbacks=(fallbacks)\n      @@fallbacks = fallbacks.is_a?(Array) ? I18n::Locale::Fallbacks.new(fallbacks) : fallbacks\n      Thread.current[:i18n_fallbacks] = @@fallbacks\n    end\n  end\n\n  module Backend\n    module Fallbacks\n      # Overwrites the Base backend translate method so that it will try each\n      # locale given by I18n.fallbacks for the given locale. E.g. for the\n      # locale :\"de-DE\" it might try the locales :\"de-DE\", :de and :en\n      # (depends on the fallbacks implementation) until it finds a result with\n      # the given options. If it does not find any result for any of the\n      # locales it will then throw MissingTranslation as usual.\n      #\n      # The default option takes precedence over fallback locales only when\n      # it's a Symbol. When the default contains a String, Proc or Hash\n      # it is evaluated last after all the fallback locales have been tried.\n      def translate(locale, key, options = EMPTY_HASH)\n        return super unless options.fetch(:fallback, true)\n        return super if options[:fallback_in_progress]\n        default = extract_non_symbol_default!(options) if options[:default]\n\n        fallback_options = options.merge(:fallback_in_progress => true)\n        I18n.fallbacks[locale].each do |fallback|\n          begin\n            catch(:exception) do\n              result = super(fallback, key, fallback_options)\n              unless result.nil?\n                on_fallback(locale, fallback, key, options) if locale.to_s != fallback.to_s\n                return result\n              end\n            end\n          rescue I18n::InvalidLocale\n            # we do nothing when the locale is invalid, as this is a fallback anyways.\n          end\n        end\n\n        return if options.key?(:default) && options[:default].nil?\n\n        return super(locale, nil, options.merge(:default => default)) if default\n        throw(:exception, I18n::MissingTranslation.new(locale, key, options))\n      end\n\n      def extract_non_symbol_default!(options)\n        defaults = [options[:default]].flatten\n        first_non_symbol_default = defaults.detect{|default| !default.is_a?(Symbol)}\n        if first_non_symbol_default\n          options[:default] = defaults[0, defaults.index(first_non_symbol_default)]\n        end\n        return first_non_symbol_default\n      end\n\n      def exists?(locale, key, options = EMPTY_HASH)\n        return super unless options.fetch(:fallback, true)\n        I18n.fallbacks[locale].each do |fallback|\n          begin\n            return true if super(fallback, key)\n          rescue I18n::InvalidLocale\n            # we do nothing when the locale is invalid, as this is a fallback anyways.\n          end\n        end\n\n        false\n      end\n\n      private\n\n        # Overwrite on_fallback to add specified logic when the fallback succeeds.\n        def on_fallback(_original_locale, _fallback_locale, _key, _optoins)\n          nil\n        end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:I18n>", "@@fallbacks", "fallbacks", "$ret_or_1", "I18n::Locale::Fallbacks", "I18n::Locale", "I18n", "new", "Thread", "current", "[]", "fallbacks=", "is_a?", "Array", "[]=", "self", "<module:Backend>", "<module:Fallbacks>", "translate", "locale", "key", "options", "EMPTY_HASH", "fetch", "default$", "extract_non_symbol_default!", "fallback_options", "merge", "each", "block in translate", "fallback", "block (2 levels) in translate", "catch", "block (3 levels) in translate", "result", "nil?", "to_s", "on_fallback", "I18n::InvalidLocale", "key?", "throw", "I18n::MissingTranslation", "defaults", "flatten", "first_non_symbol_default", "detect", "block in extract_non_symbol_default!", "block (2 levels) in extract_non_symbol_default!", "Symbol", "!", "0", "index", "exists?", "block in exists?", "block (2 levels) in exists?", "private"], :mappings=>"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"}}, {:offset=>{:line=>192, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/randomizer.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  # 乱数生成器\n  class Randomizer\n    UPPER_LIMIT_DICE_TIMES = 200\n    UPPER_LIMIT_DICE_SIDES = 10000\n\n    UPPER_LIMIT_RANDS = 10000\n\n    def initialize\n      @rand_results = []\n      @detailed_rand_results = []\n    end\n\n    # @return [Array<Array<(Integer, Integer)>>] ダイスの出目一覧\n    attr_reader :rand_results\n\n    # @return [Array<DetailedRandResult>]\n    attr_reader :detailed_rand_results\n\n    # 実行したダイスロールの詳細\n    # @!attribute [rw] kind\n    #   @return [Symbol]\n    # @!attribute [rw] sides\n    #   @return [Integer] ダイスロールしたダイスの面数\n    # @!attribute [rw] value\n    #   @return [Integer] 値\n    DetailedRandResult = Struct.new(:kind, :sides, :value)\n\n    # 複数個のダイスを振る\n    #\n    # @param times [Integer] 振るダイスの個数\n    # @param sides [Integer] ダイスの面数\n    # @return [Array<Integer>] ダイスの出目一覧\n    def roll_barabara(times, sides)\n      if @rand_results.size + times > UPPER_LIMIT_RANDS\n        raise TooManyRandsError\n      end\n\n      if times <= 0 || times > UPPER_LIMIT_DICE_TIMES\n        return []\n      end\n\n      Array.new(times) { roll_once(sides) }\n    end\n\n    # 複数個のダイスを振って、その合計を求める\n    #\n    # @param times [Integer] 振るダイスの個数\n    # @param sides [Integer] ダイスの面数\n    # @return [Integer] 出目の合計\n    def roll_sum(times, sides)\n      roll_barabara(times, sides).sum()\n    end\n\n    # 1回だけダイスロールを行う\n    #\n    # @param sides [Integer] ダイスの面数\n    # @return [Integer] 1以上 *sides* 以下の値のいずれか\n    def roll_once(sides)\n      if sides <= 0 || sides > UPPER_LIMIT_DICE_SIDES\n        return 0\n      end\n\n      dice = rand_inner(sides)\n      push_to_detail(:normal, sides, dice)\n\n      return dice\n    end\n\n    # ダイス表などでindexを参照する用のダイスロール\n    # @param sides [Integer]\n    # @return [Integer] 0以上 *sides* 未満の整数\n    def roll_index(sides)\n      roll_once(sides) - 1\n    end\n\n    # 十の位をd10を使って決定するためのダイスロール\n    # @return [Integer] 0以上90以下で10の倍数となる整数\n    def roll_tens_d10()\n      # rand_innerの戻り値を10倍すればすむ話なのだが、既存のテストとの互換性の為に処理をする\n      dice = rand_inner(10)\n      if dice == 10\n        dice = 0\n      end\n\n      ret = dice * 10\n\n      push_to_detail(:tens_d10, 10, ret)\n      return ret\n    end\n\n    # d10を0~9として扱うダイスロール\n    # @return [Integer] 0以上9以下の整数\n    def roll_d9()\n      dice = rand_inner(10) - 1\n\n      push_to_detail(:d9, 10, dice)\n      return dice\n    end\n\n    # D66のダイスロールを行う\n    # @param sort_type [Symbol] BCDice::D66SortType\n    # @return [Integer]\n    def roll_d66(sort_type)\n      dice_list = Array.new(2) { roll_once(6) }\n\n      case sort_type\n      when D66SortType::ASC\n        dice_list.sort!\n      when D66SortType::DESC\n        dice_list.sort!.reverse!\n      end\n\n      return dice_list[0] * 10 + dice_list[1]\n    end\n\n    private\n\n    # @param sides [Integer]\n    # @return [Integer] 1以上sides以下の整数\n    def rand_inner(sides)\n      if @rand_results.size >= UPPER_LIMIT_RANDS\n        raise TooManyRandsError\n      end\n\n      dice = random(sides)\n\n      @rand_results << [dice, sides]\n      return dice\n    end\n\n    # モックで上書きする用\n    # @param sides [Integer]\n    # @return [Integer] 1以上sides以下の整数\n    def random(sides)\n      Kernel.rand(sides) + 1\n    end\n\n    # @param [Symbol] kind\n    # @param [Integer] sides\n    # @param [Integer] value\n    def push_to_detail(kind, sides, value)\n      detail = DetailedRandResult.new(kind, sides, value)\n      @detailed_rand_results.push(detail)\n    end\n  end\n\n  class TooManyRandsError < StandardError; end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<class:Randomizer>", "200", "10000", "initialize", "@rand_results", "@detailed_rand_results", "self", "attr_reader", "Struct", "new", "roll_barabara", "times", "sides", ">", "+", "size", "UPPER_LIMIT_RANDS", "raise", "TooManyRandsError", "<=", "0", "UPPER_LIMIT_DICE_TIMES", "Array", "block in roll_barabara", "block (2 levels) in roll_barabara", "roll_once", "roll_sum", "sum", "UPPER_LIMIT_DICE_SIDES", "dice", "rand_inner", "push_to_detail", "roll_index", "-", "1", "roll_tens_d10", "10", "ret", "*", "roll_d9", "roll_d66", "sort_type", "dice_list", "2", "block in roll_d66", "block (2 levels) in roll_d66", "6", "D66SortType::ASC", "D66SortType", "$ret_or_1", "sort!", "D66SortType::DESC", "reverse!", "[]", "private", ">=", "random", "<<", "Kernel", "rand", "kind", "value", "detail", "DetailedRandResult", "push", "<class:TooManyRandsError>", "StandardError"], :mappings=>"AAAAA,oCAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;;IAEEC;IAAAA;;MAAAA;;AAAAA;;MACE,kDAAyBC,GAAzB;MACA,kDAAyBC,KAAzB;MAEA,6CAAoBA,KAApB;;AAEAC,MAAAA,0BAAAA,sBAAAA;AAAAA,QAAAA;;;QACEC,oBAAgB;QAChBD,OAAAE,CAAAA,6BAAyB,EAAzBA;MAFFF,CAAAA;MAMAG,IAAAC,aAAAA,CAAY,cAAZA;MAGAD,IAAAC,aAAAA,CAAY,uBAAZA;MASA,8CAAqBC,YAAMC,KAAAA,CAAK,MAAX,EAAkB,OAAlB,EAA0B,OAApBA,CAA3B;;AAOAC,MAAAA,6BAAAA,yBAAkBC,KAAD,EAAQC,KAAzBF;AAAAA,QAAAA;;;QACE,IAAA,QAA8BG,OAARC,SAAnBV,iBAAaW,MAAAA,CAAAA,CAAMD,EAAEH,KAAFG,CAAQD,EAAEG,uBAAFH,CAA9B,CAAA;UACEP,IAAAW,OAAAA,CAAMC,uBAAND;QADF;QAIA,IAAG,CAAA,QAAME,OAANR,KAAMQ,EAAGC,CAAHD,CAAN,CAAA,IAAA,CAAA,QAAoBN,OAANF,KAAME,EAAEQ,4BAAFR,CAApB,CAAA,CAAA,CAAH;UACE,OAAO;QADT;QAIAH,OAAKD,MAALa,WAAKb,OAAAA,EAAAA,CAAKE,KAALF,CAAAA,EAALc,aAAAA,EAAAC;;UAAmBA,OAAAlB,IAAAmB,WAAAA,CAAUb,KAAVa,CAAnBF,CAAAA,GAAAA,SAAAA,CAAKd;MATPC,CAAAA;;AAiBAgB,MAAAA,wBAAAA,oBAAaf,KAAD,EAAQC,KAApBc;AAAAA,QAAAA;;QACEA,OAAApB,IAAAI,eAAAA,CAAcC,KAAd,EAAqBC,KAArBF,CAA2BiB,KAAAA,CAAAA;MAD7BD,CAAAA;;AAQAD,MAAAA,yBAAAA,qBAAcb,KAAda;AAAAA,QAAAA;;;QACE,IAAG,CAAA,QAAMN,OAANP,KAAMO,EAAGC,CAAHD,CAAN,CAAA,IAAA,CAAA,QAAoBN,OAAND,KAAMC,EAAEe,4BAAFf,CAApB,CAAA,CAAA,CAAH;UACE,OAAOO;QADT;QAIAS,OAAOvB,IAAAwB,YAAAA,CAAWlB,KAAXkB;QACPxB,IAAAyB,gBAAAA,CAAe,QAAf,EAAwBnB,KAAxB,EAA+BiB,IAA/BE;QAEA,OAAOF;MARTJ,CAAAA;;AAcAO,MAAAA,0BAAAA,sBAAepB,KAAfoB;AAAAA,QAAAA;;QACEA,OAAiBC,UAAjB3B,IAAAmB,WAAAA,CAAUb,KAAVa,CAAiBQ,EAAEC,CAAFD;MADnBD,CAAAA;;AAMAG,MAAAA,6BAAAA,yBAAAA;AAAAA,QAAAA;;;QAEEN,OAAOvB,IAAAwB,YAAAA,CAAWM,EAAXN;QACP,IAAA,MAAGD,IAAH,EAAWO,EAAX,CAAA;UACEP,OAAOT;QADT;QAIAiB,MAAWC,UAALT,IAAKS,EAAEF,EAAFE;QAEXhC,IAAAyB,gBAAAA,CAAe,UAAf,EAA0BK,EAA1B,EAA8BC,GAA9BN;QACA,OAAOM;MAVTF,CAAAA;;AAeAI,MAAAA,uBAAAA,mBAAAA;AAAAA,QAAAA;;;QACEV,OAAsBI,UAAf3B,IAAAwB,YAAAA,CAAWM,EAAXN,CAAeG,EAAEC,CAAFD;QAEtB3B,IAAAyB,gBAAAA,CAAe,IAAf,EAAoBK,EAApB,EAAwBP,IAAxBE;QACA,OAAOF;MAJTU,CAAAA;;AAUAC,MAAAA,wBAAAA,oBAAaC,SAAbD;AAAAA,QAAAA;;;QACEE,YAAiBjC,MAALa,WAAKb,OAAAA,EAAAA,CAAKkC,CAALlC,CAAAA,EAALmC,aAAAA,EAAAC;;UAAeA,OAAAvC,IAAAmB,WAAAA,CAAUqB,CAAVrB,CAAfmB,CAAAA,GAAAA,SAAAA,CAAKnC;QAGjB,IAAA,QAAKsC,IAAAC,iBAAAD,QAAL,EADAE,CAAAA,YAAKR,SAALQ,CACA,CAAA;UACEP,SAASQ,UAAAA,CAAAA;QADX,OAEA,IAAA,QAAKC,IAAAH,iBAAAG,SAAL,EA/GN,SA+GM,CAAA;UACET,SAASQ,UAAAA,CAAAA,CAAME,aAAAA,CAAAA;QADjB;UAHA;QAGA;QAIA,OAAyBtC,SAALwB,UAAbI,SAASW,OAAAA,CAACjC,CAADiC,CAAIf,EAAEF,EAAFE,CAAKxB,EAAE4B,SAASW,OAAAA,CAACnB,CAADmB,CAAXvC;MAV3B0B,CAAAA;MAaAlC,IAAAgD,SAAAA,CAAAA;;AAIAxB,MAAAA,0BAAAA,sBAAelB,KAAfkB;AAAAA,QAAAA;;;QACE,IAAA,QAAsByB,OAAnBnD,iBAAaW,MAAAA,CAAAA,CAAMwC,EAAGvC,uBAAHuC,CAAtB,CAAA;UACEjD,IAAAW,OAAAA,CAAMC,uBAAND;QADF;QAIAY,OAAOvB,IAAAkD,QAAAA,CAAO5C,KAAP4C;QAEPpD,iBAAcqD,OAAAA,CAAG,CAAC5B,IAAD,EAAOjB,KAAP,CAAH6C;QACd,OAAO5B;MARTC,CAAAA;;AAcA0B,MAAAA,sBAAAA,kBAAW5C,KAAX4C;AAAAA;QACEA,OAAmB1C,SAAnB4C,YAAMC,MAAAA,CAAM/C,KAAN+C,CAAa7C,EAAEoB,CAAFpB;MADrB0C,CAAAA;MAOAxD,OAAA+B,8BAAAA,0BAAmB6B,IAAD,EAAOhD,KAAP,EAAciD,KAAhC9B;AAAAA,QAAAA;;;QACE+B,SAASC,wBAAkBtD,KAAAA,CAAKmD,IAAvB,EAA6BhD,KAA7B,EAAoCiD,KAAlBpD;QAC3BsB,OAAA1B,0BAAsB2D,MAAAA,CAAMF,MAANE;MAFxBjC,CAAAA;IA3IF/B,GAAAA,WAAAA,EAAAA,IAAAA;IAiJAD,OAAAkE,QAAAA,WAAAA,EAA0BC,mBAA1BD;EAnJFlE,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>330, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/roll_result.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    class RollResult\n      # @param table_name [String]\n      # @param value [Integer]\n      # @param body [String, RollResult]\n      def initialize(table_name, value, body)\n        @table_name = table_name\n        @value = value\n        @body = body\n      end\n\n      # @return [String]\n      attr_reader :table_name\n\n      # @return [Integer]\n      attr_reader :value\n\n      # @return [String, RollResult]\n      attr_reader :body\n\n      # @return [String]\n      def to_s\n        \"\#{@table_name}(\#{@value}) ＞ \#{@body}\"\n      end\n\n      # @return [String]\n      def last_body\n        if @body.is_a?(RollResult)\n          @body.last_body\n        else\n          @body\n        end\n      end\n\n      # 一部のゲームシステムが String#empty? を想定してチェックしているため\n      # @return [false]\n      def empty?\n        false\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:RollResult>", "initialize", "table_name", "value", "body", "@table_name", "@value", "@body", "self", "attr_reader", "to_s", "last_body", "is_a?", "RollResult", "empty?"], :mappings=>"AAAAA,gDAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;;AAIEC,QAAAA,0BAAAA,sBAAeC,UAAD,EAAaC,KAAb,EAAoBC,IAAlCH;AAAAA,UAAAA;;;UACEI,kBAAcH;UACdI,aAASH;UACTF,OAAAM,CAAAA,YAAQH,IAARG;QAHFN,CAAAA;QAOAO,IAAAC,aAAAA,CAAY,YAAZA;QAGAD,IAAAC,aAAAA,CAAY,OAAZA;QAGAD,IAAAC,aAAAA,CAAY,MAAZA;;AAGAC,QAAAA,oBAAAA,gBAAAA;AAAAA,UAAAA;;UACEA,OAAA,EAAA,GAAA,CAAGL,eAAH,CAAA,GAAeK,GAAf,GAAA,CAAkBJ,UAAlB,CAAA,GAAyBI,MAAzB,GAAA,CAA+BH,SAA/B;QADFG,CAAAA;;AAKAC,QAAAA,yBAAAA,qBAAAA;AAAAA,UAAAA;;UACE,IAAA,QAAGJ,SAAKK,UAAAA,CAAOC,gBAAPD,CAAR,CAAA;YACED,OAAAJ,SAAKI,WAAAA,CAAAA;UADP;YAGEA,OAAAJ;UAHF;QADFI,CAAAA;QAUAX,OAAAc,sBAAAA,YACE,KADFA,CAAAA;MAnCFd,GAAAA,WAAAA,EAAAA,IAAAA;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>384, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/chain_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    class ChainTable\n      # @param [String] name 表の名前\n      # @param [String] type 項目を選ぶときのダイスロールの方法 '1D6'など\n      # @param [Array<String, #roll>] items 表の項目の配列\n      def initialize(name, type, items)\n        @name = name\n        @items = items.freeze\n\n        m = /(\\d+)D(\\d+)/i.match(type)\n        unless m\n          raise ArgumentError, \"Unexpected table type: \#{type}\"\n        end\n\n        @times = m[1].to_i\n        @sides = m[2].to_i\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_sum] ランダマイザ\n      # @return [String] 結果\n      def roll(randomizer)\n        value = randomizer.roll_sum(@times, @sides)\n        index = value - @times\n        chosen = @items[index]\n        chosen = chosen.roll(randomizer) if chosen.respond_to?(:roll)\n\n        return RollResult.new(@name, value, chosen)\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:ChainTable>", "initialize", "name", "type", "items", "@name", "@items", "freeze", "m", "match", "self", "raise", "ArgumentError", "@times", "[]", "1", "to_i", "@sides", "2", "roll", "randomizer", "value", "roll_sum", "index", "-", "chosen", "respond_to?", "RollResult", "new"], :mappings=>"AAAAA,gDAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;;AAIEC,QAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,IAAP,EAAaC,KAA3BH;AAAAA,UAAAA;;;UACEI,YAAQH;UACRI,aAASF,KAAKG,QAAAA,CAAAA;UAEdC,IAAI,cAAcC,OAAAA,CAAON,IAAPM;UAClB,KAAA,QAAOD,CAAP,CAAA;YACEE,IAAAC,OAAAA,CAAMC,mBAAN,EAAsBX,yBAAD,GAAA,CAA0BE,IAA1B,CAArBQ;UADF;UAIAE,aAASL,CAACM,OAAAA,CAACC,CAADD,CAAGE,MAAAA,CAAAA;UACbf,OAAAgB,CAAAA,aAAST,CAACM,OAAAA,CAACI,CAADJ,CAAGE,MAAAA,CAAAA,CAAbC;QAVFhB,CAAAA;QAgBAD,OAAAmB,oBAAAA,gBAASC,UAATD;AAAAA,UAAAA;;;UACEE,QAAQD,UAAUE,UAAAA,CAAUT,UAApB,EAA4BI,UAAlBK;UAClBC,QAAcC,UAANH,KAAMG,EAAEX,UAAFW;UACdC,SAASnB,UAAMQ,OAAAA,CAACS,KAADT;UACf,IAAA,QAAoCW,MAAMC,gBAAAA,CAAa,MAAbA,CAA1C,CAAA;YAAAD,SAASA,MAAMN,MAAAA,CAAMC,UAAND;UAAf;UAEA,OAAOQ,gBAAUC,KAAAA,CAAKvB,SAAf,EAAsBgB,KAAtB,EAA6BI,MAAnBG;QANnBT,CAAAA;MApBFnB,GAAAA,WAAAA,EAAAA,IAAAA;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>435, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_grid_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # D66を振って6x6マスの表を参照する\n    class D66GridTable\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [D66GridTable]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale, raise: true)\n        new(table[:name], table[:items])\n      end\n\n      # @param [String] name 表の名前\n      # @param [Array<Array<String>>] items 表の項目の配列\n      def initialize(name, items)\n        @name = name\n        @items = items.freeze\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_once] ランダマイザ\n      # @return [String] 結果\n      def roll(randomizer)\n        dice1 = randomizer.roll_once(6)\n        dice2 = randomizer.roll_once(6)\n        value = dice1 * 10 + dice2\n\n        index1 = dice1 - 1\n        index2 = dice2 - 1\n        return RollResult.new(@name, value, @items[index1][index2])\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:D66GridTable>", "from_i18n", "self", "key", "locale", "table", "I18n", "t", "new", "[]", "initialize", "name", "items", "@name", "@items", "freeze", "roll", "randomizer", "dice1", "roll_once", "6", "dice2", "value", "+", "*", "10", "index1", "-", "1", "index2", "RollResult"], :mappings=>"AAAAA,mDAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAIEC,MAAIC,IAAJD,gBAAAA,qBAAmBE,GAAD,EAAMC,MAAxBH;AAAAA,UAAAA;;;UACEI,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,6BAAA,UAAQC,MAAR,EAAA,SAAuB,IAAvB,EAARG;UACZN,OAAAC,IAAAM,KAAAA,CAAIH,KAAKI,OAAAA,CAAC,MAADA,CAAT,EAAkBJ,KAAKI,OAAAA,CAAC,OAADA,CAAvBD;QAFFP,CAAAA;;AAOAS,QAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,KAArBF;AAAAA,UAAAA;;;UACEG,YAAQF;UACRD,OAAAI,CAAAA,aAASF,KAAKG,QAAAA,CAAAA,CAAdD;QAFFJ,CAAAA;QAQAV,OAAAgB,oBAAAA,gBAASC,UAATD;AAAAA,UAAAA;;;UACEE,QAAQD,UAAUE,WAAAA,CAAWC,CAAXD;UAClBE,QAAQJ,UAAUE,WAAAA,CAAWC,CAAXD;UAClBG,QAAmBC,SAALC,UAANN,KAAMM,EAAEC,EAAFD,CAAKD,EAAEF,KAAFE;UAEnBG,SAAeC,UAANT,KAAMS,EAAEC,CAAFD;UACfE,SAAeF,UAANN,KAAMM,EAAEC,CAAFD;UACf,OAAOG,gBAAUtB,KAAAA,CAAKK,SAAf,EAAsBS,KAAtB,EAA6BR,UAAML,OAAAA,CAACiB,MAADjB,CAAQA,OAAAA,CAACoB,MAADpB,CAAjCD;QAPnBQ,CAAAA;MAnBFhB,GAAAA,WAAAA,EAAAA,IAAAA;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>486, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_half_grid_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/dice_table/d66_grid_table\"\n\nmodule BCDice\n  module DiceTable\n    # D66を振って6x6マスの表を参照する\n    class D66HalfGridTable < D66GridTable\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [D66HalfGridTable]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale, raise: true)\n        new(table[:name], table[:items_1_2_3], table[:items_4_5_6])\n      end\n\n      # @param [String] name 表の名前\n      # @param [Array<String>] items_1_2_3\n      # @param [Array<String>] items_4_5_6\n      def initialize(name, items_1_2_3, items_4_5_6)\n        @name = name\n        @items = [\n          items_1_2_3,\n          items_1_2_3,\n          items_1_2_3,\n          items_4_5_6,\n          items_4_5_6,\n          items_4_5_6,\n        ].freeze\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:DiceTable>", "<class:D66HalfGridTable>", "from_i18n", "key", "locale", "table", "I18n", "t", "new", "[]", "initialize", "name", "items_1_2_3", "items_4_5_6", "@name", "@items", "freeze", "D66GridTable"], :mappings=>"AAAAA,wDAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,kCAARE;EAEAF,OAAAG;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;;QAIEC,MAAIL,IAAJK,gBAAAA,qBAAmBC,GAAD,EAAMC,MAAxBF;AAAAA,UAAAA;;;UACEG,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,6BAAA,UAAQC,MAAR,EAAA,SAAuB,IAAvB,EAARG;UACZL,OAAAL,IAAAW,KAAAA,CAAIH,KAAKI,OAAAA,CAAC,MAADA,CAAT,EAAkBJ,KAAKI,OAAAA,CAAC,aAADA,CAAvB,EAAuCJ,KAAKI,OAAAA,CAAC,aAADA,CAA5CD;QAFFN,CAAAA;QAQAD,OAAAS,0BAAAA,sBAAeC,IAAD,EAAOC,WAAP,EAAoBC,WAAlCH;AAAAA,UAAAA;;;UACEI,YAAQH;UACRD,OAAAK,CAAAA,aAAS,CACPH,WADO,EAEPA,WAFO,EAGPA,WAHO,EAIPC,WAJO,EAKPA,WALO,EAMPA,WANO,CAORG,QAAAA,CAAAA,CAPDD;QAFFL,CAAAA;MAZFT,GAAAA,WAAAA,EAAyBgB,kBAAzBhB;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAJAH;"}}, {:offset=>{:line=>526, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_one_third_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/dice_table/d66_grid_table\"\n\nmodule BCDice\n  module DiceTable\n    # D66を振って6x6マスの表を参照する\n    class D66OneThirdTable < D66GridTable\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [D66OneThirdTable]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale, raise: true)\n        new(table[:name], table[:items_1_2], table[:items_3_4], table[:items_5_6])\n      end\n\n      # @param [String] name 表の名前\n      # @param [Array<String>] items_1_2\n      # @param [Array<String>] items_3_4\n      # @param [Array<String>] items_5_6\n      def initialize(name, items_1_2, items_3_4, items_5_6)\n        @name = name\n        @items = [\n          items_1_2,\n          items_1_2,\n          items_3_4,\n          items_3_4,\n          items_5_6,\n          items_5_6,\n        ].freeze\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:DiceTable>", "<class:D66OneThirdTable>", "from_i18n", "key", "locale", "table", "I18n", "t", "new", "[]", "initialize", "name", "items_1_2", "items_3_4", "items_5_6", "@name", "@items", "freeze", "D66GridTable"], :mappings=>"AAAAA,wDAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,kCAARE;EAEAF,OAAAG;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;;QAIEC,MAAIL,IAAJK,gBAAAA,qBAAmBC,GAAD,EAAMC,MAAxBF;AAAAA,UAAAA;;;UACEG,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,6BAAA,UAAQC,MAAR,EAAA,SAAuB,IAAvB,EAARG;UACZL,OAAAL,IAAAW,KAAAA,CAAIH,KAAKI,OAAAA,CAAC,MAADA,CAAT,EAAkBJ,KAAKI,OAAAA,CAAC,WAADA,CAAvB,EAAqCJ,KAAKI,OAAAA,CAAC,WAADA,CAA1C,EAAwDJ,KAAKI,OAAAA,CAAC,WAADA,CAA7DD;QAFFN,CAAAA;QASAD,OAAAS,0BAAAA,sBAAeC,IAAD,EAAOC,SAAP,EAAkBC,SAAlB,EAA6BC,SAA3CJ;AAAAA,UAAAA;;;UACEK,YAAQJ;UACRD,OAAAM,CAAAA,aAAS,CACPJ,SADO,EAEPA,SAFO,EAGPC,SAHO,EAIPA,SAJO,EAKPC,SALO,EAMPA,SANO,CAORG,QAAAA,CAAAA,CAPDD;QAFFN,CAAAA;MAbFT,GAAAA,WAAAA,EAAyBiB,kBAAzBjB;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAJAH;"}}, {:offset=>{:line=>566, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # D66を振って出目を昇順/降順にして表を参照する\n    class D66Table\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [D66Table]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale)\n        sort_type = D66SortType.const_get(table[:d66_sort_type])\n\n        new(table[:name], sort_type, table[:items])\n      end\n\n      # @param [String] name 表の名前\n      # @param [Symbol] sort_type 出目入れ替えの方式 BCDice::D66SortType\n      # @param [Hash] items 表の項目 Key は数値\n      def initialize(name, sort_type, items)\n        @name = name\n        @sort_type = sort_type\n        @items = items.freeze\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_barabara] ランダマイザ\n      # @return [String] 結果\n      def roll(randomizer)\n        dice = randomizer.roll_barabara(2, 6)\n\n        case @sort_type\n        when D66SortType::ASC\n          dice.sort!\n        when D66SortType::DESC\n          dice.sort!.reverse!\n        end\n\n        key = dice[0] * 10 + dice[1]\n        chosen = @items[key] || @items[key.to_s]\n        chosen = chosen.roll(randomizer) if chosen.respond_to?(:roll)\n        RollResult.new(@name, key, chosen)\n      end\n\n      def choice(key)\n        RollResult.new(@name, key, @items[key])\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:D66Table>", "from_i18n", "self", "key", "locale", "table", "I18n", "t", "sort_type", "D66SortType", "const_get", "[]", "new", "initialize", "name", "items", "@name", "@sort_type", "@items", "freeze", "roll", "randomizer", "dice", "roll_barabara", "2", "6", "D66SortType::ASC", "$ret_or_1", "sort!", "D66SortType::DESC", "reverse!", "+", "*", "0", "10", "1", "chosen", "to_s", "respond_to?", "RollResult", "choice"], :mappings=>"AAAAA,8CAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAIEC,MAAIC,IAAJD,gBAAAA,qBAAmBE,GAAD,EAAMC,MAAxBH;AAAAA,UAAAA;;;UACEI,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,oBAAA,UAAQC,MAAR,EAARG;UACZC,YAAYC,iBAAWC,WAAAA,CAAWL,KAAKM,OAAAA,CAAC,eAADA,CAAhBD;UAEvBT,OAAAC,IAAAU,KAAAA,CAAIP,KAAKM,OAAAA,CAAC,MAADA,CAAT,EAAkBH,SAAlB,EAA6BH,KAAKM,OAAAA,CAAC,OAADA,CAAlCC;QAJFX,CAAAA;;AAUAY,QAAAA,0BAAAA,sBAAeC,IAAD,EAAON,SAAP,EAAkBO,KAAhCF;AAAAA,UAAAA;;;UACEG,YAAQF;UACRG,iBAAaT;UACbK,OAAAK,CAAAA,aAASH,KAAKI,QAAAA,CAAAA,CAAdD;QAHFL,CAAAA;;AASAO,QAAAA,oBAAAA,gBAASC,UAATD;AAAAA,UAAAA;;;UACEE,OAAOD,UAAUE,eAAAA,CAAeC,CAAzB,EAA4BC,CAAlBF;UAGjB,IAAA,QAAKG,IAAAjB,iBAAAiB,QAAL,EADAC,CAAAA,YAAKV,cAALU,CACA,CAAA;YACEL,IAAIM,UAAAA,CAAAA;UADN,OAEA,IAAA,QAAKC,IAAApB,iBAAAoB,SAAL,EAlCR,SAkCQ,CAAA;YACEP,IAAIM,UAAAA,CAAAA,CAAME,aAAAA,CAAAA;UADZ;YAHA;UAGA;UAIA3B,MAAmB4B,SAALC,UAARV,IAAIX,OAAAA,CAACsB,CAADtB,CAAIqB,EAAEE,EAAFF,CAAKD,EAAET,IAAIX,OAAAA,CAACwB,CAADxB,CAANoB;UACnBK,SAAS,CAAA,QAAAT,CAAAA,YAAAT,UAAMP,OAAAA,CAACR,GAADQ,CAANgB,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAeT,UAAMP,OAAAA,CAACR,GAAGkC,MAAAA,CAAAA,CAAJ1B,CAArB,CAAA;UACT,IAAA,QAAoCyB,MAAME,gBAAAA,CAAa,MAAbA,CAA1C,CAAA;YAAAF,SAASA,MAAMhB,MAAAA,CAAMC,UAAND;UAAf;UACAA,OAAAmB,gBAAU3B,KAAAA,CAAKI,SAAf,EAAsBb,GAAtB,EAA2BiC,MAAjBxB;QAbZQ,CAAAA;QAgBApB,OAAAwC,sBAAAA,kBAAWrC,GAAXqC;AAAAA,UAAAA;;UACEA,OAAAD,gBAAU3B,KAAAA,CAAKI,SAAf,EAAsBb,GAAtB,EAA2Be,UAAMP,OAAAA,CAACR,GAADQ,CAAvBC;QADZ4B,CAAAA;MAvCFxC,GAAAA,WAAAA,EAAAA,IAAAA;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>633, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_left_range_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/dice_table/d66_table\"\n\nmodule BCDice\n  module DiceTable\n    # 左側（十の位）のみ Range を用いる D66 表\n    class D66LeftRangeTable < D66Table\n      # @param name [String] 表の名前\n      # @param sort_type [Symbol] 出目入れ替えの方式 BCDice::D66SortType\n      # @param items [Array<(Range, Array<String>)>] 表の項目の配列\n      def initialize(name, sort_type, items)\n        expanded_items = {}\n        items.each do |item|\n          range, right_items = item\n\n          range.each do |left_value|\n            right_items.each_with_index do |right_item, right_value|\n              key = left_value * 10 + (right_value + 1)\n              expanded_items[key] = right_item\n            end\n          end\n        end\n\n        super(name, sort_type, expanded_items)\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:DiceTable>", "<class:D66LeftRangeTable>", "initialize", "name", "sort_type", "items", "expanded_items", "each", "block in initialize", "item", "block (2 levels) in initialize", "range", "right_items", "left_value", "block (3 levels) in initialize", "each_with_index", "right_item", "right_value", "block (4 levels) in initialize", "key", "+", "*", "10", "1", "[]=", "D66Table"], :mappings=>"AAAAA,yDAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,6BAARE;EAEAF,OAAAG;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;;QAIEA,OAAAC,0BAAAA,sBAAeC,IAAD,EAAOC,SAAP,EAAkBC,KAAhCH;AAAAA,UAAAA;;UAAAA;;UACEI,iBAAiB,YAAA;UACZC,MAALF,KAAKE,QAAAA,EAAAA,EAAAA,EAALC,aAAeC,IAAfD,EAAAE;;;YAAe;YACb,KAAqBD,IAArB,kBAAA,EAAAE,CAAAA,QAAA,6BAAAA,CAAA,EAAOC,CAAAA,cAAP,6BAAOA,CAAP;YAEAF,OAAKH,MAALI,KAAKJ,QAAAA,EAAAA,EAAAA,EAALG,aAAeG,UAAfH;;cAAe;cACbI,OAAWC,MAAXH,WAAWG,mBAAAA,EAAAA,EAAAA,EAAXD,aAAgCE,UAAD,EAAaC,WAA5CH,EAAAI;;;gBAAgC;gBAAY;gBAC1CC,MAAsBC,SAALC,UAAXR,UAAWQ,EAAEC,EAAFD,CAAKD,EAAeA,SAAZH,WAAYG,EAAEG,CAAFH,CAAfA;gBACtBF,OAAcM,MAAAA,CAACL,GAAf,EAAsBH,UAARQ,CAAAA,EAAAA,MAAdlB,cAAckB,OAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAFhBV,CAAWC,EADbL,CAAKH,EAHPC,CAAKD;UAWLL,OAAA,OAAAL,IAAA,EAAA,0DAAA,cAAA,EAAA,CAAMM,IAAN,EAAYC,SAAZ,EAAuBE,cAAvB,CAAA,EAAA,IAAA;QAbFJ,CAAAA;MAJFD,GAAAA,WAAAA,EAA0BwB,cAA1BxB;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAJAH;"}}, {:offset=>{:line=>680, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_parity_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # 出目の偶奇による場合分け機能をもつD66表\n    class D66ParityTable\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [D66ParityTable]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale, raise: true)\n        new(table[:name], table[:odd], table[:even])\n      end\n\n      # @param name [String] 表の名前\n      # @param odd [Array<String>] 左ダイスが奇数だったときの次層テーブル（サイズ６）\n      # @param even [Array<String>] 左ダイスが偶数だったときの次層テーブル（サイズ６）\n      def initialize(name, odd, even)\n        @name = name\n        @odd = odd.freeze\n        @even = even.freeze\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_once] ランダマイザ\n      # @return [String] 結果\n      def roll(randomizer)\n        dice1 = randomizer.roll_once(6)\n        dice2 = randomizer.roll_once(6)\n\n        if dice1.odd?\n          second_table = @odd\n        else\n          second_table = @even\n        end\n\n        result = second_table[dice2 - 1]\n        key = dice1 * 10 + dice2\n\n        return RollResult.new(@name, key, result)\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:D66ParityTable>", "from_i18n", "self", "key", "locale", "table", "I18n", "t", "new", "[]", "initialize", "name", "odd", "even", "@name", "@odd", "freeze", "@even", "roll", "randomizer", "dice1", "roll_once", "6", "dice2", "odd?", "second_table", "result", "-", "1", "+", "*", "10", "RollResult"], :mappings=>"AAAAA,qDAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAIEC,MAAIC,IAAJD,gBAAAA,qBAAmBE,GAAD,EAAMC,MAAxBH;AAAAA,UAAAA;;;UACEI,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,6BAAA,UAAQC,MAAR,EAAA,SAAuB,IAAvB,EAARG;UACZN,OAAAC,IAAAM,KAAAA,CAAIH,KAAKI,OAAAA,CAAC,MAADA,CAAT,EAAkBJ,KAAKI,OAAAA,CAAC,KAADA,CAAvB,EAA+BJ,KAAKI,OAAAA,CAAC,MAADA,CAApCD;QAFFP,CAAAA;;AAQAS,QAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,GAAP,EAAYC,IAA1BH;AAAAA,UAAAA;;;UACEI,YAAQH;UACRI,WAAOH,GAAGI,QAAAA,CAAAA;UACVN,OAAAO,CAAAA,YAAQJ,IAAIG,QAAAA,CAAAA,CAAZC;QAHFP,CAAAA;QASAV,OAAAkB,oBAAAA,gBAASC,UAATD;AAAAA,UAAAA;;;UACEE,QAAQD,UAAUE,WAAAA,CAAWC,CAAXD;UAClBE,QAAQJ,UAAUE,WAAAA,CAAWC,CAAXD;UAElB,IAAA,QAAGD,KAAKI,SAAAA,CAAAA,CAAR,CAAA;YACEC,eAAeV;UADjB;YAGEU,eAAeR;UAHjB;UAMAS,SAASD,YAAYhB,OAAAA,CAAOkB,UAANJ,KAAMI,EAAEC,CAAFD,CAAPlB;UACrBN,MAAiB0B,SAALC,UAANV,KAAMU,EAAEC,EAAFD,CAAKD,EAAEN,KAAFM;UAEjB,OAAOG,gBAAUxB,KAAAA,CAAKM,SAAf,EAAsBX,GAAtB,EAA2BuB,MAAjBlB;QAbnBU,CAAAA;MArBFlB,GAAAA,WAAAA,EAAAA,IAAAA;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>736, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/d66_range_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # 項目をRangeを用いて参照するD66表\n    class D66RangeTable\n      # @param name [String] 表の名前\n      # @param items [Array<(Range, String)>] 表の項目の配列\n      def initialize(name, items)\n        @name = name\n        @items = items.freeze\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_once] ランダマイザ\n      # @return [String] 結果\n      def roll(randomizer)\n        dice1 = randomizer.roll_once(6)\n        dice2 = randomizer.roll_once(6)\n\n        key = dice1 * 10 + dice2\n\n        chosen = @items.find { |row| row[0].include?(key) }\n        return RollResult.new(@name, key, chosen[1])\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:D66RangeTable>", "initialize", "name", "items", "@name", "@items", "freeze", "roll", "randomizer", "dice1", "roll_once", "6", "dice2", "key", "+", "*", "10", "chosen", "find", "block in roll", "row", "block (2 levels) in roll", "[]", "0", "include?", "RollResult", "new", "1"], :mappings=>"AAAAA,oDAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;;AAGEC,QAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,KAArBF;AAAAA,UAAAA;;;UACEG,YAAQF;UACRD,OAAAI,CAAAA,aAASF,KAAKG,QAAAA,CAAAA,CAAdD;QAFFJ,CAAAA;QAQAD,OAAAO,oBAAAA,gBAASC,UAATD;AAAAA,UAAAA;;;UACEE,QAAQD,UAAUE,WAAAA,CAAWC,CAAXD;UAClBE,QAAQJ,UAAUE,WAAAA,CAAWC,CAAXD;UAElBG,MAAiBC,SAALC,UAANN,KAAMM,EAAEC,EAAFD,CAAKD,EAAEF,KAAFE;UAEjBG,SAAeC,MAANb,UAAMa,QAAAA,EAAAA,EAAAA,EAANC,aAAeC,GAAfD;;YAAe;YAAKE,OAAAD,GAAGE,OAAAA,CAACC,CAADD,CAAGE,aAAAA,CAAUX,GAAVW,EAA1BL,CAAMD;UACf,OAAOO,gBAAUC,KAAAA,CAAKtB,SAAf,EAAsBS,GAAtB,EAA2BI,MAAMK,OAAAA,CAACK,CAADL,CAAvBI;QAPnBnB,CAAAA;MAXFP,GAAAA,WAAAA,EAAAA,IAAAA;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>782, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/range_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # 各項目について、Rangeを用いて出目の合計の範囲を指定する、表のクラス。\n    #\n    # このクラスを使うと、表の定義を短く書ける。\n    # このクラスを使って表を定義するときは、各項目を以下の形で書く。\n    #\n    #     [出目の合計の範囲, 内容]\n    #\n    # 「出目の合計の範囲」には、Integerを要素とするRangeか、Integerを置ける。\n    #\n    # roll メソッドで表を振ると、出目の合計値と対応する項目が選ばれる。\n    #\n    # @example 表の定義（バトルテックの致命的命中表）\n    #   CRITICAL_TABLE = RangeTable.new(\n    #     '致命的命中表',\n    #     '2D6',\n    #     [\n    #       [2..7,   '致命的命中はなかった'],\n    #       [8..9,   '1箇所の致命的命中'],\n    #       [10..11, '2箇所の致命的命中'],\n    #       [12,     'その部位が吹き飛ぶ（腕、脚、頭）または3箇所の致命的命中（胴）']\n    #     ]\n    #   )\n    #\n    # @example 表を振った結果\n    #   CRITICAL_TABLE.roll(bcdice).formatted\n    #   # 出目の合計が7の場合 ：\"致命的命中表(7) ＞ 致命的命中はなかった\"\n    #   # 出目の合計が8の場合 ：\"致命的命中表(8) ＞ 1箇所の致命的命中\"\n    #   # 出目の合計が9の場合 ：\"致命的命中表(9) ＞ 1箇所の致命的命中\"\n    #   # 出目の合計が10の場合：\"致命的命中表(10) ＞ 2箇所の致命的命中\"\n    class RangeTable\n      # 表を振った結果を表す構造体\n      # @!attribute [rw] sum\n      #   @return [Integer] 出目の合計\n      # @!attribute [rw] values\n      #   @return [Array<Integer>] 出目の配列\n      # @!attribute [rw] content\n      #   @return [Object] 選ばれた項目の内容\n      # @!attribute [rw] formatted\n      #   @return [String] 整形された結果\n      RollResult = Struct.new(:sum, :values, :content, :formatted) do\n        alias_method :to_s, :formatted\n      end\n\n      # 表の項目を表す構造体\n      # @!attribute [rw] range\n      #   @return [Range] 出目の合計の範囲\n      # @!attribute [rw] content\n      #   @return [Object] 内容\n      Item = Struct.new(:range, :content)\n\n      # 項目を選ぶときのダイスロールの方法を表す正規表現\n      DICE_ROLL_METHOD_RE = /\\A(\\d+)D(\\d+)\\z/i.freeze\n\n      # 表を振った結果の整形処理（既定の処理）\n      DEFAULT_FORMATTER = lambda do |table, result|\n        \"\#{table.name}(\#{result.sum}) ＞ \#{result.content}\"\n      end\n\n      # @return [String] 表の名前\n      attr_reader :name\n      # @return [Integer] 振るダイスの個数\n      attr_reader :num_of_dice\n      # @return [Integer] 振るダイスの面数\n      attr_reader :num_of_sides\n\n      class << self\n        def from_i18n(key, locale)\n          table = I18n.t(key, locale: locale)\n          converted_items = table[:items].map do |item|\n            [conv_string_range(item[0]), item[1]]\n          end\n          new(table[:name], table[:type], converted_items)\n        end\n\n        def conv_string_range(x)\n          case x\n          when Integer\n            return x\n          when String\n            return x.include?(\"..\") ? Range.new(*x.split(\"..\", 2).map { |n| Integer(n) }) : Integer(x)\n          end\n\n          raise(\n            TypeError,\n            \"\#{@name}: \#{x} (\#{x.class}) must be a String or an Integer\"\n          )\n        end\n      end\n\n      # 表を初期化する\n      #\n      # ブロックを与えると、独自の結果整形処理を指定できる。\n      # ブロックは振った表（+table+）と振った結果（+result+）を引数として受け取る。\n      #\n      # @param [String] name 表の名前\n      # @param [String] dice_roll_method\n      #   項目を選ぶときのダイスロールの方法（+'1D6'+ など）\n      # @param [Array<(Range, Object)>, Array<(Integer, Object)>] items\n      #   表の項目の配列。[出目の合計の範囲, 内容]\n      # @yieldparam [RangeTable] table 振った表\n      # @yieldparam [RollResult] result 表を振った結果\n      # @raise [ArgumentError] ダイスロール方法が正しい書式で指定されていなかった場合\n      # @raise [TypeError] 範囲の型が正しくなかった場合\n      # @raise [RangeError] 出目の合計の最小値がカバーされていなかった場合\n      # @raise [RangeError] 出目の合計の最大値がカバーされていなかった場合\n      # @raise [RangeError] 出目の合計の範囲にずれや重なりがあった場合\n      #\n      # @example 表の定義（バトルテックの致命的命中表）\n      #   CRITICAL_TABLE = RangeTable.new(\n      #     '致命的命中表',\n      #     '2D6',\n      #     [\n      #       [2..7,   '致命的命中はなかった'],\n      #       [8..9,   '1箇所の致命的命中'],\n      #       [10..11, '2箇所の致命的命中'],\n      #       [12,     'その部位が吹き飛ぶ（腕、脚、頭）または3箇所の致命的命中（胴）']\n      #     ]\n      #   )\n      #\n      # @example 独自の結果整形処理を指定する場合\n      #   CRITICAL_TABLE_WITH_FORMATTER = RangeTable.new(\n      #     '致命的命中表',\n      #     '2D6',\n      #     [\n      #       [2..7,   '致命的命中はなかった'],\n      #       [8..9,   '1箇所の致命的命中'],\n      #       [10..11, '2箇所の致命的命中'],\n      #       [12,     'その部位が吹き飛ぶ（腕、脚、頭）または3箇所の致命的命中（胴）']\n      #     ]\n      #   ) do |table, result|\n      #     \"致命的命中発生? ＞ \#{result.sum}[\#{result.values}] ＞ \#{result.content}\"\n      #   end\n      #\n      #   CRITICAL_TABLE_WITH_FORMATTER.roll(bcdice).formatted\n      #   #=> \"致命的命中発生? ＞ 11[5,6] ＞ 2箇所の致命的命中\"\n      def initialize(name, dice_roll_method, items, &formatter)\n        @name = name.freeze\n        @formatter = formatter || DEFAULT_FORMATTER\n\n        m = DICE_ROLL_METHOD_RE.match(dice_roll_method)\n        unless m\n          raise(\n            ArgumentError,\n            \"\#{@name}: invalid dice roll method: \#{dice_roll_method}\"\n          )\n        end\n\n        @num_of_dice = m[1].to_i\n        @num_of_sides = m[2].to_i\n\n        store(items)\n      end\n\n      # 指定された値に対応する項目を返す\n      # @param [Integer] value 値（出目の合計）\n      # @return [Item] 指定された値に対応する項目\n      # @raise [RangeError] 範囲外の値が指定された場合\n      def fetch(value)\n        item = @items.find { |i| i.range.include?(value) }\n        unless item\n          raise RangeError, \"\#{@name}: value is out of range: \#{value}\"\n        end\n\n        return item\n      end\n\n      # 表を振る\n      # @param randomizer [#roll_barabara] ランダマイザ\n      # @return [RollResult] 表を振った結果\n      def roll(randomizer)\n        values = randomizer.roll_barabara(@num_of_dice, @num_of_sides)\n        sum = values.sum()\n\n        result = RollResult.new(sum, values, fetch(sum).content)\n        result.formatted = @formatter[self, result]\n\n        return result\n      end\n\n      private\n\n      # 表の項目を格納する\n      # @param [Array<(Range, Object)>, Array<(Integer, Object)>] items\n      #   表の項目の配列。[出目の合計の範囲, 内容]\n      # @return [self]\n      # @raise [TypeError] 範囲の型が正しくなかった場合\n      # @raise [RangeError] 出目の合計の最小値がカバーされていなかった場合\n      # @raise [RangeError] 出目の合計の最大値がカバーされていなかった場合\n      # @raise [RangeError] 出目の合計の範囲にずれや重なりがあった場合\n      def store(items)\n        items_with_range = items.map { |r, c| [coerce_to_int_range(r), c] }\n        sorted_items = items_with_range.sort_by { |r, _| r.min }\n\n        assert_min_sum_is_covered(sorted_items)\n        assert_max_sum_is_covered(sorted_items)\n        assert_no_gap_or_overlap_in_ranges(sorted_items)\n\n        @items = sorted_items\n                 .map { |range, content| Item.new(range, content.freeze).freeze }\n                 .freeze\n\n        self\n      end\n\n      # 引数を強制的に整数を要素とするRangeに変換する\n      # @param [Range, Integer] x 変換対象\n      # @return [Range] 整数を要素とするRange\n      # @raise [TypeError] xの型に対応していなかった場合\n      def coerce_to_int_range(x)\n        case x\n        when Integer\n          return Range.new(x, x)\n        when Range\n          if x.begin.is_a?(Integer) && x.end.is_a?(Integer)\n            return x\n          end\n        end\n\n        raise(\n          TypeError,\n          \"\#{@name}: \#{x} (\#{x.class}) must be an Integer or a Range with Integers \"\n        )\n      end\n\n      # 出目の合計の最小値がカバーされていることを確認する\n      # @param [Array<(Range, Object)>] sorted_items\n      #   ソートされた、項目の配列\n      # @return [self]\n      # @raise [RangeError] 出目の合計の最小値がカバーされていなかった場合\n      def assert_min_sum_is_covered(sorted_items)\n        min_sum = @num_of_dice\n        range = sorted_items.first[0]\n        unless range.include?(min_sum)\n          raise(\n            RangeError,\n            \"\#{@name}: min value (\#{min_sum}) is not covered: \#{range}\"\n          )\n        end\n\n        self\n      end\n\n      # 出目の合計の最大値がカバーされていることを確認する\n      # @param [Array<(Range, Object)>] sorted_items\n      #   ソートされた、項目の配列\n      # @return [self]\n      # @raise [RangeError] 出目の合計の最大値がカバーされていなかった場合\n      def assert_max_sum_is_covered(sorted_items)\n        max_sum = @num_of_dice * @num_of_sides\n        range = sorted_items.last[0]\n        unless range.include?(max_sum)\n          raise(\n            RangeError,\n            \"\#{@name}: max value (\#{max_sum}) is not covered: \#{range}\"\n          )\n        end\n\n        self\n      end\n\n      # 出目の合計の範囲にずれや重なりがないことを確認する\n      # @param [Array<(Range, Object)>] sorted_items\n      #   ソートされた、項目の配列\n      # @return [self]\n      # @raise [RangeError] 出目の合計の範囲にずれや重なりがあった場合\n      def assert_no_gap_or_overlap_in_ranges(sorted_items)\n        sorted_items.each_cons(2) do |i1, i2|\n          r1 = i1[0]\n          r2 = i2[0]\n\n          max1 = r1.max\n          next_of_max1 = max1 + 1\n\n          if r2.include?(max1)\n            raise RangeError, \"\#{@name}: Range overlap: \#{r1} and \#{r2}\"\n          end\n\n          unless r2.include?(next_of_max1)\n            raise RangeError, \"\#{@name}: Range gap: \#{r1} and \#{r2}\"\n          end\n        end\n\n        self\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:RangeTable>", "new", "Struct", "block in <class:RangeTable>", "block (2 levels) in <class:RangeTable>", "self", "alias_method", "freeze", "lambda", "table", "result", "name", "sum", "content", "attr_reader", "from_i18n", "key", "locale", "I18n", "t", "converted_items", "map", "[]", "block in from_i18n", "item", "block (2 levels) in from_i18n", "conv_string_range", "0", "1", "x", "Integer", "$ret_or_1", "String", "include?", "Range", "split", "2", "block in conv_string_range", "n", "block (2 levels) in conv_string_range", "raise", "TypeError", "@name", "class", "initialize", "dice_roll_method", "items", "@formatter", "formatter", "DEFAULT_FORMATTER", "m", "DICE_ROLL_METHOD_RE", "match", "ArgumentError", "@num_of_dice", "to_i", "@num_of_sides", "store", "fetch", "value", "find", "@items", "block in fetch", "i", "block (2 levels) in fetch", "range", "RangeError", "roll", "randomizer", "values", "roll_barabara", "RollResult", "formatted=", "private", "items_with_range", "block in store", "r", "c", "block (2 levels) in store", "coerce_to_int_range", "sorted_items", "sort_by", "_", "min", "assert_min_sum_is_covered", "assert_max_sum_is_covered", "assert_no_gap_or_overlap_in_ranges", "Item", "begin", "is_a?", "end", "min_sum", "first", "max_sum", "*", "last", "each_cons", "block in assert_no_gap_or_overlap_in_ranges", "i1", "i2", "block (2 levels) in assert_no_gap_or_overlap_in_ranges", "r1", "r2", "max1", "max", "next_of_max1", "+"], :mappings=>"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"}}, {:offset=>{:line=>989, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/sai_fic_skill_table/category.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    class SaiFicSkillTable\n      class Category\n        def initialize(name, skills, dice, s_format)\n          @name = name\n          @skills = skills.map.with_index(2) { |s, index| SaiFicSkillTable::Skill.new(name, s, dice, index, s_format) }\n          @dice = dice\n        end\n\n        def roll(randomizer)\n          skills[randomizer.roll_sum(2, 6) - 2]\n        end\n\n        def to_s\n          @name\n        end\n\n        attr_reader :name, :dice, :skills\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:SaiFicSkillTable>", "<class:Category>", "initialize", "name", "skills", "dice", "s_format", "@name", "@skills", "with_index", "map", "2", "block in initialize", "s", "index", "block (2 levels) in initialize", "SaiFicSkillTable::Skill", "SaiFicSkillTable", "new", "@dice", "roll", "randomizer", "self", "[]", "-", "roll_sum", "6", "to_s", "attr_reader"], :mappings=>"AAAAA,iEAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;QACEA,OAAAC;QAAAA;;UAAAA;;;;AACEC,UAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,MAAP,EAAeC,IAAf,EAAqBC,QAAnCJ;AAAAA,YAAAA;;;YACEK,YAAQJ;YACRK,cAAoBC,MAAVL,MAAMM,KAAAA,CAAAA,CAAID,cAAAA,EAAAA,CAAYE,CAAZF,CAAAA,EAAVG,aAA4BC,CAAD,EAAIC,KAA/BF;;cAA4B;cAAG;cAAOG,OAAAC,IAAAC,sBAAAD,UAAuBE,KAAAA,CAAKf,IAA5B,EAAkCU,CAAlC,EAAqCR,IAArC,EAA2CS,KAA3C,EAAkDR,QAA3BY,EAA7DN,CAAUH;YACpBP,OAAAiB,CAAAA,YAAQd,IAARc;UAHFjB,CAAAA;;AAMAkB,UAAAA,oBAAAA,gBAASC,UAATD;AAAAA,YAAAA;;YACEA,OAAAE,IAAAlB,QAAAA,CAAAA,CAAMmB,OAAAA,CAA2BC,UAA1BH,UAAUI,UAAAA,CAAUd,CAApB,EAAuBe,CAAbD,CAAgBD,EAAEb,CAAFa,CAA3BD;UADRH,CAAAA;;AAIAO,UAAAA,oBAAAA,aACE,MADFA,CAAAA;UAIA1B,OAAAqB,IAAAM,aAAAA,CAAY,MAAZ,EAAmB,MAAnB,EAA0B,QAA1BA;QAfF3B,GAAAA,WAAAA,EAAAA,IAAAA;MADFD,GAAAA,WAAAA,EAAAA,IAAAA;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1041, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/sai_fic_skill_table/skill.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    class SaiFicSkillTable\n      class Skill\n        def initialize(category_name, skill_name, category_dice, row_dice, s_format)\n          @category_name = category_name\n          @name = skill_name\n          @category_dice = category_dice\n          @row_dice = row_dice\n          @s_format = s_format\n        end\n\n        def to_s\n          format(@s_format, category_dice: @category_dice, row_dice: @row_dice, category_name: @category_name, skill_name: @name)\n        end\n\n        attr_reader :category_name, :name, :category_dice, :row_dice\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:SaiFicSkillTable>", "<class:Skill>", "initialize", "category_name", "skill_name", "category_dice", "row_dice", "s_format", "@category_name", "@name", "@category_dice", "@row_dice", "@s_format", "to_s", "self", "format", "attr_reader"], :mappings=>"AAAAA,8DAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;QACEA,OAAAC;QAAAA;;UAAAA;;AAAAA;;;AACEC,UAAAA,0BAAAA,sBAAeC,aAAD,EAAgBC,UAAhB,EAA4BC,aAA5B,EAA2CC,QAA3C,EAAqDC,QAAnEL;AAAAA,YAAAA;;;YACEM,qBAAiBL;YACjBM,YAAQL;YACRM,qBAAiBL;YACjBM,gBAAYL;YACZJ,OAAAU,CAAAA,gBAAYL,QAAZK;UALFV,CAAAA;;AAQAW,UAAAA,oBAAAA,gBAAAA;AAAAA,YAAAA;;YACEA,OAAAC,IAAAC,QAAAA,CAAOH,aAAP,EAAkB,sEAAA,iBAAeF,kBAAf,EAAA,YAAyCC,aAAzC,EAAA,iBAAmEH,kBAAnE,EAAA,cAA+FC,SAA/F,EAAlBM;UADFF,CAAAA;UAIAZ,OAAAa,IAAAE,aAAAA,CAAY,eAAZ,EAA4B,MAA5B,EAAmC,eAAnC,EAAmD,UAAnDA;QAbFf,GAAAA,WAAAA,EAAAA,IAAAA;MADFD,GAAAA,WAAAA,EAAAA,IAAAA;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1090, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/sai_fic_skill_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/dice_table/sai_fic_skill_table/category\"\nrequire \"bcdice/dice_table/sai_fic_skill_table/skill\"\n\nmodule BCDice\n  module DiceTable\n    class SaiFicSkillTable\n      # @param key    [String]\n      # @param locale [Symbol]\n      # @param rtt    [String] RTTに相当するコマンド\n      # @param rct    [String] RCTに相当するコマンド\n      # @param rttn   [Array]  RTT1～6に相当するコマンドの配列\n      # @return [SaiFicSkillTable]\n      def self.from_i18n(key, locale, rtt: nil, rct: nil, rttn: nil)\n        global = I18n.t(\"RTT\", locale: locale, raise: false, default: {})\n        table = global.merge(I18n.t(key, locale: locale, raise: true))\n        items = table[:items]\n        table = table.select { |k, _| [:rtt_format, :rttn_format, :rct_format, :s_format].include?(k) }\n        new(items, **table, rtt: rtt, rct: rct, rttn: rttn)\n      end\n\n      DEFAULT_RTT = \"ランダム特技表(%<category_dice>d,%<row_dice>d) ＞ %<text>s\"\n      DEFAULT_RCT = \"ランダム分野表(%<category_dice>d) ＞ %<category_name>s\"\n      DEFAULT_RTTN = \"%<category_name>s分野ランダム特技表(%<row_dice>d) ＞ %<text>s\"\n      DEFAULT_S = \"《%<skill_name>s／%<category_name>s%<row_dice>d》\"\n\n      # サイコロ・フィクション用ダイステーブルを初期化する。\n      # 既存の実装の互換性維持とルールブックの記載に準拠するために、コマンドと書式文字列を指定できる。\n      # @param items [Array] 特技リスト\n      # @param rtt          [String] RTTに相当するコマンド\n      # @param rct          [String] RCTに相当するコマンド\n      # @param rttn         [Array]  RTT1～6に相当するコマンドの配列\n      # @param rtt_format   [String] RTTコマンドの出力用の書式文字列\n      # @param rct_format   [String] RCTコマンドの出力用の書式文字列\n      # @param rttn_format  [String] RTTNコマンドの出力用の書式文字列\n      # @param s_format     [String] Skill#to_s出力用の書式文字列\n      def initialize(items, rtt: nil, rct: nil, rttn: nil, rtt_format: DEFAULT_RTT, rct_format: DEFAULT_RCT, rttn_format: DEFAULT_RTTN, s_format: DEFAULT_S)\n        @categories = items.map.with_index(1) do |(name, skills), index|\n          SaiFicSkillTable::Category.new(name, skills, index, s_format)\n        end\n        @rtt = rtt\n        @rct = rct\n        @rttn = rttn.to_a\n        @rtt_format = rtt_format\n        @rct_format = rct_format\n        @rttn_format = rttn_format\n      end\n\n      RTTN = [\"RTT1\", \"RTT2\", \"RTT3\", \"RTT4\", \"RTT5\", \"RTT6\"].freeze\n      attr_reader :categories\n\n      # コマンドを解釈し、結果を取得する\n      # return [String]\n      def roll_command(randomizer, command)\n        c = command\n        if [\"RTT\", @rtt].include?(c)\n          format_skill(@rtt_format, roll_skill(randomizer))\n        elsif [\"RCT\", @rct].include?(c)\n          cat = roll_category(randomizer)\n          format(@rct_format, category_dice: cat.dice, category_name: cat.name)\n        elsif (index = RTTN.index(c)) || (index = @rttn.index(c))\n          format_skill(@rttn_format, @categories[index].roll(randomizer))\n        end\n      end\n\n      # 1D6を振り、ランダムで分野を決定する\n      # @return [SaiFicSkillTable::Category]\n      def roll_category(randomizer)\n        @categories[randomizer.roll_once(6) - 1]\n      end\n\n      # 1D6と2D6を振り、ランダムで特技を決定する\n      # @return [SaiFicSkillTable::Skill]\n      def roll_skill(randomizer)\n        roll_category(randomizer).roll(randomizer)\n      end\n\n      def prefixes\n        ([\"RTT[1-6]?\", \"RCT\", @rtt, @rct] + @rttn).compact\n      end\n\n      private\n\n      def format_skill(format_string, skill)\n        format(format_string, category_dice: skill.category_dice, row_dice: skill.row_dice, category_name: skill.category_name, skill_name: skill.name, text: skill.to_s)\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:DiceTable>", "<class:SaiFicSkillTable>", "from_i18n", "key", "locale", "$kwargs", "global", "I18n", "t", "table", "merge", "items", "[]", "select", "block in from_i18n", "k", "_", "block (2 levels) in from_i18n", "include?", "new", "rtt", "rct", "rttn", "initialize", "DEFAULT_RTT", "DEFAULT_RCT", "DEFAULT_RTTN", "DEFAULT_S", "@categories", "with_index", "map", "1", "block in initialize", "$mlhs_tmp1", "index", "block (2 levels) in initialize", "name", "skills", "SaiFicSkillTable::Category", "SaiFicSkillTable", "s_format", "@rtt", "@rct", "@rttn", "to_a", "@rtt_format", "rtt_format", "@rct_format", "rct_format", "@rttn_format", "rttn_format", "freeze", "attr_reader", "roll_command", "randomizer", "command", "c", "format_skill", "roll_skill", "cat", "roll_category", "format", "dice", "RTTN", "roll", "-", "roll_once", "6", "prefixes", "+", "compact", "private", "format_string", "skill", "category_dice", "row_dice", "category_name", "to_s"], :mappings=>"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"}}, {:offset=>{:line=>1221, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table/table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module DiceTable\n    # 表を表すクラス\n    class Table\n      # @param key [String]\n      # @param locale [Symbol]\n      # @return [Table]\n      def self.from_i18n(key, locale)\n        table = I18n.t(key, locale: locale)\n        new(table[:name], table[:type], table[:items])\n      end\n\n      # @param [String] name 表の名前\n      # @param [String] type 項目を選ぶときのダイスロールの方法 '1D6'など\n      # @param [Array<String>] items 表の項目の配列\n      def initialize(name, type, items)\n        @name = name\n        @items = items.freeze\n\n        m = /(\\d+)D(\\d+)/i.match(type)\n        unless m\n          raise ArgumentError, \"Unexpected table type: \#{type}\"\n        end\n\n        @times = m[1].to_i\n        @sides = m[2].to_i\n      end\n\n      # 表を振る\n      # @param [BCDice] bcdice ランダマイザ\n      # @return [String] 結果\n      def roll(bcdice)\n        value = bcdice.roll_sum(@times, @sides)\n        return choice(value)\n      end\n\n      def choice(value)\n        index = value - @times\n        return RollResult.new(@name, value, @items[index])\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:DiceTable>", "<class:Table>", "from_i18n", "self", "key", "locale", "table", "I18n", "t", "new", "[]", "initialize", "name", "type", "items", "@name", "@items", "freeze", "m", "match", "raise", "ArgumentError", "@times", "1", "to_i", "@sides", "2", "roll", "bcdice", "value", "roll_sum", "choice", "index", "-", "RollResult"], :mappings=>"AAAAA,0CAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAEEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAIEC,MAAIC,IAAJD,gBAAAA,qBAAmBE,GAAD,EAAMC,MAAxBH;AAAAA,UAAAA;;;UACEI,QAAQC,UAAIC,GAAAA,CAAGJ,GAAP,EAAY,oBAAA,UAAQC,MAAR,EAARG;UACZN,OAAAC,IAAAM,KAAAA,CAAIH,KAAKI,OAAAA,CAAC,MAADA,CAAT,EAAkBJ,KAAKI,OAAAA,CAAC,MAADA,CAAvB,EAAgCJ,KAAKI,OAAAA,CAAC,OAADA,CAArCD;QAFFP,CAAAA;;AAQAS,QAAAA,0BAAAA,sBAAeC,IAAD,EAAOC,IAAP,EAAaC,KAA3BH;AAAAA,UAAAA;;;UACEI,YAAQH;UACRI,aAASF,KAAKG,QAAAA,CAAAA;UAEdC,IAAI,cAAcC,OAAAA,CAAON,IAAPM;UAClB,KAAA,QAAOD,CAAP,CAAA;YACEf,IAAAiB,OAAAA,CAAMC,mBAAN,EAAsBV,yBAAD,GAAA,CAA0BE,IAA1B,CAArBO;UADF;UAIAE,aAASJ,CAACR,OAAAA,CAACa,CAADb,CAAGc,MAAAA,CAAAA;UACbb,OAAAc,CAAAA,aAASP,CAACR,OAAAA,CAACgB,CAADhB,CAAGc,MAAAA,CAAAA,CAAbC;QAVFd,CAAAA;;AAgBAgB,QAAAA,oBAAAA,gBAASC,MAATD;AAAAA,UAAAA;;;UACEE,QAAQD,MAAME,UAAAA,CAAUR,UAAhB,EAAwBG,UAAlBK;UACd,OAAO3B,IAAA4B,QAAAA,CAAOF,KAAPE;QAFTJ,CAAAA;QAKA1B,OAAA8B,sBAAAA,kBAAWF,KAAXE;AAAAA,UAAAA;;;UACEC,QAAcC,UAANJ,KAAMI,EAAEX,UAAFW;UACd,OAAOC,gBAAUzB,KAAAA,CAAKM,SAAf,EAAsBc,KAAtB,EAA6Bb,UAAMN,OAAAA,CAACsB,KAADtB,CAAzBD;QAFnBsB,CAAAA;MAjCF9B,GAAAA,WAAAA,EAAAA,IAAAA;IAFFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1282, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/dice_table.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/dice_table/roll_result\"\nrequire \"bcdice/dice_table/chain_table\"\nrequire \"bcdice/dice_table/d66_grid_table\"\nrequire \"bcdice/dice_table/d66_half_grid_table\"\nrequire \"bcdice/dice_table/d66_one_third_table\"\nrequire \"bcdice/dice_table/d66_left_range_table\"\nrequire \"bcdice/dice_table/d66_parity_table\"\nrequire \"bcdice/dice_table/d66_range_table\"\nrequire \"bcdice/dice_table/d66_table\"\nrequire \"bcdice/dice_table/range_table\"\nrequire \"bcdice/dice_table/sai_fic_skill_table\"\nrequire \"bcdice/dice_table/table\"\n"], :names=>["<top (required)>", "self", "require"], :mappings=>"AAAAA,oCAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,+BAARE;EACAD,IAAAC,SAAAA,CAAQF,+BAARE;EACAD,IAAAC,SAAAA,CAAQF,kCAARE;EACAD,IAAAC,SAAAA,CAAQF,uCAARE;EACAD,IAAAC,SAAAA,CAAQF,uCAARE;EACAD,IAAAC,SAAAA,CAAQF,wCAARE;EACAD,IAAAC,SAAAA,CAAQF,oCAARE;EACAD,IAAAC,SAAAA,CAAQF,mCAARE;EACAD,IAAAC,SAAAA,CAAQF,6BAARE;EACAD,IAAAC,SAAAA,CAAQF,+BAARE;EACAD,IAAAC,SAAAA,CAAQF,uCAARE;EACAF,OAAAC,IAAAC,SAAAA,CAAQF,yBAARE;AAbAF;"}}, {:offset=>{:line=>1300, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/enum.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  # D66のダイス入れ替え\n  module D66SortType\n    NO_SORT = :no_sort # 入れ替えない\n    ASC = :asc # 一の位が大きな出目になるよう、昇順にソートする\n    DESC = :desc # 一の位が小さな出目になるよう、降順にソートする\n  end\n\n  # 割り算をした後の端数の扱い\n  module RoundType\n    CEIL = :ceil # 切り上げ\n    FLOOR = :floor # 切り捨て\n    ROUND = :round # 四捨五入\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:D66SortType>", "<module:RoundType>"], :mappings=>"AAAAA,8BAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;;IAEEC;IAAAA;;MAAAA;;;MACE,mCAAU,SAAV;MACA,+BAAM,KAAN;MACAA,OAAA,gCAAO,MAAP;IAHFA,GAAAA,WAAAA;IAOAD,OAAAE;IAAAA;;MAAAA;;;MACE,gCAAO,MAAP;MACA,iCAAQ,OAAR;MACAA,OAAA,iCAAQ,OAAR;IAHFA,GAAAA,WAAAA;EATFF,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1332, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/translate.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  # i18n用のモジュール\n  module Translate\n    # i18n用の翻訳メソッド\n    # @param key [String]\n    # @return [Object]\n    def translate(key, **options)\n      I18n.translate(key, locale: @locale, raise: true, **options)\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:Translate>", "translate", "key", "$kwargs", "I18n", "@locale", "options"], :mappings=>"AAAAA,mCAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IAEEA,OAAAC;IAAAA;;MAAAA;;MAIEA,OAAAC,yBAAAA,qBAAcC,GAAD,EARjBC,OAQIF;AAAAA,QAAAA;AAAAA;;;QARJ;QAQuB;QACjBA,OAAAG,UAAIH,WAAAA,CAAWC,GAAf,EAAoB,6BAAA,UAAQG,WAAR,EAAA,SAAwB,IAAxB,EAAA,QAA8B,aAAEC,OAAF,CAA9B,CAAhBL;MADNA,CAAAA,IAAAA;IAJFD,GAAAA,WAAAA;EAFFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1358, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/result.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  # ダイスロールの結果を表すクラス\n  #\n  # コマンドの結果の文字列や、成功／失敗／クリティカル／ファンブルの情報を保持する。\n  # 成功／失敗は同時に発生しないこととする。\n  # 成功／失敗のペアとクリティカル、ファンブルの三者は独立した要素とし、\n  # 「クリティカルだが失敗」や「ファンブルだが成功でも失敗でもない」を許容する。\n  class Result\n    class << self\n      # +success+ が設定された +Result+ を作成する\n      #\n      # @param text [String]\n      # @return [Result]\n      def success(text)\n        new.tap do |r|\n          r.text = text\n          r.success = true\n        end\n      end\n\n      # +failure+ が設定された +Result+ を作成する\n      #\n      # @param text [String]\n      # @return [Result]\n      def failure(text)\n        new.tap do |r|\n          r.text = text\n          r.failure = true\n        end\n      end\n\n      # +success+ と +critical+ が設定された +Result+ を作成する\n      #\n      # @param text [String]\n      # @return [Result]\n      def critical(text)\n        new.tap do |r|\n          r.text = text\n          r.critical = true\n          r.success = true\n        end\n      end\n\n      # +failure+ と +fumble+ が設定された +Result+ を作成する\n      #\n      # @param text [String]\n      # @return [Result]\n      def fumble(text)\n        new.tap do |r|\n          r.text = text\n          r.fumble = true\n          r.failure = true\n        end\n      end\n\n      # その後の判定で何もすることがないことを示すために利用する\n      #\n      # @return [:nothing]\n      def nothing\n        :nothing\n      end\n    end\n\n    # @param text [String | nil]\n    def initialize(text = nil)\n      @text = text\n      @rands = nil\n      @detailed_rands = nil\n      @secret = false\n      @success = false\n      @failure = false\n      @critical = false\n      @fumble = false\n    end\n\n    attr_accessor :text, :rands, :detailed_rands\n    attr_writer :secret, :success, :failure, :critical, :fumble\n\n    # @return [Boolean]\n    def secret?\n      @secret\n    end\n\n    # @return [Boolean]\n    def success?\n      @success\n    end\n\n    # @return [Boolean]\n    def failure?\n      @failure\n    end\n\n    # @return [Boolean]\n    def critical?\n      @critical\n    end\n\n    # @return [Boolean]\n    def fumble?\n      @fumble\n    end\n\n    # @param condition [Boolean]\n    # @return [void]\n    def condition=(condition)\n      @success = condition\n      @failure = !condition\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<class:Result>", "success", "text", "tap", "self", "new", "block in success", "r", "block (2 levels) in success", "text=", "success=", "failure", "block in failure", "block (2 levels) in failure", "failure=", "critical", "block in critical", "block (2 levels) in critical", "critical=", "fumble", "block in fumble", "block (2 levels) in fumble", "fumble=", "nothing", "initialize", "@text", "@rands", "@detailed_rands", "@secret", "@success", "@failure", "@critical", "@fumble", "attr_accessor", "attr_writer", "secret?", "success?", "failure?", "critical?", "fumble?", "condition=", "condition", "!"], :mappings=>"AAAAA,gCAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IAOEA,OAAAC;IAAAA;;MAAAA;;;MACE;;;;AAKEC,QAAAA,uBAAAA,mBAAYC,IAAZD;AAAAA,UAAAA;;UACEA,OAAGE,MAAHC,IAAAC,KAAAA,CAAAA,CAAGF,OAAAA,EAAAA,EAAAA,EAAHG,aAAYC,CAAZD,EAAAE;;;YAAY;YACVD,CAACE,UAAAA,CAAQP,IAARO;YACDD,OAACE,MAAAA,CAAW,IAAXA,CAAAA,EAAAA,MAADH,CAACG,YAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAFHJ,CAAGH;QADLF,CAAAA;;AAWAU,QAAAA,uBAAAA,mBAAYT,IAAZS;AAAAA,UAAAA;;UACEA,OAAGR,MAAHC,IAAAC,KAAAA,CAAAA,CAAGF,OAAAA,EAAAA,EAAAA,EAAHS,aAAYL,CAAZK,EAAAC;;;YAAY;YACVN,CAACE,UAAAA,CAAQP,IAARO;YACDI,OAACC,MAAAA,CAAW,IAAXA,CAAAA,EAAAA,MAADP,CAACO,YAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAFHF,CAAGT;QADLQ,CAAAA;;AAWAI,QAAAA,wBAAAA,oBAAab,IAAba;AAAAA,UAAAA;;UACEA,OAAGZ,MAAHC,IAAAC,KAAAA,CAAAA,CAAGF,OAAAA,EAAAA,EAAAA,EAAHa,aAAYT,CAAZS,EAAAC;;;YAAY;YACVV,CAACE,UAAAA,CAAQP,IAARO;YACDF,CAACW,cAAAA,CAAY,IAAZA;YACDD,OAACP,MAAAA,CAAW,IAAXA,CAAAA,EAAAA,MAADH,CAACG,YAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAHHM,CAAGb;QADLY,CAAAA;;AAYAI,QAAAA,sBAAAA,kBAAWjB,IAAXiB;AAAAA,UAAAA;;UACEA,OAAGhB,MAAHC,IAAAC,KAAAA,CAAAA,CAAGF,OAAAA,EAAAA,EAAAA,EAAHiB,aAAYb,CAAZa,EAAAC;;;YAAY;YACVd,CAACE,UAAAA,CAAQP,IAARO;YACDF,CAACe,YAAAA,CAAU,IAAVA;YACDD,OAACP,MAAAA,CAAW,IAAXA,CAAAA,EAAAA,MAADP,CAACO,YAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAHHM,CAAGjB;QADLgB,CAAAA;QAWA,OAAAI,uBAAAA,YACE,SADFA,CAAAA;MAlDF,4BAASnB,IAAT;;AAwDAoB,MAAAA,0BAAAA,sBAAetB,IAAfsB;AAAAA,QAAAA;;;QAAe,yBAAO;QACpBC,YAAQvB;QACRwB,aAAS;QACTC,sBAAkB;QAClBC,cAAU;QACVC,eAAW;QACXC,eAAW;QACXC,gBAAY;QACZP,OAAAQ,CAAAA,cAAU,KAAVA;MARFR,CAAAA,IAAAA;MAWApB,IAAA6B,eAAAA,CAAc,MAAd,EAAqB,OAArB,EAA6B,gBAA7BA;MACA7B,IAAA8B,aAAAA,CAAY,QAAZ,EAAqB,SAArB,EAA+B,SAA/B,EAAyC,UAAzC,EAAoD,QAApDA;;AAGAC,MAAAA,uBAAAA,aACE,QADFA,CAAAA;;AAKAC,MAAAA,wBAAAA,aACE,SADFA,CAAAA;;AAKAC,MAAAA,wBAAAA,aACE,SADFA,CAAAA;;AAKAC,MAAAA,yBAAAA,aACE,UADFA,CAAAA;;AAKAC,MAAAA,uBAAAA,aACE,QADFA,CAAAA;MAMAvC,OAAAwC,0BAAAA,gCAAeC,SAAfD;AAAAA,QAAAA;;;QACEX,eAAWY;QACXD,OAAAV,CAAAA,eAAYW,SAADC,MAAAA,CAAAA,CAAXZ;MAFFU,CAAAA;IAlGFxC,GAAAA,WAAAA,EAAAA,IAAAA;EAPFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>1461, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["racc/parser.rb"], :sourcesContent=>["# Opal port of racc/parser.rb.\n#\n# Original license:\n#\n# frozen_string_literal: false\n#--\n# $originalId: parser.rb,v 1.8 2006/07/06 11:42:07 aamine Exp $\n#\n# Copyright (c) 1999-2006 Minero Aoki\n#\n# This program is free software.\n# You can distribute/modify this program under the same terms of ruby.\n#\n# As a special exception, when this code is copied by Racc\n# into a Racc output file, you may use that output file\n# without restriction.\n#++\n\nmodule Racc\n  class ParseError < StandardError; end\nend\nunless defined?(::ParseError)\n  ParseError = Racc::ParseError\nend\n\n# Racc is a LALR(1) parser generator.\n# It is written in Ruby itself, and generates Ruby programs.\n#\n# == Command-line Reference\n#\n#     racc [-o<var>filename</var>] [--output-file=<var>filename</var>]\n#          [-e<var>rubypath</var>] [--embedded=<var>rubypath</var>]\n#          [-v] [--verbose]\n#          [-O<var>filename</var>] [--log-file=<var>filename</var>]\n#          [-g] [--debug]\n#          [-E] [--embedded]\n#          [-l] [--no-line-convert]\n#          [-c] [--line-convert-all]\n#          [-a] [--no-omit-actions]\n#          [-C] [--check-only]\n#          [-S] [--output-status]\n#          [--version] [--copyright] [--help] <var>grammarfile</var>\n#\n# [+filename+]\n#   Racc grammar file. Any extension is permitted.\n# [-o+outfile+, --output-file=+outfile+]\n#   A filename for output. default is <+filename+>.tab.rb\n# [-O+filename+, --log-file=+filename+]\n#   Place logging output in file +filename+.\n#   Default log file name is <+filename+>.output.\n# [-e+rubypath+, --executable=+rubypath+]\n#   output executable file(mode 755). where +path+ is the Ruby interpreter.\n# [-v, --verbose]\n#   verbose mode. create +filename+.output file, like yacc's y.output file.\n# [-g, --debug]\n#   add debug code to parser class. To display debugging information,\n#   use this '-g' option and set @yydebug true in parser class.\n# [-E, --embedded]\n#   Output parser which doesn't need runtime files (racc/parser.rb).\n# [-C, --check-only]\n#   Check syntax of racc grammar file and quit.\n# [-S, --output-status]\n#   Print messages time to time while compiling.\n# [-l, --no-line-convert]\n#   turns off line number converting.\n# [-c, --line-convert-all]\n#   Convert line number of actions, inner, header and footer.\n# [-a, --no-omit-actions]\n#   Call all actions, even if an action is empty.\n# [--version]\n#   print Racc version and quit.\n# [--copyright]\n#   Print copyright and quit.\n# [--help]\n#   Print usage and quit.\n#\n# == Generating Parser Using Racc\n#\n# To compile Racc grammar file, simply type:\n#\n#   $ racc parse.y\n#\n# This creates Ruby script file \"parse.tab.y\". The -o option can change the output filename.\n#\n# == Writing A Racc Grammar File\n#\n# If you want your own parser, you have to write a grammar file.\n# A grammar file contains the name of your parser class, grammar for the parser,\n# user code, and anything else.\n# When writing a grammar file, yacc's knowledge is helpful.\n# If you have not used yacc before, Racc is not too difficult.\n#\n# Here's an example Racc grammar file.\n#\n#   class Calcparser\n#   rule\n#     target: exp { print val[0] }\n#\n#     exp: exp '+' exp\n#        | exp '*' exp\n#        | '(' exp ')'\n#        | NUMBER\n#   end\n#\n# Racc grammar files resemble yacc files.\n# But (of course), this is Ruby code.\n# yacc's $$ is the 'result', $0, $1... is\n# an array called 'val', and $-1, $-2... is an array called '_values'.\n#\n# See the {Grammar File Reference}[rdoc-ref:lib/racc/rdoc/grammar.en.rdoc] for\n# more information on grammar files.\n#\n# == Parser\n#\n# Then you must prepare the parse entry method. There are two types of\n# parse methods in Racc, Racc::Parser#do_parse and Racc::Parser#yyparse\n#\n# Racc::Parser#do_parse is simple.\n#\n# It's yyparse() of yacc, and Racc::Parser#next_token is yylex().\n# This method must returns an array like [TOKENSYMBOL, ITS_VALUE].\n# EOF is [false, false].\n# (TOKENSYMBOL is a Ruby symbol (taken from String#intern) by default.\n# If you want to change this, see the grammar reference.\n#\n# Racc::Parser#yyparse is little complicated, but useful.\n# It does not use Racc::Parser#next_token, instead it gets tokens from any iterator.\n#\n# For example, <code>yyparse(obj, :scan)</code> causes\n# calling +obj#scan+, and you can return tokens by yielding them from +obj#scan+.\n#\n# == Debugging\n#\n# When debugging, \"-v\" or/and the \"-g\" option is helpful.\n#\n# \"-v\" creates verbose log file (.output).\n# \"-g\" creates a \"Verbose Parser\".\n# Verbose Parser prints the internal status when parsing.\n# But it's _not_ automatic.\n# You must use -g option and set +@yydebug+ to +true+ in order to get output.\n# -g option only creates the verbose parser.\n#\n# === Racc reported syntax error.\n#\n# Isn't there too many \"end\"?\n# grammar of racc file is changed in v0.10.\n#\n# Racc does not use '%' mark, while yacc uses huge number of '%' marks..\n#\n# === Racc reported \"XXXX conflicts\".\n#\n# Try \"racc -v xxxx.y\".\n# It causes producing racc's internal log file, xxxx.output.\n#\n# === Generated parsers does not work correctly\n#\n# Try \"racc -g xxxx.y\".\n# This command let racc generate \"debugging parser\".\n# Then set @yydebug=true in your parser.\n# It produces a working log of your parser.\n#\n# == Re-distributing Racc runtime\n#\n# A parser, which is created by Racc, requires the Racc runtime module;\n# racc/parser.rb.\n#\n# Ruby 1.8.x comes with Racc runtime module,\n# you need NOT distribute Racc runtime files.\n#\n# If you want to include the Racc runtime module with your parser.\n# This can be done by using '-E' option:\n#\n#   $ racc -E -omyparser.rb myparser.y\n#\n# This command creates myparser.rb which `includes' Racc runtime.\n# Only you must do is to distribute your parser file (myparser.rb).\n#\n# Note: parser.rb is LGPL, but your parser is not.\n# Your own parser is completely yours.\nmodule Racc\n\n  unless defined?(Racc_No_Extensions)\n    Racc_No_Extensions = false # :nodoc:\n  end\n\n  class Parser\n\n    Racc_Runtime_Version = '1.4.6'\n    Racc_Runtime_Revision = %w$originalRevision: 1.8 $[1]\n\n    Racc_Runtime_Core_Version_R = '1.4.6'\n    Racc_Runtime_Core_Revision_R = %w$originalRevision: 1.8 $[1]\n    # DISABLED: opal has no racc/cparse\n    # begin\n    #   require 'racc/cparse'\n    # # Racc_Runtime_Core_Version_C  = (defined in extension)\n    #   Racc_Runtime_Core_Revision_C = Racc_Runtime_Core_Id_C.split[2]\n    #   unless new.respond_to?(:_racc_do_parse_c, true)\n    #     raise LoadError, 'old cparse.so'\n    #   end\n    #   if Racc_No_Extensions\n    #     raise LoadError, 'selecting ruby version of racc runtime core'\n    #   end\n    #\n    #   Racc_Main_Parsing_Routine    = :_racc_do_parse_c # :nodoc:\n    #   Racc_YY_Parse_Method         = :_racc_yyparse_c # :nodoc:\n    #   Racc_Runtime_Core_Version    = Racc_Runtime_Core_Version_C # :nodoc:\n    #   Racc_Runtime_Core_Revision   = Racc_Runtime_Core_Revision_C # :nodoc:\n    #   Racc_Runtime_Type            = 'c' # :nodoc:\n    # rescue LoadError\n      Racc_Main_Parsing_Routine    = :_racc_do_parse_rb\n      Racc_YY_Parse_Method         = :_racc_yyparse_rb\n      Racc_Runtime_Core_Version    = Racc_Runtime_Core_Version_R\n      Racc_Runtime_Core_Revision   = Racc_Runtime_Core_Revision_R\n      Racc_Runtime_Type            = 'ruby'\n    # end\n\n    def Parser.racc_runtime_type # :nodoc:\n      Racc_Runtime_Type\n    end\n\n    def _racc_setup\n      @yydebug = false unless self.class::Racc_debug_parser\n      @yydebug = false unless defined?(@yydebug)\n      if @yydebug\n        @racc_debug_out = $stderr unless defined?(@racc_debug_out)\n        @racc_debug_out ||= $stderr\n      end\n      arg = self.class::Racc_arg\n      arg[13] = true if arg.size < 14\n      arg\n    end\n\n    def _racc_init_sysvars\n      @racc_state  = [0]\n      @racc_tstack = []\n      @racc_vstack = []\n\n      @racc_t = nil\n      @racc_val = nil\n\n      @racc_read_next = true\n\n      @racc_user_yyerror = false\n      @racc_error_status = 0\n    end\n\n    # The entry point of the parser. This method is used with #next_token.\n    # If Racc wants to get token (and its value), calls next_token.\n    #\n    # Example:\n    #     def parse\n    #       @q = [[1,1],\n    #             [2,2],\n    #             [3,3],\n    #             [false, '$']]\n    #       do_parse\n    #     end\n    #\n    #     def next_token\n    #       @q.shift\n    #     end\n    def do_parse\n      __send__(Racc_Main_Parsing_Routine, _racc_setup(), false)\n    end\n\n    # The method to fetch next token.\n    # If you use #do_parse method, you must implement #next_token.\n    #\n    # The format of return value is [TOKEN_SYMBOL, VALUE].\n    # +token-symbol+ is represented by Ruby's symbol by default, e.g. :IDENT\n    # for 'IDENT'.  \";\" (String) for ';'.\n    #\n    # The final symbol (End of file) must be false.\n    def next_token\n      raise NotImplementedError, \"\#{self.class}\\#next_token is not defined\"\n    end\n\n    def _racc_do_parse_rb(arg, in_debug)\n      action_table, action_check, action_default, action_pointer,\n      _,            _,            _,              _,\n      _,            _,            token_table,    _,\n      _,            _,            * = arg\n\n      _racc_init_sysvars\n      tok = act = i = nil\n\n      catch(:racc_end_parse) {\n        while true\n          if i = action_pointer[@racc_state[-1]]\n            if @racc_read_next\n              if @racc_t != 0   # not EOF\n                tok, @racc_val = next_token()\n                unless tok      # EOF\n                  @racc_t = 0\n                else\n                  @racc_t = (token_table[tok] or 1)   # error token\n                end\n                racc_read_token(@racc_t, tok, @racc_val) if @yydebug\n                @racc_read_next = false\n              end\n            end\n            i += @racc_t\n            unless i >= 0 and\n                   act = action_table[i] and\n                   action_check[i] == @racc_state[-1]\n              act = action_default[@racc_state[-1]]\n            end\n          else\n            act = action_default[@racc_state[-1]]\n          end\n          while act = _racc_evalact(act, arg)\n            ;\n          end\n        end\n      }\n    end\n\n    # Another entry point for the parser.\n    # If you use this method, you must implement RECEIVER#METHOD_ID method.\n    #\n    # RECEIVER#METHOD_ID is a method to get next token.\n    # It must 'yield' the token, which format is [TOKEN-SYMBOL, VALUE].\n    def yyparse(recv, mid)\n      __send__(Racc_YY_Parse_Method, recv, mid, _racc_setup(), true)\n    end\n\n    def _racc_yyparse_rb(recv, mid, arg, c_debug)\n      action_table, action_check, action_default, action_pointer,\n      _,             _,            _,              _,\n      _,            _,            token_table,    _,\n      _,            _,            * = arg\n\n      _racc_init_sysvars\n      act = nil\n      i = nil\n\n      catch(:racc_end_parse) {\n        until i = action_pointer[@racc_state[-1]]\n          while act = _racc_evalact(action_default[@racc_state[-1]], arg)\n            ;\n          end\n        end\n        recv.__send__(mid) do |tok, val|\n          unless tok\n            @racc_t = 0\n          else\n            @racc_t = (token_table[tok] or 1)   # error token\n          end\n          @racc_val = val\n          @racc_read_next = false\n\n          i += @racc_t\n          unless i >= 0 and\n                 act = action_table[i] and\n                 action_check[i] == @racc_state[-1]\n            act = action_default[@racc_state[-1]]\n          end\n          while act = _racc_evalact(act, arg)\n            ;\n          end\n\n          while not(i = action_pointer[@racc_state[-1]]) or\n                not @racc_read_next or\n                @racc_t == 0   # $\n            unless i and i += @racc_t and\n                   i >= 0 and\n                   act = action_table[i] and\n                   action_check[i] == @racc_state[-1]\n              act = action_default[@racc_state[-1]]\n            end\n            while act = _racc_evalact(act, arg)\n              ;\n            end\n          end\n        end\n      }\n    end\n\n    ###\n    ### common\n    ###\n\n    def _racc_evalact(act, arg)\n      action_table, action_check, _, action_pointer,\n      _,   _, _, _,\n      _,   _, _, shift_n,  reduce_n,\n      _,   _, * = arg\n\n      if act > 0 and act < shift_n\n        #\n        # shift\n        #\n        if @racc_error_status > 0\n          @racc_error_status -= 1 unless @racc_t == 1   # error token\n        end\n        @racc_vstack.push @racc_val\n        @racc_state.push act\n        @racc_read_next = true\n        if @yydebug\n          @racc_tstack.push @racc_t\n          racc_shift @racc_t, @racc_tstack, @racc_vstack\n        end\n\n      elsif act < 0 and act > -reduce_n\n        #\n        # reduce\n        #\n        code = catch(:racc_jump) {\n          @racc_state.push _racc_do_reduce(arg, act)\n          false\n        }\n        if code\n          case code\n          when 1 # yyerror\n            @racc_user_yyerror = true   # user_yyerror\n            return -reduce_n\n          when 2 # yyaccept\n            return shift_n\n          else\n            raise '[Racc Bug] unknown jump code'\n          end\n        end\n\n      elsif act == shift_n\n        #\n        # accept\n        #\n        racc_accept if @yydebug\n        throw :racc_end_parse, @racc_vstack[0]\n\n      elsif act == -reduce_n\n        #\n        # error\n        #\n        case @racc_error_status\n        when 0\n          unless arg[21]    # user_yyerror\n            on_error @racc_t, @racc_val, @racc_vstack\n          end\n        when 3\n          if @racc_t == 0   # is $\n            throw :racc_end_parse, nil\n          end\n          @racc_read_next = true\n        end\n        @racc_user_yyerror = false\n        @racc_error_status = 3\n        while true\n          if i = action_pointer[@racc_state[-1]]\n            i += 1   # error token\n            if  i >= 0 and\n                (act = action_table[i]) and\n                action_check[i] == @racc_state[-1]\n              break\n            end\n          end\n          throw :racc_end_parse, nil if @racc_state.size <= 1\n          @racc_state.pop\n          @racc_vstack.pop\n          if @yydebug\n            @racc_tstack.pop\n            racc_e_pop @racc_state, @racc_tstack, @racc_vstack\n          end\n        end\n        return act\n\n      else\n        raise \"[Racc Bug] unknown action \#{act.inspect}\"\n      end\n\n      racc_next_state(@racc_state[-1], @racc_state) if @yydebug\n\n      nil\n    end\n\n    def _racc_do_reduce(arg, act)\n      _, _, _, _,\n      goto_table,   goto_check,   goto_default,   goto_pointer,\n      nt_base,      reduce_table, _,    _,\n      _,     use_result,   * = arg\n      state = @racc_state\n      vstack = @racc_vstack\n      tstack = @racc_tstack\n\n      i = act * -3\n      len       = reduce_table[i]\n      reduce_to = reduce_table[i+1]\n      method_id = reduce_table[i+2]\n      void_array = []\n\n      tmp_t = tstack[-len, len] if @yydebug\n      tmp_v = vstack[-len, len]\n      tstack[-len, len] = void_array if @yydebug\n      vstack[-len, len] = void_array\n      state[-len, len]  = void_array\n\n      # tstack must be updated AFTER method call\n      if use_result\n        vstack.push __send__(method_id, tmp_v, vstack, tmp_v[0])\n      else\n        vstack.push __send__(method_id, tmp_v, vstack)\n      end\n      tstack.push reduce_to\n\n      racc_reduce(tmp_t, reduce_to, tstack, vstack) if @yydebug\n\n      k1 = reduce_to - nt_base\n      if i = goto_pointer[k1]\n        i += state[-1]\n        if i >= 0 and (curstate = goto_table[i]) and goto_check[i] == k1\n          return curstate\n        end\n      end\n      goto_default[k1]\n    end\n\n    # This method is called when a parse error is found.\n    #\n    # ERROR_TOKEN_ID is an internal ID of token which caused error.\n    # You can get string representation of this ID by calling\n    # #token_to_str.\n    #\n    # ERROR_VALUE is a value of error token.\n    #\n    # value_stack is a stack of symbol values.\n    # DO NOT MODIFY this object.\n    #\n    # This method raises ParseError by default.\n    #\n    # If this method returns, parsers enter \"error recovering mode\".\n    def on_error(t, val, vstack)\n      raise ParseError, sprintf(\"\\nparse error on value %s (%s)\",\n                                val.inspect, token_to_str(t) || '?')\n    end\n\n    # Enter error recovering mode.\n    # This method does not call #on_error.\n    def yyerror\n      throw :racc_jump, 1\n    end\n\n    # Exit parser.\n    # Return value is Symbol_Value_Stack[0].\n    def yyaccept\n      throw :racc_jump, 2\n    end\n\n    # Leave error recovering mode.\n    def yyerrok\n      @racc_error_status = 0\n    end\n\n    # For debugging output\n    def racc_read_token(t, tok, val)\n      @racc_debug_out.print 'read    '\n      @racc_debug_out.print tok.inspect, '(', racc_token2str(t), ') '\n      @racc_debug_out.puts val.inspect\n      @racc_debug_out.puts\n    end\n\n    def racc_shift(tok, tstack, vstack)\n      @racc_debug_out.puts \"shift   \#{racc_token2str tok}\"\n      racc_print_stacks tstack, vstack\n      @racc_debug_out.puts\n    end\n\n    def racc_reduce(toks, sim, tstack, vstack)\n      out = @racc_debug_out\n      out.print 'reduce '\n      if toks.empty?\n        out.print ' <none>'\n      else\n        toks.each {|t| out.print ' ', racc_token2str(t) }\n      end\n      out.puts \" --> \#{racc_token2str(sim)}\"\n\n      racc_print_stacks tstack, vstack\n      @racc_debug_out.puts\n    end\n\n    def racc_accept\n      @racc_debug_out.puts 'accept'\n      @racc_debug_out.puts\n    end\n\n    def racc_e_pop(state, tstack, vstack)\n      @racc_debug_out.puts 'error recovering mode: pop token'\n      racc_print_states state\n      racc_print_stacks tstack, vstack\n      @racc_debug_out.puts\n    end\n\n    def racc_next_state(curstate, state)\n      @racc_debug_out.puts  \"goto    \#{curstate}\"\n      racc_print_states state\n      @racc_debug_out.puts\n    end\n\n    def racc_print_stacks(t, v)\n      out = @racc_debug_out\n      out.print '        ['\n      t.each_index do |i|\n        out.print ' (', racc_token2str(t[i]), ' ', v[i].inspect, ')'\n      end\n      out.puts ' ]'\n    end\n\n    def racc_print_states(s)\n      out = @racc_debug_out\n      out.print '        ['\n      s.each {|st| out.print ' ', st }\n      out.puts ' ]'\n    end\n\n    def racc_token2str(tok)\n      self.class::Racc_token_to_s_table[tok] or\n          raise \"[Racc Bug] can't convert token \#{tok} to string\"\n    end\n\n    # Convert internal ID of token symbol to the string.\n    def token_to_str(t)\n      self.class::Racc_token_to_s_table[t]\n    end\n\n  end\n\nend\n"], :names=>["<top (required)>", "<module:Racc>", "<class:ParseError>", "StandardError", "Racc::ParseError", "Racc", "<class:Parser>", "[]", "1", "Racc_Runtime_Core_Version_R", "Racc_Runtime_Core_Revision_R", "racc_runtime_type", "Parser", "Racc_Runtime_Type", "_racc_setup", "class::Racc_debug_parser", "self", "class", "@yydebug", "@racc_debug_out", "$stderr", "$ret_or_1", "arg", "class::Racc_arg", "<", "size", "14", "[]=", "13", "_racc_init_sysvars", "@racc_state", "0", "@racc_tstack", "@racc_vstack", "@racc_t", "@racc_val", "@racc_read_next", "@racc_user_yyerror", "@racc_error_status", "do_parse", "__send__", "Racc_Main_Parsing_Routine", "next_token", "raise", "NotImplementedError", "_racc_do_parse_rb", "in_debug", "action_table", "action_check", "action_default", "action_pointer", "_", "token_table", "tok", "act", "i", "catch", "block in _racc_do_parse_rb", "block (2 levels) in _racc_do_parse_rb", "-1", "racc_read_token", "+", ">=", "_racc_evalact", "yyparse", "recv", "mid", "Racc_YY_Parse_Method", "_racc_yyparse_rb", "c_debug", "block in _racc_yyparse_rb", "block (2 levels) in _racc_yyparse_rb", "val", "block (3 levels) in _racc_yyparse_rb", "$ret_or_2", "!", "==", "shift_n", "reduce_n", ">", "-", "push", "racc_shift", "-@", "code", "block in _racc_evalact", "block (2 levels) in _racc_evalact", "_racc_do_reduce", "2", "racc_accept", "throw", "21", "on_error", "3", "<=", "pop", "racc_e_pop", "inspect", "racc_next_state", "goto_table", "goto_check", "goto_default", "goto_pointer", "nt_base", "reduce_table", "use_result", "state", "vstack", "tstack", "*", "-3", "len", "reduce_to", "method_id", "void_array", "tmp_t", "tmp_v", "racc_reduce", "k1", "curstate", "t", "ParseError", "sprintf", "token_to_str", "yyerror", "yyaccept", "yyerrok", "print", "racc_token2str", "puts", "racc_print_stacks", "toks", "sim", "out", "empty?", "each", "block in racc_reduce", "block (2 levels) in racc_reduce", "racc_print_states", "v", "each_index", "block in racc_print_stacks", "block (2 levels) in racc_print_stacks", "s", "block in racc_print_states", "st", "block (2 levels) in racc_print_states", "class::Racc_token_to_s_table"], :mappings=>"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"}}, {:offset=>{:line=>1929, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/arithmetic/node.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module Arithmetic\n    module Node\n      class BinaryOp\n        def initialize(lhs, op, rhs)\n          @lhs = lhs\n          @op = op\n          @rhs = rhs\n        end\n\n        def eval(round_type)\n          l = @lhs.eval(round_type)\n          r = @rhs.eval(round_type)\n          l.send(@op, r)\n        end\n\n        # @return [String] メッセージへの出力\n        def output\n          \"\#{@lhs.output}\#{@op}\#{@rhs.output}\"\n        end\n\n        # @return [String] ノードのS式\n        def s_exp\n          \"(\#{op_for_s_exp} \#{@lhs.s_exp} \#{@rhs.s_exp})\"\n        end\n\n        # @return [String] S式で使う演算子の表現\n        def op_for_s_exp\n          @op\n        end\n      end\n\n      # 除算ノードの基底クラス\n      #\n      # 定数 +ROUNDING_METHOD+ で端数処理方法を示す記号\n      # ( +'U'+, +'R'+, +''+ ) を定義すること。\n      # また、除算および端数処理を行う +divide_and_round+ メソッドを実装すること。\n      class DivideBase < BinaryOp\n        # ノードを初期化する\n        # @param [Object] lhs 左のオペランドのノード\n        # @param [Object] rhs 右のオペランドのノード\n        def initialize(lhs, rhs)\n          super(lhs, :/, rhs)\n        end\n\n        def eval(round_type)\n          l = @lhs.eval(round_type)\n          r = @rhs.eval(round_type)\n\n          raise ZeroDivisionError if r == 0\n          divide_and_round(l, r, round_type)\n        end\n\n        # メッセージへの出力を返す\n        #\n        # 通常の結果の末尾に、端数処理方法を示す記号を付加する。\n        #\n        # @return [String]\n        def output\n          \"\#{super}\#{rounding_method}\"\n        end\n\n        private\n\n        # 端数処理方法を示す記号を返す\n        # @return [String]\n        def rounding_method\n          self.class::ROUNDING_METHOD\n        end\n\n        # S式で使う演算子の表現を返す\n        # @return [String]\n        def op_for_s_exp\n          \"\#{@op}\#{rounding_method}\"\n        end\n\n        # 除算および端数処理を行う\n        # @param [Integer] _dividend 被除数\n        # @param [Integer] _divisor 除数（0以外）\n        # @param [Symbol] _round_type ゲームシステムの端数処理設定\n        # @return [Integer]\n        def divide_and_round(_dividend, _divisor, _round_type)\n          raise NotImplementedError\n        end\n      end\n\n      # 除算（端数処理はゲームシステム依存）のノード\n      class DivideWithGameSystemDefault < DivideBase\n        # 端数処理方法を示す記号\n        ROUNDING_METHOD = \"\"\n\n        private\n\n        # 除算および端数処理を行う\n        # @param [Integer] dividend 被除数\n        # @param [Integer] divisor 除数（0以外）\n        # @param [Symbol] round_type ゲームシステムの端数処理設定\n        # @return [Integer]\n        def divide_and_round(dividend, divisor, round_type)\n          case round_type\n          when RoundType::CEIL\n            (dividend.to_f / divisor).ceil\n          when RoundType::ROUND\n            x = dividend.to_f / divisor\n            x.negative? ? -(x.abs.round) : x.round\n          else # RoundType::FLOOR\n            (dividend / divisor).floor\n          end\n        end\n      end\n\n      # 除算（切り上げ）のノード\n      class DivideWithCeil < DivideBase\n        # 端数処理方法を示す記号\n        ROUNDING_METHOD = \"C\"\n\n        private\n\n        # 除算および端数処理を行う\n        # @param [Integer] dividend 被除数\n        # @param [Integer] divisor 除数（0以外）\n        # @param [Symbol] _round_type ゲームシステムの端数処理設定\n        # @return [Integer]\n        def divide_and_round(dividend, divisor, _round_type)\n          (dividend.to_f / divisor).ceil\n        end\n      end\n\n      # 除算（四捨五入）のノード\n      class DivideWithRound < DivideBase\n        # 端数処理方法を示す記号\n        ROUNDING_METHOD = \"R\"\n\n        private\n\n        # 除算および端数処理を行う\n        # @param [Integer] dividend 被除数\n        # @param [Integer] divisor 除数（0以外）\n        # @param [Symbol] _round_type ゲームシステムの端数処理設定\n        # @return [Integer]\n        def divide_and_round(dividend, divisor, _round_type)\n          x = dividend.to_f / divisor\n          x.negative? ? -(x.abs.round) : x.round\n        end\n      end\n\n      # 除算（切り捨て）のノード\n      class DivideWithFloor < DivideBase\n        # 端数処理方法を示す記号\n        ROUNDING_METHOD = \"F\"\n\n        private\n\n        # 除算および端数処理を行う\n        # @param [Integer] dividend 被除数\n        # @param [Integer] divisor 除数（0以外）\n        # @param [Symbol] _round_type ゲームシステムの端数処理設定\n        # @return [Integer]\n        def divide_and_round(dividend, divisor, _round_type)\n          (dividend / divisor).floor\n        end\n      end\n\n      class Negative\n        def initialize(body)\n          @body = body\n        end\n\n        def eval(round_type)\n          -@body.eval(round_type)\n        end\n\n        # @return [String] メッセージへの出力\n        def output\n          \"-\#{@body.output}\"\n        end\n\n        def s_exp\n          \"(- \#{@body.s_exp})\"\n        end\n      end\n\n      # カッコで式をまとめるノード\n      class Parenthesis\n        # @param expr [Object] カッコ内のノード\n        def initialize(expr)\n          @expr = expr\n        end\n\n        # @param round_type [Symbol] 端数処理方法\n        # @return [Integer] 評価結果\n        def eval(round_type)\n          @expr.eval(round_type)\n        end\n\n        # @return [String] メッセージへの出力\n        def output\n          \"(\#{@expr.output})\"\n        end\n\n        # @return [String] S式\n        def s_exp\n          \"(Parenthesis \#{@expr.s_exp})\"\n        end\n      end\n\n      class Number\n        def initialize(value)\n          @value = value\n        end\n\n        def eval(_round_type)\n          @value\n        end\n\n        # @return [String] メッセージへの出力\n        def output\n          @value.to_s\n        end\n\n        alias s_exp output\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:Arithmetic>", "<module:Node>", "<class:BinaryOp>", "initialize", "lhs", "op", "rhs", "@lhs", "@op", "@rhs", "eval", "round_type", "l", "r", "send", "output", "s_exp", "self", "op_for_s_exp", "<class:DivideBase>", "0", "raise", "ZeroDivisionError", "divide_and_round", "rounding_method", "private", "class::ROUNDING_METHOD", "class", "_dividend", "_divisor", "_round_type", "NotImplementedError", "BinaryOp", "<class:DivideWithGameSystemDefault>", "dividend", "divisor", "RoundType::CEIL", "RoundType", "$ret_or_1", "/", "to_f", "ceil", "RoundType::ROUND", "x", "negative?", "abs", "round", "-@", "floor", "DivideBase", "<class:DivideWithCeil>", "<class:DivideWithRound>", "<class:DivideWithFloor>", "<class:Negative>", "@body", "<class:Parenthesis>", "@expr", "<class:Number>", "@value", "to_s"], :mappings=>"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"}}, {:offset=>{:line=>2201, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["./strscan.rb"], :sourcesContent=>["class StringScanner\n  attr_reader :pos, :matched\n\n  def initialize(string)\n    @string  = string\n    @pos     = 0\n    @matched = nil\n    @working = string\n    @match   = []\n  end\n\n  attr_reader :string\n\n  def beginning_of_line?\n    `\#{@pos} === 0 || \#{@string}.charAt(\#{@pos} - 1) === \"\\n\"`\n  end\n\n  def scan(pattern)\n    pattern = anchor(pattern)\n\n    %x{\n      var result = pattern.exec(\#{@working});\n\n      if (result == null) {\n        return \#{@matched} = nil;\n      }\n      \#{@prev_pos} = \#{@pos};\n      \#{@pos}     += result[0].length;\n      \#{@working}  = \#{@working}.substring(result[0].length);\n      \#{@matched}  = result[0];\n      \#{@match}    = result;\n\n      return result[0];\n    }\n  end\n\n  def scan_until(pattern)\n    pattern = anchor(pattern)\n\n    %x{\n      var working = \#{@working}\n\n      for(var i = 0; working.length != i; ++i) {\n        var result  = pattern.exec(working.substr(i));\n        if (result !== null) {\n          var matched_size = i + result[0].length\n          var matched = working.substr(0, matched_size)\n\n          \#{@matched}  = result[0]\n          \#{@match}  = result\n          \#{@prev_pos} = \#{@pos} + i; // Position of first character of matched\n          \#{@pos} += matched_size // Position one after last character of matched\n          \#{@working} = working.substr(matched_size)\n\n          return matched\n        }\n      }\n      return \#{@matched} = nil;\n    }\n  end\n\n  def [](idx)\n    if @match.empty?\n      return nil\n    end\n    case idx\n    when Symbol\n      idx = idx.to_s\n    when String\n      # noop\n    else\n      idx = ::Opal.coerce_to!(idx, Integer, :to_int)\n    end\n    %x{\n      var match = \#{@match};\n\n      if (idx < 0) {\n        idx += match.length;\n      }\n\n      if (idx < 0 || idx >= match.length) {\n        return nil;\n      }\n\n      if (match[idx] == null) {\n        return nil;\n      }\n\n      return match[idx];\n    }\n  end\n\n  def check(pattern)\n    pattern = anchor(pattern)\n\n    %x{\n      var result = pattern.exec(\#{@working});\n\n      if (result == null) {\n        return \#{@matched} = nil;\n      }\n\n      return \#{@matched} = result[0];\n    }\n  end\n\n  def check_until(pattern)\n    %x{\n      var old_prev_pos = \#{@prev_pos};\n      var old_pos      = \#{@pos};\n      var old_working  = \#{@working};\n\n      var result = \#{scan_until(pattern)};\n\n      \#{@prev_pos} = old_prev_pos;\n      \#{@pos}      = old_pos;\n      \#{@working}  = old_working;\n\n      return result;\n    }\n  end\n\n  def peek(length)\n    `\#{@working}.substring(0, length)`\n  end\n\n  def eos?\n    `\#{@working}.length === 0`\n  end\n\n  def exist?(pattern)\n    %x{\n      var result = pattern.exec(\#{@working});\n\n      if (result == null) {\n        return nil;\n      }\n      else if (result.index == 0) {\n        return 0;\n      }\n      else {\n        return result.index + 1;\n      }\n    }\n  end\n\n  def skip(pattern)\n    pattern = anchor(pattern)\n\n    %x{\n      var result = pattern.exec(\#{@working});\n\n      if (result == null) {\n        \#{@match} = [];\n        return \#{@matched} = nil;\n      }\n      else {\n        var match_str = result[0];\n        var match_len = match_str.length;\n\n        \#{@matched}   = match_str;\n        \#{@match}     = result;\n        \#{@prev_pos}  = \#{@pos};\n        \#{@pos}      += match_len;\n        \#{@working}   = \#{@working}.substring(match_len);\n\n        return match_len;\n      }\n    }\n  end\n\n  def skip_until(pattern)\n    %x{\n      var result = \#{scan_until(pattern)};\n\n      if (result === nil) {\n        return nil;\n      }\n      else {\n        \#{@matched} = result.substr(-1);\n\n        return result.length;\n      }\n    }\n  end\n\n  def get_byte\n    %x{\n      var result = nil;\n\n      if (\#{@pos} < \#{@string}.length) {\n        \#{@prev_pos}  = \#{@pos};\n        \#{@pos}      += 1;\n        result      = \#{@matched} = \#{@working}.substring(0, 1);\n        \#{@working}   = \#{@working}.substring(1);\n      }\n      else {\n        \#{@matched} = nil;\n      }\n\n      return result;\n    }\n  end\n\n  def match?(pattern)\n    pattern = anchor(pattern)\n\n    %x{\n      var result = pattern.exec(\#{@working});\n\n      if (result == null) {\n        return nil;\n      }\n      else {\n        \#{@prev_pos} = \#{@pos};\n\n        return result[0].length;\n      }\n    }\n  end\n\n  def pos=(pos)\n    %x{\n      if (pos < 0) {\n        pos += \#{@string.length};\n      }\n    }\n\n    @pos     = pos\n    @working = `\#{@string}.slice(pos)`\n  end\n\n  def matched_size\n    %x{\n      if (\#{@matched} === nil) {\n        return nil;\n      }\n\n      return \#{@matched}.length\n    }\n  end\n\n  def post_match\n    %x{\n      if (\#{@matched} === nil) {\n        return nil;\n      }\n\n      return \#{@string}.substr(\#{@pos});\n    }\n  end\n\n  def pre_match\n    %x{\n      if (\#{@matched} === nil) {\n        return nil;\n      }\n\n      return \#{@string}.substr(0, \#{@prev_pos});\n    }\n  end\n\n  def reset\n    @working = @string\n    @matched = nil\n    @pos     = 0\n  end\n\n  def rest\n    @working\n  end\n\n  def rest?\n    `\#{@working}.length !== 0`\n  end\n\n  def rest_size\n    rest.size\n  end\n\n  def terminate\n    @match = nil\n    self.pos = @string.length\n  end\n\n  def unscan\n    @pos      = @prev_pos\n    @prev_pos = nil\n    @match    = nil\n\n    self\n  end\n\n  alias bol? beginning_of_line?\n  alias getch get_byte # not exactly the same, but for now...\n\n  private\n\n  def anchor(pattern)\n    %x{\n      var flags = pattern.toString().match(/\\/([^\\/]+)$/);\n      flags = flags ? flags[1] : undefined;\n      return new RegExp('^(?:' + pattern.source + ')', flags);\n    }\n  end\nend\n"], :names=>["<top (required)>", "<class:StringScanner>", "self", "attr_reader", "initialize", "string", "@string", "@pos", "0", "@matched", "@working", "@match", "beginning_of_line?", "scan", "pattern", "anchor", "@prev_pos", "scan_until", "[]", "idx", "empty?", "Symbol", "$ret_or_1", "to_s", "String", "Opal", "coerce_to!", "Integer", "check", "check_until", "peek", "length", "eos?", "exist?", "skip", "skip_until", "get_byte", "match?", "pos=", "pos", "matched_size", "post_match", "pre_match", "reset", "rest", "rest?", "rest_size", "size", "terminate", "unscan", "private"], :mappings=>"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"}}, {:offset=>{:line=>2560, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/normalize.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module Normalize\n    module_function\n\n    # 比較演算子をシンボルに正規化する\n    #\n    # @param op [String]\n    # @return [Symbol, nil]\n    def comparison_operator(op)\n      case op\n      when /<=|=</\n        :<=\n      when />=|=>/\n        :>=\n      when /<>|!=|=!/\n        :'!='\n      when /</\n        :<\n      when />/\n        :>\n      when /=/\n        :==\n      end\n    end\n\n    # 目標値を正規化する\n    #\n    # @param val [String]\n    # @return [Integer, String] 整数か'?'\n    def target_number(val)\n      if val == \"?\"\n        val\n      else\n        val.to_i\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:Normalize>", "self", "module_function", "comparison_operator", "op", "$ret_or_1", "target_number", "val", "to_i"], :mappings=>"AAAAA,mCAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;;;MACEC,IAAAC,iBAAAA,CAAAA;;AAMAC,MAAAA,mCAAAA,+BAAwBC,EAAxBD;AAAAA,QAAAA;;QAEE,IAAA,QAAK,OAAL,EADAE,CAAAA,YAAKD,EAALC,CACA,CAAA;UACEF,OAAA;QADF,OAEA,IAAA,QAAK,OAAL,EAdN,SAcM,CAAA;UACEA,OAAA;QADF,OAEA,IAAA,QAAK,UAAL,EAhBN,SAgBM,CAAA;UACEA,OAAA;QADF,OAEA,IAAA,QAAK,GAAL,EAlBN,SAkBM,CAAA;UACEA,OAAA;QADF,OAEA,IAAA,QAAK,GAAL,EApBN,SAoBM,CAAA;UACEA,OAAA;QADF,OAEA,IAAA,QAAK,GAAL,EAtBN,SAsBM,CAAA;UACEA,OAAA;QADF;UAXAA,OAAA;QAWA;MAZFA,CAAAA;MAqBAH,OAAAM,6BAAAA,yBAAkBC,GAAlBD;AAAAA;QACE,IAAA,MAAGC,GAAH,EAAUD,GAAV,CAAA;UACEA,OAAAC;QADF;UAGED,OAAAC,GAAGC,MAAAA,CAAAA;QAHL;MADFF,CAAAA;IA5BFN,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>2606, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/command/lexer.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"strscan\"\nrequire \"bcdice/normalize\"\n\nmodule BCDice\n  module Command\n    class Lexer\n      SYMBOLS = {\n        \"+\" => :PLUS,\n        \"-\" => :MINUS,\n        \"*\" => :ASTERISK,\n        \"/\" => :SLASH,\n        \"(\" => :PARENL,\n        \")\" => :PARENR,\n        \"?\" => :QUESTION,\n        \"@\" => :AT,\n        \"#\" => :SHARP,\n        \"$\" => :DOLLAR,\n      }.freeze\n\n      def initialize(source, notations)\n        # sourceが空文字だとString#splitが空になる\n        source = source&.split(\" \", 2)&.first || \"\"\n        @scanner = StringScanner.new(source)\n        @notations = notations.map do |n|\n          n.is_a?(String) ? Regexp.new(n) : n\n        end\n      end\n\n      def next_token\n        return [false, \"$\"] if @scanner.eos?\n\n        @notations.each do |n|\n          token = @scanner.scan(n)\n          return [:NOTATION, token] if token\n        end\n\n        if (number = @scanner.scan(/\\d+/))\n          [:NUMBER, number.to_i]\n        elsif (cmp_op = @scanner.scan(/[<>!=]+/))\n          cmp_op = Normalize.comparison_operator(cmp_op)\n          type = cmp_op ? :CMP_OP : :ILLEGAL\n          [type, cmp_op]\n        else\n          char = @scanner.getch.upcase\n          type = SYMBOLS[char] || char.to_sym\n          [type, char]\n        end\n      end\n\n      def source\n        @scanner.string\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:Command>", "<class:Lexer>", "freeze", "initialize", "source", "notations", "$ret_or_1", "2", "@scanner", "StringScanner", "new", "@notations", "map", "block in initialize", "n", "is_a?", "String", "block (2 levels) in initialize", "Regexp", "next_token", "eos?", "each", "block in next_token", "block (2 levels) in next_token", "token", "scan", "number", "to_i", "cmp_op", "Normalize", "comparison_operator", "type", "char$", "getch", "upcase", "SYMBOLS", "[]", "to_sym", "string"], :mappings=>"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"}}, {:offset=>{:line=>2692, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/command/parsed.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module Command\n    class Parsed\n      # @return [String]\n      attr_accessor :command\n\n      # @return [Integer, nil]\n      attr_accessor :prefix_number\n\n      # @return [Integer, nil]\n      attr_accessor :suffix_number\n\n      # @return [Integer, nil]\n      attr_accessor :critical\n\n      # @return [Integer, nil]\n      attr_accessor :fumble\n\n      # @return [Integer, nil]\n      attr_accessor :dollar\n\n      # @return [Integer]\n      attr_accessor :modify_number\n\n      # @return [Symbol, nil]\n      attr_accessor :cmp_op\n\n      # @return [Integer, nil]\n      attr_accessor :target_number\n\n      # @param value [Boolean]\n      # @return [Boolean]\n      attr_writer :question_target\n\n      def initialize\n        @prefix_number = nil\n        @suffix_number = nil\n        @critical = nil\n        @fumble = nil\n        @dollar = nil\n        @cmp_op = nil\n        @target_number = nil\n        @question_target = false\n      end\n\n      # @return [Boolean]\n      def question_target?\n        @question_target\n      end\n\n      # @param suffix_position [Symbol] クリティカルなどの表示位置\n      # @return [String]\n      def to_s(suffix_position = :after_command)\n        c = @critical ? \"@\#{@critical}\" : nil\n        f = @fumble ? \"#\#{@fumble}\" : nil\n        d = @dollar ? \"$\#{@dollar}\" : nil\n        m = Format.modifier(@modify_number)\n        target = @question_target ? \"?\" : @target_number\n\n        case suffix_position\n        when :after_command\n          [@prefix_number, @command, @suffix_number, c, f, d, m, @cmp_op, target].join()\n        when :after_modify_number\n          [@prefix_number, @command, @suffix_number, m, c, f, d, @cmp_op, target].join()\n        when :after_target_number\n          [@prefix_number, @command, @suffix_number, m, @cmp_op, target, c, f, d].join()\n        end\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:Command>", "<class:Parsed>", "self", "attr_accessor", "attr_writer", "initialize", "@prefix_number", "@suffix_number", "@critical", "@fumble", "@dollar", "@cmp_op", "@target_number", "@question_target", "question_target?", "to_s", "suffix_position", "c", "f", "d", "m", "Format", "modifier", "@modify_number", "target", "@command", "join"], :mappings=>"AAAAA,wCAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;AAAAA;;QAEEC,IAAAC,eAAAA,CAAc,SAAdA;QAGAD,IAAAC,eAAAA,CAAc,eAAdA;QAGAD,IAAAC,eAAAA,CAAc,eAAdA;QAGAD,IAAAC,eAAAA,CAAc,UAAdA;QAGAD,IAAAC,eAAAA,CAAc,QAAdA;QAGAD,IAAAC,eAAAA,CAAc,QAAdA;QAGAD,IAAAC,eAAAA,CAAc,eAAdA;QAGAD,IAAAC,eAAAA,CAAc,QAAdA;QAGAD,IAAAC,eAAAA,CAAc,eAAdA;QAIAD,IAAAE,aAAAA,CAAY,iBAAZA;;AAEAC,QAAAA,0BAAAA,sBAAAA;AAAAA,UAAAA;;;UACEC,qBAAiB;UACjBC,qBAAiB;UACjBC,gBAAY;UACZC,cAAU;UACVC,cAAU;UACVC,cAAU;UACVC,qBAAiB;UACjBP,OAAAQ,CAAAA,uBAAmB,KAAnBA;QARFR,CAAAA;;AAYAS,QAAAA,gCAAAA,aACE,iBADFA,CAAAA;QAMAb,OAAAc,oBAAAA,gBAASC,eAATD;AAAAA,UAAAA;;;UAAS,+CAAkB;UACzBE,IAAI,CAAA,QAAAT,aAAA,CAAA,GAAA,CAAaO,GAAD,GAAA,CAAIP,aAAJ,CAAZ,IAAA,CAA8B,GAA9B,CAAA;UACJU,IAAI,CAAA,QAAAT,WAAA,CAAA,GAAA,CAAWM,GAAD,GAAA,CAAIN,WAAJ,CAAV,IAAA,CAA0B,GAA1B,CAAA;UACJU,IAAI,CAAA,QAAAT,WAAA,CAAA,GAAA,CAAWK,GAAD,GAAA,CAAIL,WAAJ,CAAV,IAAA,CAA0B,GAA1B,CAAA;UACJU,IAAIC,YAAMC,UAAAA,CAAUC,kBAAVD;UACVE,SAAS,CAAA,QAAAX,oBAAA,CAAA,GAAA,CAAmBE,GAAnB,IAAA,CAAyBH,kBAAzB,CAAA;;UAGT,QADKI,eACL;YAAA,KAAK,eAAL;cACED,OAAA,CAACT,kBAAD,EAAiBmB,YAAjB,EAA2BlB,kBAA3B,EAA2CU,CAA3C,EAA8CC,CAA9C,EAAiDC,CAAjD,EAAoDC,CAApD,EAAuDT,WAAvD,EAAgEa,MAAhE,CAAuEE,MAAAA,CAAAA;YACzE,KAAK,qBAAL;cACEX,OAAA,CAACT,kBAAD,EAAiBmB,YAAjB,EAA2BlB,kBAA3B,EAA2Ca,CAA3C,EAA8CH,CAA9C,EAAiDC,CAAjD,EAAoDC,CAApD,EAAuDR,WAAvD,EAAgEa,MAAhE,CAAuEE,MAAAA,CAAAA;YACzE,KAAK,qBAAL;cACEX,OAAA,CAACT,kBAAD,EAAiBmB,YAAjB,EAA2BlB,kBAA3B,EAA2Ca,CAA3C,EAA8CT,WAA9C,EAAuDa,MAAvD,EAA+DP,CAA/D,EAAkEC,CAAlE,EAAqEC,CAArE,CAAuEO,MAAAA,CAAAA;YADzE;cALAX,OAAA;UACA;QARFA,CAAAA,IAAAA;MAlDFd,GAAAA,WAAAA,EAAAA,IAAAA;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>2765, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/command/parser.rb"], :sourcesContent=>["#\n# DO NOT MODIFY!!!!\n# This file is automatically generated by Racc 1.7.3\n# from Racc grammar file \"parser.y\".\n#\n\nrequire 'racc/parser.rb'\n\n\nrequire \"bcdice/arithmetic/node\"\nrequire \"bcdice/command/lexer\"\nrequire \"bcdice/command/parsed\"\n\n# よくある形式のコマンドのパースを補助するクラス\n#\n# @example Literal by String\n#   parser = Command::Parser.new(\"MC\", round_type: BCDice::RoundType::FLOOR)\n#                           .enable_critical\n#   parsed = parser.parse(\"MC+2*3@30<=10/2-3\") #=> <Command::Parsed>\n#\n#   parsed.command #=> \"MC\"\n#   parsed.modify_number #=> 6\n#   parsed.critical #=> 30\n#   parsed.cmp_op #=> #>=\n#   parsed.target_number #=> 2\n#\n# @example Literal by Regexp\n#   parser = Command::Parser.new(/RE\\d+/)\n#   parsed = parser.parse(\"RE44+20\") #=> <Command::Parsed>\n#\n#   parsed.command #=> \"RE44\"\n#   parsed.modify_number #=> 20\nclass BCDice::Command::Parser < Racc::Parser; end\n\nmodule BCDice\n  module Command\n    class Parser < Racc::Parser\n\n\n# @param notations [Array<String, Regexp>] 反応するコマンドの表記\n# @param round_type [Symbol] 除算での端数の扱い\ndef initialize(*notations, round_type:)\n  super()\n  @notations = notations\n  @round_type = round_type\n  @prefix_number = false\n  @suffix_number = false\n  @need_prefix_number = false\n  @need_suffix_number = false\n  @modifier = true\n  @critical = false\n  @fumble = false\n  @dollar = false\n  @allowed_cmp_op = [nil, :>=, :>, :<=, :<, :==, :!=]\n  @question_target = false\nend\n\n# 修正値は受け付けないようにする\n# @return [BCDice::Command::Parser]\ndef disable_modifier\n  @modifier = false\n  self\nend\n\n# リテラルの前に数値を許可する\n# @return [BCDice::Command::Parser]\ndef enable_prefix_number\n  @prefix_number = true\n  self\nend\n\n# リテラルの後ろに数値を許可する\n# @return [BCDice::Command::Parser]\ndef enable_suffix_number\n  @suffix_number = true\n  self\nend\n\n# リテラルの前に数値が必要であると設定する\n# @return [BCDice::Command::Parser]\ndef has_prefix_number\n  @prefix_number = true\n  @need_prefix_number = true\n  self\nend\n\n# リテラルの後ろに数値が必要であると設定する\n# @return [BCDice::Command::Parser]\ndef has_suffix_number\n  @suffix_number = true\n  @need_suffix_number = true\n  self\nend\n\n# +@+によるクリティカル値の指定を許可する\n# @return [BCDice::Command::Parser]\ndef enable_critical\n  @critical = true\n  self\nend\n\n# +#+によるファンブル値の指定を許可する\n# @return [BCDice::Command::Parser]\ndef enable_fumble\n  @fumble = true\n  self\nend\n\n# +$+による値の指定を許可する\n# @return [BCDice::Command::Parser]\ndef enable_dollar\n  @dollar = true\n  self\nend\n\n# 使用できる比較演算子を制限する。\n# 目標値未入力を許可する場合には+nil+を指定する。\n# @param ops [Array<nil, Symbol>] 許可する比較演算子の一覧\n# @return [BCDice::Command::Parser]\ndef restrict_cmp_op_to(*ops)\n  @allowed_cmp_op = ops\n  self\nend\n\n# 目標値\"?\"の指定を許可する\n# @return [BCDice::Command::Parser]\ndef enable_question_target\n  @question_target = true\n  self\nend\n\n# @param source [String]\n# @return [BCDice::Command::Parsed, nil]\ndef parse(source)\n  @lexer = Lexer.new(source, @notations)\n  do_parse()\nrescue ParseError, ZeroDivisionError\n  nil\nend\n\nprivate\n\ndef parsed(notation, option, modifier, target)\n  Parsed.new.tap do |p|\n    p.command = notation[:command]\n    p.prefix_number = notation[:prefix]&.eval(@round_type)\n    p.suffix_number = notation[:suffix]&.eval(@round_type)\n    p.critical = option[:critical]&.eval(@round_type)\n    p.fumble = option[:fumble]&.eval(@round_type)\n    p.dollar = option[:dollar]&.eval(@round_type)\n    p.modify_number = modifier.eval(@round_type)\n    p.cmp_op = target[:cmp_op]\n    if target[:target] == \"?\"\n      p.question_target = true\n      p.target_number = 0\n    else\n      p.question_target = false\n      p.target_number = target[:target]&.eval(@round_type)\n    end\n  end\nend\n\ndef next_token\n  @lexer.next_token\nend\n##### State transition tables begin ###\n\nracc_action_table = [\n     6,     6,     6,     6,     7,    28,    29,    17,    18,     5,\n     5,     5,     5,     6,    26,    12,     4,    45,    17,    18,\n    10,    11,     5,    10,    11,     6,    23,    24,    25,    26,\n    17,    18,     6,    20,     5,    33,    34,    17,    18,     6,\n    35,     5,    28,    29,    17,    18,     6,   nil,     5,    36,\n    37,    17,    18,     6,   nil,     5,    36,    37,    17,    18,\n     6,   nil,     5,    36,    37,    17,    18,     6,   nil,     5,\n    33,    34,    17,    18,     6,   nil,     5,    36,    37,    17,\n    18,     6,   nil,     5,    36,    37,    17,    18,     6,   nil,\n     5,    36,    37,    17,    18,     6,   nil,     5,    36,    37,\n    17,    18,     6,   nil,     5,   nil,   nil,    17,    18,     6,\n   nil,     5,   nil,   nil,    17,    18,   nil,   nil,     5,    23,\n    24,    25,    26,    56,    54,    55,    57 ]\n\nracc_action_check = [\n     0,     4,    26,    12,     1,    21,    21,    26,    26,     0,\n     4,    26,    12,     5,    21,     3,     0,    26,     5,     5,\n     8,     8,     5,     2,     2,    10,     8,     8,     8,     8,\n    10,    10,    11,     7,    10,    14,    14,    11,    11,    17,\n    14,    11,     9,     9,    17,    17,    18,   nil,    17,    15,\n    15,    18,    18,    23,   nil,    18,    30,    30,    23,    23,\n    24,   nil,    23,    31,    31,    24,    24,    25,   nil,    24,\n    44,    44,    25,    25,    28,   nil,    25,    47,    47,    28,\n    28,    29,   nil,    28,    48,    48,    29,    29,    33,   nil,\n    29,    49,    49,    33,    33,    34,   nil,    33,    50,    50,\n    34,    34,    36,   nil,    34,   nil,   nil,    36,    36,    37,\n   nil,    36,   nil,   nil,    37,    37,   nil,   nil,    37,    27,\n    27,    27,    27,    52,    52,    52,    52 ]\n\nracc_action_pointer = [\n    -2,     4,    16,    -3,    -1,    11,   nil,    33,    13,    35,\n    23,    30,     1,   nil,    28,    40,   nil,    37,    44,   nil,\n   nil,    -2,   nil,    51,    58,    65,     0,   106,    72,    79,\n    47,    54,   nil,    86,    93,   nil,   100,   107,   nil,   nil,\n   nil,   nil,   nil,   nil,    63,   nil,   nil,    68,    75,    82,\n    89,   nil,   120,   nil,   nil,   nil,   nil,   nil ]\n\nracc_action_default = [\n   -35,   -35,    -8,   -35,    -7,   -35,   -34,   -35,   -16,    -8,\n   -35,   -35,    -5,    -6,   -35,   -21,   -24,   -35,   -35,   -32,\n    58,   -16,    -3,   -35,   -35,   -35,   -35,   -16,   -35,   -35,\n   -12,   -13,    -4,   -35,   -35,   -33,   -35,   -35,   -30,   -31,\n    -1,    -9,   -10,   -11,   -17,   -18,    -2,   -14,   -15,   -19,\n   -20,   -22,   -25,   -23,   -26,   -27,   -28,   -29 ]\n\nracc_goto_table = [\n    30,    31,    38,    39,    14,     8,     1,    22,    41,    42,\n    43,     9,    27,     2,    53,   nil,   nil,    21,    47,    48,\n    40,    51,    52,    49,    50,    44,    46,     3,   nil,   nil,\n   nil,    13,   nil,   nil,   nil,   nil,   nil,   nil,   nil,    32 ]\n\nracc_goto_check = [\n     8,     8,     7,     7,     9,     3,     1,     5,     7,     7,\n     7,     4,     3,     2,    10,   nil,   nil,     4,     8,     8,\n     5,     7,     7,     8,     8,     9,     5,     6,   nil,   nil,\n   nil,     6,   nil,   nil,   nil,   nil,   nil,   nil,   nil,     6 ]\n\nracc_goto_pointer = [\n   nil,     6,    13,     3,     9,    -1,    27,   -15,   -10,    -1,\n   -38 ]\n\nracc_goto_default = [\n   nil,   nil,   nil,   nil,   nil,   nil,    19,    16,    15,   nil,\n   nil ]\n\nracc_reduce_table = [\n  0, 0, :racc_error,\n  4, 20, :_reduce_1,\n  4, 20, :_reduce_2,\n  3, 20, :_reduce_3,\n  3, 21, :_reduce_4,\n  2, 21, :_reduce_5,\n  2, 21, :_reduce_6,\n  1, 21, :_reduce_7,\n  0, 22, :_reduce_8,\n  3, 22, :_reduce_9,\n  3, 22, :_reduce_10,\n  3, 22, :_reduce_11,\n  2, 23, :_reduce_12,\n  2, 23, :_reduce_13,\n  3, 23, :_reduce_14,\n  3, 23, :_reduce_15,\n  0, 24, :_reduce_16,\n  2, 24, :_reduce_17,\n  2, 24, :_reduce_18,\n  3, 28, :_reduce_19,\n  3, 28, :_reduce_20,\n  1, 28, :_reduce_none,\n  3, 27, :_reduce_22,\n  4, 27, :_reduce_23,\n  1, 27, :_reduce_none,\n  0, 29, :_reduce_25,\n  1, 29, :_reduce_26,\n  1, 29, :_reduce_27,\n  1, 29, :_reduce_28,\n  1, 29, :_reduce_29,\n  2, 26, :_reduce_30,\n  2, 26, :_reduce_31,\n  1, 26, :_reduce_none,\n  3, 25, :_reduce_33,\n  1, 25, :_reduce_34 ]\n\nracc_reduce_n = 35\n\nracc_shift_n = 58\n\nracc_token_table = {\n  false => 0,\n  :error => 1,\n  :NUMBER => 2,\n  :R => 3,\n  :U => 4,\n  :C => 5,\n  :F => 6,\n  :PLUS => 7,\n  :MINUS => 8,\n  :ASTERISK => 9,\n  :SLASH => 10,\n  :PARENL => 11,\n  :PARENR => 12,\n  :AT => 13,\n  :SHARP => 14,\n  :DOLLAR => 15,\n  :CMP_OP => 16,\n  :QUESTION => 17,\n  :NOTATION => 18 }\n\nracc_nt_base = 19\n\nracc_use_result_var = true\n\nRacc_arg = [\n  racc_action_table,\n  racc_action_check,\n  racc_action_default,\n  racc_action_pointer,\n  racc_goto_table,\n  racc_goto_check,\n  racc_goto_default,\n  racc_goto_pointer,\n  racc_nt_base,\n  racc_reduce_table,\n  racc_token_table,\n  racc_shift_n,\n  racc_reduce_n,\n  racc_use_result_var ]\nRactor.make_shareable(Racc_arg) if defined?(Ractor)\n\nRacc_token_to_s_table = [\n  \"$end\",\n  \"error\",\n  \"NUMBER\",\n  \"R\",\n  \"U\",\n  \"C\",\n  \"F\",\n  \"PLUS\",\n  \"MINUS\",\n  \"ASTERISK\",\n  \"SLASH\",\n  \"PARENL\",\n  \"PARENR\",\n  \"AT\",\n  \"SHARP\",\n  \"DOLLAR\",\n  \"CMP_OP\",\n  \"QUESTION\",\n  \"NOTATION\",\n  \"$start\",\n  \"expr\",\n  \"notation\",\n  \"option\",\n  \"modifier\",\n  \"target\",\n  \"term\",\n  \"unary\",\n  \"mul\",\n  \"add\",\n  \"round_type\" ]\nRactor.make_shareable(Racc_token_to_s_table) if defined?(Ractor)\n\nRacc_debug_parser = false\n\n##### State transition tables end #####\n\n# reduce 0 omitted\n\ndef _reduce_1(val, _values, result)\n          raise ParseError unless @modifier\n          notation, option, modifier, target = val\n          result = parsed(notation, option, modifier, target)\n\n    result\nend\n\ndef _reduce_2(val, _values, result)\n          raise ParseError unless @modifier\n          notation, modifier, option, target = val\n          result = parsed(notation, option, modifier, target)\n\n    result\nend\n\ndef _reduce_3(val, _values, result)\n          notation, option, target = val\n          result = parsed(notation, option,  Arithmetic::Node::Number.new(0), target)\n\n    result\nend\n\ndef _reduce_4(val, _values, result)\n              raise ParseError unless @prefix_number && @suffix_number\n              result = { command: val[1], prefix: val[0], suffix: val[2] }\n\n    result\nend\n\ndef _reduce_5(val, _values, result)\n              raise ParseError unless @prefix_number\n              raise ParseError if @need_suffix_number\n              result = { command: val[1], prefix: val[0] }\n\n    result\nend\n\ndef _reduce_6(val, _values, result)\n              raise ParseError unless @suffix_number\n              raise ParseError if @need_prefix_number\n              result = { command: val[0], suffix: val[1] }\n\n    result\nend\n\ndef _reduce_7(val, _values, result)\n              raise ParseError if @need_prefix_number || @need_suffix_number\n              result = { command: val[0] }\n\n    result\nend\n\ndef _reduce_8(val, _values, result)\n            result = {}\n\n    result\nend\n\ndef _reduce_9(val, _values, result)\n            option, _, term = val\n            raise ParseError unless @critical && option[:critical].nil?\n\n            option[:critical] = term\n            result = option\n\n    result\nend\n\ndef _reduce_10(val, _values, result)\n            option, _, term = val\n            raise ParseError unless @fumble && option[:fumble].nil?\n\n            option[:fumble] = term\n            result = option\n\n    result\nend\n\ndef _reduce_11(val, _values, result)\n            option, _, term = val\n            raise ParseError unless @dollar && option[:dollar].nil?\n\n            option[:dollar] = term\n            result = option\n\n    result\nend\n\ndef _reduce_12(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_13(val, _values, result)\n result = Arithmetic::Node::Negative.new(val[1])\n    result\nend\n\ndef _reduce_14(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :+, val[2])\n    result\nend\n\ndef _reduce_15(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :-, val[2])\n    result\nend\n\ndef _reduce_16(val, _values, result)\n            raise ParseError unless @allowed_cmp_op.include?(nil)\n            result = {}\n\n    result\nend\n\ndef _reduce_17(val, _values, result)\n            cmp_op, target = val\n            raise ParseError unless @allowed_cmp_op.include?(cmp_op)\n\n            result = {cmp_op: cmp_op, target: target}\n\n    result\nend\n\ndef _reduce_18(val, _values, result)\n            cmp_op = val[0]\n            raise ParseError unless @question_target\n            raise ParseError unless @allowed_cmp_op.include?(cmp_op)\n\n            result = {cmp_op: cmp_op, target: \"?\"}\n\n    result\nend\n\ndef _reduce_19(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :+, val[2])\n    result\nend\n\ndef _reduce_20(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :-, val[2])\n    result\nend\n\n# reduce 21 omitted\n\ndef _reduce_22(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :*, val[2])\n    result\nend\n\ndef _reduce_23(val, _values, result)\n         divied_class = val[3]\n         result = divied_class.new(val[0], val[2])\n\n    result\nend\n\n# reduce 24 omitted\n\ndef _reduce_25(val, _values, result)\n result = Arithmetic::Node::DivideWithGameSystemDefault\n    result\nend\n\ndef _reduce_26(val, _values, result)\n result = Arithmetic::Node::DivideWithCeil\n    result\nend\n\ndef _reduce_27(val, _values, result)\n result = Arithmetic::Node::DivideWithCeil\n    result\nend\n\ndef _reduce_28(val, _values, result)\n result = Arithmetic::Node::DivideWithRound\n    result\nend\n\ndef _reduce_29(val, _values, result)\n result = Arithmetic::Node::DivideWithFloor\n    result\nend\n\ndef _reduce_30(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_31(val, _values, result)\n result = Arithmetic::Node::Negative.new(val[1])\n    result\nend\n\n# reduce 32 omitted\n\ndef _reduce_33(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_34(val, _values, result)\n result = Arithmetic::Node::Number.new(val[0])\n    result\nend\n\ndef _reduce_none(val, _values, result)\n  val[0]\nend\n\n    end   # class Parser\n  end   # module Command\nend   # module BCDice\n"], :names=>["<top (required)>", "self", "require", "<class:BCDice::Command::Parser>", "BCDice::Command", "BCDice", "Racc::Parser", "Racc", "<module:BCDice>", "<module:Command>", "<class:Parser>", "initialize", "@notations", "notations", "@round_type", "round_type", "@prefix_number", "@suffix_number", "@need_prefix_number", "@need_suffix_number", "@modifier", "@critical", "@fumble", "@dollar", "@allowed_cmp_op", "@question_target", "disable_modifier", "enable_prefix_number", "enable_suffix_number", "has_prefix_number", "has_suffix_number", "enable_critical", "enable_fumble", "enable_dollar", "restrict_cmp_op_to", "ops", "enable_question_target", "parse", "source", "@lexer", "Lexer", "new", "do_parse", "ParseError", "ZeroDivisionError", "private", "parsed", "notation", "option", "modifier", "target", "tap", "Parsed", "block in parsed", "p", "block (2 levels) in parsed", "command=", "[]", "prefix_number=", "suffix_number=", "critical=", "fumble=", "dollar=", "modify_number=", "eval", "cmp_op=", "question_target=", "target_number=", "0", "next_token", "racc_action_table", "racc_action_check", "racc_action_pointer", "racc_action_default", "racc_goto_table", "racc_goto_check", "racc_goto_pointer", "6", "13", "3", "9", "-1", "27", "-15", "-10", "-38", "racc_goto_default", "19", "16", "15", "racc_reduce_table", "racc_reduce_n", "35", "racc_shift_n", "58", "racc_token_table", "1", "2", "4", "5", "7", "8", "10", "11", "12", "14", "17", "18", "racc_nt_base", "racc_use_result_var", "Ractor", "make_shareable", "Racc_arg", "Racc_token_to_s_table", "_reduce_1", "val", "_values", "result", "raise", "_reduce_2", "_reduce_3", "Arithmetic::Node::Number", "Arithmetic::Node", "Arithmetic", "_reduce_4", "_reduce_5", "_reduce_6", "_reduce_7", "_reduce_8", "_reduce_9", "_", "term", "nil?", "[]=", "_reduce_10", "_reduce_11", "_reduce_12", "_reduce_13", "Arithmetic::Node::Negative", "_reduce_14", "Arithmetic::Node::BinaryOp", "_reduce_15", "_reduce_16", "include?", "_reduce_17", "cmp_op", "_reduce_18", "_reduce_19", "_reduce_20", "_reduce_22", "_reduce_23", "divied_class", "_reduce_25", "Arithmetic::Node::DivideWithGameSystemDefault", "_reduce_26", "Arithmetic::Node::DivideWithCeil", "_reduce_27", "_reduce_28", "Arithmetic::Node::DivideWithRound", "_reduce_29", "Arithmetic::Node::DivideWithFloor", "_reduce_30", "_reduce_31", "_reduce_33", "_reduce_34", "_reduce_none"], :mappings=>"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"}}, {:offset=>{:line=>3225, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/deprecated/checker.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module Deprecated\n    # 2D6などの特定の加算ダイスの結果をゲームシステムごとにカスタマイズするための\n    # @deprecated Base#result_2d6 等を利用してください\n    module Checker\n      private\n\n      # @param total [Integer] コマンド合計値\n      # @param rand_results [Array<CommonCommand::AddDice::Randomizer::RandResult>] ダイスの一覧\n      # @param cmp_op [Symbol] 比較演算子\n      # @param target [Integer, String] 目標値の整数か'?'\n      # @return [Result, nil]\n      def check_result_legacy(total, rand_results, cmp_op, target)\n        sides_list = rand_results.map(&:sides)\n        value_list = rand_results.map(&:value)\n        dice_total = value_list.sum()\n\n        ret =\n          case sides_list\n          when [100]\n            check_1D100(total, dice_total, cmp_op, target)\n          when [20]\n            check_1D20(total, dice_total, cmp_op, target)\n          when [6, 6]\n            check_2D6(total, dice_total, value_list, cmp_op, target)\n          end\n\n        return Result.new(ret.delete_prefix(\" ＞ \")) unless ret.nil? || ret.empty?\n\n        ret =\n          case sides_list.uniq\n          when [10]\n            check_nD10(total, dice_total, value_list, cmp_op, target)\n          when [6]\n            check_nD6(total, dice_total, value_list, cmp_op, target)\n          end\n\n        return Result.new(ret.delete_prefix(\" ＞ \")) unless ret.nil? || ret.empty?\n\n        return nil\n      end\n\n      # @param total [Integer]\n      # @param dice_total [Integer]\n      # @param cmp_op [Symbol]\n      # @param target\n      # @return [String, nil]\n      # @deprecated Base#result_1d100 を使ってください\n      def check_1D100(total, dice_total, cmp_op, target); end\n\n      # @param (see #check_1D100)\n      # @return [String, nil]\n      # @deprecated Base#result_1d20 を使ってください\n      def check_1D20(total, dice_total, cmp_op, target); end\n\n      # @param total [Integer]\n      # @param dice_total [Integer]\n      # @param dice_list [Array<Integer>]\n      # @param cmp_op [Symbol]\n      # @param target\n      # @return [String, nil]\n      # @deprecated Base#result_nd10 を使ってください\n      def check_nD10(total, dice_total, dice_list, cmp_op, target); end\n\n      # @param (see #check_nD10)\n      # @return [String, nil]\n      # @deprecated Base#result_2d6 を使ってください\n      def check_2D6(total, dice_total, dice_list, cmp_op, target); end\n\n      # @param (see #check_nD10)\n      # @return [String, nil]\n      # @deprecated Base#result_nd6 を使ってください\n      def check_nD6(total, dice_total, dice_list, cmp_op, target); end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:Deprecated>", "<module:Checker>", "self", "private", "check_result_legacy", "total", "rand_results", "cmp_op", "target", "sides_list", "map", "to_proc", "value_list", "dice_total", "sum", "ret", "100", "$ret_or_1", "check_1D100", "20", "check_1D20", "6", "check_2D6", "nil?", "empty?", "Result", "new", "delete_prefix", "10", "uniq", "check_nD10", "check_nD6"], :mappings=>"AAAAA,4CAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MAGEA,OAAAC;MAAAA;;QAAAA;;;QACEC,IAAAC,SAAAA,CAAAA;;AAOAC,QAAAA,mCAAAA,+BAAwBC,KAAD,EAAQC,YAAR,EAAsBC,MAAtB,EAA8BC,MAArDJ;AAAAA,UAAAA;;;UACEK,aAAyBC,MAAZJ,YAAYI,OAAAA,EAAAA,EAAAA,EAAM,OAADC,SAAAA,CAAAA,CAALD;UACzBE,aAAyBF,MAAZJ,YAAYI,OAAAA,EAAAA,EAAAA,EAAM,OAADC,SAAAA,CAAAA,CAALD;UACzBG,aAAaD,UAAUE,KAAAA,CAAAA;UAEvBC,MAEE,CAAA,QAAK,CAACC,GAAD,CAAL,EADAC,CAAAA,YAAKR,UAALQ,CACA,CAAA,GAAA,CACEf,IAAAgB,aAAAA,CAAYb,KAAZ,EAAmBQ,UAAnB,EAA+BN,MAA/B,EAAuCC,MAAvCU,CADF,IAEA,CAAA,QAAK,CAACC,EAAD,CAAL,EAvBV,SAuBU,CAAA,GAAA,CACEjB,IAAAkB,YAAAA,CAAWf,KAAX,EAAkBQ,UAAlB,EAA8BN,MAA9B,EAAsCC,MAAtCY,CADF,IAEA,CAAA,QAAK,CAACC,CAAD,EAAIA,CAAJ,CAAL,EAzBV,SAyBU,CAAA,GAAA,CACEnB,IAAAoB,WAAAA,CAAUjB,KAAV,EAAiBQ,UAAjB,EAA6BD,UAA7B,EAAyCL,MAAzC,EAAiDC,MAAjDc,CADF,IAAA,CALA,GAKA,CAAA,CAFA,CAFA;UAQF,KAAmD,CAAA,QAAAP,GAAGQ,SAAAA,CAAAA,CAAH,CAAA,IAAA,CAAA,QAAYR,GAAGS,WAAAA,CAAAA,CAAf,CAAA,CAAA,CAAnD;YAAA,OAAOC,YAAMC,KAAAA,CAAKX,GAAGY,eAAAA,CAAevB,KAAfuB,CAARD;UAAb;UAEAX,MAEE,CAAA,QAAK,CAACa,EAAD,CAAL,EADAX,CAAAA,YAAKR,UAAUoB,MAAAA,CAAAA,CAAfZ,CACA,CAAA,GAAA,CACEf,IAAA4B,YAAAA,CAAWzB,KAAX,EAAkBQ,UAAlB,EAA8BD,UAA9B,EAA0CL,MAA1C,EAAkDC,MAAlDsB,CADF,IAEA,CAAA,QAAK,CAACT,CAAD,CAAL,EAnCV,SAmCU,CAAA,GAAA,CACEnB,IAAA6B,WAAAA,CAAU1B,KAAV,EAAiBQ,UAAjB,EAA6BD,UAA7B,EAAyCL,MAAzC,EAAiDC,MAAjDuB,CADF,IAAA,CAHA,GAGA,CAAA,CAFA;UAMF,KAAmD,CAAA,QAAAhB,GAAGQ,SAAAA,CAAAA,CAAH,CAAA,IAAA,CAAA,QAAYR,GAAGS,WAAAA,CAAAA,CAAf,CAAA,CAAA,CAAnD;YAAA,OAAOC,YAAMC,KAAAA,CAAKX,GAAGY,eAAAA,CAAevB,KAAfuB,CAARD;UAAb;UAEA,OAAO;QA3BTtB,CAAAA;;AAoCAc,QAAAA,2BAAAA,YAlDN,GAkDMA,CAAAA;;AAKAE,QAAAA,0BAAAA,YAvDN,GAuDMA,CAAAA;;AASAU,QAAAA,0BAAAA,YAhEN,GAgEMA,CAAAA;;AAKAR,QAAAA,yBAAAA,YArEN,GAqEMA,CAAAA;QAKArB,OAAA8B,yBAAAA,YA1EN,GA0EMA,CAAAA;MApEF9B,GAAAA,WAAAA;IAHFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>3277, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/base.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"i18n\"\nrequire \"i18n/backend/fallbacks\"\nrequire \"bcdice/randomizer\"\nrequire \"bcdice/dice_table\"\nrequire \"bcdice/enum\"\nrequire \"bcdice/translate\"\nrequire \"bcdice/result\"\nrequire \"bcdice/command/parser\"\nrequire \"bcdice/deprecated/checker\"\n\nmodule BCDice\n  class Base\n    class << self\n      # 接頭辞（反応するコマンド）の配列を返す\n      # @return [Array<String>]\n      attr_reader :prefixes\n\n      # 応答するコマンドのprefixを登録する\n      # @param prefixes [Array<String>]\n      def register_prefix(*prefixes)\n        @prefixes = (@prefixes || []) + prefixes.flatten\n      end\n\n      def register_prefix_from_super_class\n        register_prefix(superclass.prefixes)\n      end\n\n      # ゲームシステム固有のコマンドにマッチする正規表現を返す\n      # 正規表現を一度生成したら、以後コマンドの登録はできないようにする\n      #\n      # @return [Regexp]\n      def prefixes_pattern\n        @prefixes_pattern ||= nil\n        return @prefixes_pattern if @prefixes_pattern\n\n        @prefixes ||= []\n        @prefixes.freeze\n        @prefixes_pattern =\n          if @prefixes.empty?\n            /(?!)/ # 何にもマッチしない正規表現\n          else\n            /^(S)?(\#{@prefixes.join('|')})/i\n          end.freeze\n      end\n\n      # 応答するコマンド全てにマッチする正規表現を返す\n      # 正規表現を一度生成したら、以後コマンドの登録はできないようにする\n      #\n      # @return [Regexp]\n      def command_pattern\n        @command_pattern ||= nil\n        return @command_pattern if @command_pattern\n\n        @prefixes ||= []\n        @prefixes.freeze\n        pattarns = CommonCommand::COMMANDS.map { |c| c::PREFIX_PATTERN.source } + @prefixes\n\n        @command_pattern = /^S?(\#{pattarns.join('|')})/i.freeze\n      end\n\n      # @param command [String]\n      # @return [Result]\n      def eval(command)\n        new(command).eval\n      end\n    end\n\n    include Translate\n    include Deprecated::Checker\n\n    def initialize(command)\n      @raw_input = command\n\n      @sort_add_dice = false # 加算ダイスでダイス目をソートするかどうか\n      @sort_barabara_dice = false # バラバラダイスでダイス目をソートするかどうか\n\n      @d66_sort_type = D66SortType::NO_SORT # 入れ替えの種類 詳しくはBCDice::D66SortTypeを参照すること\n\n      @enabled_d9 = false # D9ダイスを有効にするか（ガンドッグ）で使用\n\n      @round_type = RoundType::FLOOR # 割り算をした時の端数の扱い (FLOOR: 切り捨て, CEIL: 切り上げ, ROUND: 四捨五入)\n\n      @sides_implicit_d = 6 # 1D のようにダイスの面数が指定されていない場合に何面ダイスにするか\n\n      @upper_dice_reroll_threshold = nil # UpperDiceで振り足しをする出目の閾値 nilの場合デフォルト設定なし\n      @reroll_dice_reroll_threshold = nil # RerollDiceで振り足しをする出目の閾値 nilの場合デフォルト設定なし\n\n      @default_cmp_op = nil # 目標値が空欄の場合の比較演算子をシンボルで指定する (:>, :>= :<, :<=, :==, :!=)\n      @default_target_number = nil # 目標値が空欄の場合の目標値 こちらだけnilにするのは想定していないので注意\n\n      @enabled_upcase_input = true # 入力を String#upcase するかどうか\n\n      @locale = :ja_jp # i18n用の言語設定\n\n      @randomizer = BCDice::Randomizer.new\n      @debug = false\n    end\n\n    attr_accessor :randomizer\n\n    # D66のダイス入れ替えの種類\n    #\n    # @return [Symbol]\n    attr_reader :d66_sort_type\n\n    # 端数処理の種類\n    #\n    # @return [Symbol]\n    attr_reader :round_type\n\n    # ダイスの面数が指定されていない場合に何面ダイスにするか\n    #\n    # @return [Integer]\n    attr_reader :sides_implicit_d\n\n    # UpperDiceで振り足しをする出目の閾値\n    #\n    # @return [Integer, nil]\n    attr_reader :upper_dice_reroll_threshold\n\n    # RerollDiceで振り足しをする出目の閾値\n    #\n    # @return [Integer, nil]\n    attr_reader :reroll_dice_reroll_threshold\n\n    # デフォルトの比較演算子\n    #\n    # @return [Symbol, nil]\n    attr_reader :default_cmp_op\n\n    # デフォルトの目標値\n    #\n    # @return [Integer, nil]\n    attr_reader :default_target_number\n\n    # 加算ダイスでダイス目をソートするかどうか\n    #\n    # @return [Boolean]\n    def sort_add_dice?\n      @sort_add_dice\n    end\n\n    # バラバラダイスでダイス目をソートするかどうか\n    #\n    # @return [Boolean]\n    def sort_barabara_dice?\n      @sort_barabara_dice\n    end\n\n    # D9ダイスが有効か\n    #\n    # @return [Boolean]\n    def enabled_d9?\n      @enabled_d9\n    end\n\n    # デバッグを有用にする\n    def enable_debug\n      @debug = true\n    end\n\n    # コマンドを評価する\n    # @return [Result, nil] コマンド実行結果。コマンドが実行できなかった場合はnilを返す\n    def eval\n      command = BCDice::Preprocessor.process(@raw_input, self)\n\n      result = dice_command(command) || eval_common_command(@raw_input)\n      return nil unless result\n\n      result.rands = @randomizer.rand_results\n      result.detailed_rands = @randomizer.detailed_rand_results\n\n      return result\n    end\n\n    # ゲームシステムごとの入力コマンドの前処理\n    # @deprecated これを使わずに +eval_common_command+ 内でパースすることを推奨する\n    # @param string [String]\n    # @return [String]\n    def change_text(string)\n      string\n    end\n\n    # @param total [Integer] コマンド合計値\n    # @param rand_results [Array<CommonCommand::AddDice::Randomizer::RandResult>] ダイスの一覧\n    # @param cmp_op [Symbol] 比較演算子\n    # @param target [Integer, String] 目標値の整数か'?'\n    # @return [Result, nil]\n    def check_result(total, rand_results, cmp_op, target)\n      ret = check_result_legacy(total, rand_results, cmp_op, target)\n      return ret if ret\n\n      sides_list = rand_results.map(&:sides)\n      value_list = rand_results.map(&:value)\n      dice_total = value_list.sum()\n\n      ret =\n        case sides_list\n        when [100]\n          result_1d100(total, dice_total, cmp_op, target)\n        when [20]\n          result_1d20(total, dice_total, cmp_op, target)\n        when [6, 6]\n          result_2d6(total, dice_total, value_list, cmp_op, target)\n        end\n\n      return nil if ret == Result.nothing\n      return ret if ret\n\n      ret =\n        case sides_list.uniq\n        when [10]\n          result_nd10(total, dice_total, value_list, cmp_op, target)\n        when [6]\n          result_nd6(total, dice_total, value_list, cmp_op, target)\n        end\n\n      return nil if ret == Result.nothing\n      return ret if ret\n\n      return result_ndx(total, cmp_op, target)\n    end\n\n    # シャドウラン用グリッチ判定\n    # @param count_one [Integer] 出目1の数\n    # @param dice_total_count [Integer] ダイスロールしたダイスの数\n    # @param count_success [Integer] 成功数\n    # @return [String, nil]\n    def grich_text(count_one, dice_total_count, count_success); end\n\n    private\n\n    def eval_common_command(command)\n      command = change_text(command)\n      CommonCommand::COMMANDS.each do |klass|\n        result = klass.eval(command, self, @randomizer)\n        return result if result\n      end\n\n      return nil\n    end\n\n    def dice_command(command)\n      command = command.upcase if @enabled_upcase_input\n\n      m = self.class.prefixes_pattern.match(command)\n      unless m\n        return nil\n      end\n\n      secret = !m[1].nil?\n      command = command[1..-1] if secret # 先頭の 'S' をとる\n\n      output = eval_game_system_specific_command(command)\n\n      if output.is_a?(Result)\n        output.secret = output.secret? || secret\n        return output\n      elsif output.nil? || output.empty? || output == \"1\"\n        return nil\n      else\n        return Result.new.tap do |r|\n          r.text = output.to_s\n          r.secret = secret\n        end\n      end\n    end\n\n    # @param command [String]\n    # @return [String, nil]\n    def eval_game_system_specific_command(command); end\n\n    # 成功か失敗か返す\n    #\n    # @param total [Integer]\n    # @param cmp_op [Symbol]\n    # @param target [Number]\n    # @return [Result]\n    def result_ndx(total, cmp_op, target)\n      if target.is_a?(String)\n        nil\n      elsif total.send(cmp_op, target)\n        Result.success(translate(\"success\"))\n      else\n        Result.failure(translate(\"failure\"))\n      end\n    end\n\n    def result_1d100(total, dice_total, cmp_op, target); end\n\n    def result_1d20(total, dice_total, cmp_op, target); end\n\n    def result_nd10(total, dice_total, value_list, cmp_op, target); end\n\n    def result_2d6(total, dice_total, value_list, cmp_op, target); end\n\n    def result_nd6(total, dice_total, value_list, cmp_op, target); end\n\n    def get_table_by_2d6(table)\n      get_table_by_nD6(table, 2)\n    end\n\n    def get_table_by_1d6(table)\n      get_table_by_nD6(table, 1)\n    end\n\n    def get_table_by_nD6(table, count)\n      get_table_by_nDx(table, count, 6)\n    end\n\n    def get_table_by_nDx(table, count, diceType)\n      num = @randomizer.roll_sum(count, diceType)\n\n      text = get_table_value(table[num - count])\n\n      return \"1\", 0 if text.nil?\n\n      return text, num\n    end\n\n    def get_table_by_1d3(table)\n      debug(\"get_table_by_1d3\")\n\n      count = 1\n      num = @randomizer.roll_sum(count, 6)\n      debug(\"num\", num)\n\n      index = ((num - 1) / 2).to_i\n      debug(\"index\", index)\n\n      text = table[index]\n\n      return \"1\", 0 if text.nil?\n\n      return text, num\n    end\n\n    # D66 ロール用（スワップ、たとえば出目が【６，４】なら「６４」ではなく「４６」とする\n    def get_table_by_d66_swap(table)\n      number = @randomizer.roll_d66(D66SortType::ASC)\n      return get_table_by_number(number, table), number\n    end\n\n    # D66 ロール用\n    def get_table_by_d66(table)\n      dice1 = @randomizer.roll_once(6)\n      dice2 = @randomizer.roll_once(6)\n\n      num = (dice1 - 1) * 6 + (dice2 - 1)\n\n      text = table[num]\n\n      indexText = \"\#{dice1}\#{dice2}\"\n\n      return \"1\", indexText if text.nil?\n\n      return text, indexText\n    end\n\n    # ** 汎用表サブルーチン\n    def get_table_by_number(index, table, default = \"1\")\n      table.each do |item|\n        number = item[0]\n        if number >= index\n          return get_table_value(item[1])\n        end\n      end\n\n      return get_table_value(default)\n    end\n\n    def get_table_value(data)\n      if data.is_a?(Proc)\n        return data.call()\n      end\n\n      return data\n    end\n\n    def roll_tables(command, tables)\n      table = tables[command]\n      unless table\n        return nil\n      end\n\n      return table.roll(@randomizer).to_s\n    end\n\n    # デバッグ出力を行う\n    # @param [Object] target 対象項目\n    # @param [Object] values 値\n    def debug(target, *values)\n      return unless @debug\n\n      targetStr = target.is_a?(String) ? target : target.inspect\n\n      if values.empty?\n        warn targetStr\n      else\n        valueStrs = values.map do |value|\n          value.is_a?(String) ? %(\"\#{value}\") : value.inspect\n        end\n\n        warn \"\#{targetStr}: \#{valueStrs.join(', ')}\"\n      end\n    end\n  end\nend\n\nI18n::Backend::Simple.include(I18n::Backend::Fallbacks)\nI18n.load_path << Dir[File.join(__dir__, \"../../i18n/**/*.yml\")]\nI18n.default_locale = :ja_jp\nI18n.fallbacks.defaults = [:ja_jp]\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<class:Base>", "attr_reader", "register_prefix", "@prefixes", "+", "$ret_or_1", "prefixes", "flatten", "register_prefix_from_super_class", "superclass", "prefixes_pattern", "@prefixes_pattern", "freeze", "empty?", "join", "command_pattern", "@command_pattern", "pattarns", "map", "CommonCommand::COMMANDS", "CommonCommand", "block in command_pattern", "c", "block (2 levels) in command_pattern", "c::PREFIX_PATTERN", "source", "eval", "command", "new", "include", "Translate", "Deprecated::Checker", "Deprecated", "initialize", "@raw_input", "@sort_add_dice", "@sort_barabara_dice", "@d66_sort_type", "D66SortType::NO_SORT", "D66SortType", "@enabled_d9", "@round_type", "RoundType::FLOOR", "RoundType", "@sides_implicit_d", "6", "@upper_dice_reroll_threshold", "@reroll_dice_reroll_threshold", "@default_cmp_op", "@default_target_number", "@enabled_upcase_input", "@locale", "@randomizer", "BCDice::Randomizer", "BCDice", "@debug", "attr_accessor", "sort_add_dice?", "sort_barabara_dice?", "enabled_d9?", "enable_debug", "BCDice::Preprocessor", "process", "result", "dice_command", "eval_common_command", "rands=", "rand_results", "detailed_rands=", "detailed_rand_results", "change_text", "string", "check_result", "total", "cmp_op", "target", "ret", "check_result_legacy", "sides_list", "to_proc", "value_list", "dice_total", "sum", "100", "result_1d100", "20", "result_1d20", "result_2d6", "Result", "nothing", "10", "uniq", "result_nd10", "result_nd6", "result_ndx", "grich_text", "private", "each", "block in eval_common_command", "klass", "block (2 levels) in eval_common_command", "upcase", "m", "class", "match", "secret", "[]", "1", "nil?", "!", "-1", "output", "eval_game_system_specific_command", "is_a?", "secret=", "secret?", "tap", "block in dice_command", "r", "block (2 levels) in dice_command", "text=", "to_s", "String", "send", "success", "translate", "failure", "get_table_by_2d6", "table", "get_table_by_nD6", "2", "get_table_by_1d6", "count", "get_table_by_nDx", "diceType", "num", "roll_sum", "text", "get_table_value", "-", "0", "get_table_by_1d3", "debug", "index", "/", "to_i", "get_table_by_d66_swap", "number", "roll_d66", "D66SortType::ASC", "get_table_by_number", "get_table_by_d66", "dice1", "roll_once", "dice2", "*", "indexText", "default$", "block in get_table_by_number", "item", "block (2 levels) in get_table_by_number", ">=", "data", "Proc", "call", "roll_tables", "tables", "roll", "targetStr", "inspect", "values", "warn", "valueStrs", "block in debug", "value", "block (2 levels) in debug", "I18n::Backend::Simple", "I18n::Backend", "I18n", "I18n::Backend::Fallbacks", "load_path", "<<", "Dir", "File", "__dir__", "default_locale=", "defaults=", "fallbacks"], :mappings=>"AAAAA,8BAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,MAARE;EACAD,IAAAC,SAAAA,CAAQF,wBAARE;EACAD,IAAAC,SAAAA,CAAQF,mBAARE;EACAD,IAAAC,SAAAA,CAAQF,mBAARE;EACAD,IAAAC,SAAAA,CAAQF,aAARE;EACAD,IAAAC,SAAAA,CAAQF,kBAARE;EACAD,IAAAC,SAAAA,CAAQF,eAARE;EACAD,IAAAC,SAAAA,CAAQF,uBAARE;EACAD,IAAAC,SAAAA,CAAQF,2BAARE;EAEAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;AAAAA;;MACE;QAAA;;;QAGEH,IAAAI,aAAAA,CAAY,UAAZA;;AAIAC,QAAAA,+BAAAA,2BArBN,EAqBMA;AAAAA,UAAAA;AAAAA;;;UArBN;UAqB0B;UAClBA,OAAAC,CAAAA,gBAA8BC,SAAjB,CAAA,QAAAC,CAAAA,YAAAF,aAAAE,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAa,EAAb,CAAA,CAAiBD,EAAEE,QAAQC,SAAAA,CAAAA,CAAVH,CAA9BD;QADFD,CAAAA,IAAAA;;AAIAM,QAAAA,gDAAAA,4CAAAA;AAAAA,UAAAA;;UACEA,OAAAX,IAAAK,iBAAAA,CAAgBL,IAAAY,YAAAA,CAAAA,CAAUH,UAAAA,CAAAA,CAA1BJ;QADFM,CAAAA;;AAQAE,QAAAA,gCAAAA,4BAAAA;AAAAA,UAAAA;AAAAA;AAAAA;;;UACEC,wBAlCR,CAAA,QAAAN,CAAAA,YAkCQM,qBAlCRN,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAkC8B,GAlC9B,CAAA;UAmCQ,IAAA,QAA4BM,qBAA5B,CAAA;YAAA,OAAOA;UAAP;UAEAR,gBArCR,CAAA,QAAAE,CAAAA,YAqCQF,aArCRE,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAqCsB,EArCtB,CAAA;UAsCQF,aAASS,QAAAA,CAAAA;UACTF,OAAAC,CAAAA,wBACE,CAAA,QAAGR,aAASU,WAAAA,CAAAA,CAAZ,CAAA,GAAA,CACE,MADF,IAAA,CAGE,SAACH,QAAD,EAASP,aAASW,MAAAA,CAAMJ,GAANI,CAAlB,EAA6BJ,GAA7B,CAAA,KAAA,CAHF,CAAA,CAIGE,QAAAA,CAAAA,CALLD;QANFD,CAAAA;;AAkBAK,QAAAA,+BAAAA,2BAAAA;AAAAA,UAAAA;AAAAA;AAAAA;;;UACEC,uBApDR,CAAA,QAAAX,CAAAA,YAoDQW,oBApDRX,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAoD6B,GApD7B,CAAA;UAqDQ,IAAA,QAA2BW,oBAA3B,CAAA;YAAA,OAAOA;UAAP;UAEAb,gBAvDR,CAAA,QAAAE,CAAAA,YAuDQF,aAvDRE,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAuDsB,EAvDtB,CAAA;UAwDQF,aAASS,QAAAA,CAAAA;UACTK,WAAwEb,SAAtCc,MAAvBC,IAAAC,mBAAAD,aAAuBD,OAAAA,EAAAA,EAAAA,EAAvBG,aAA+BC,CAA/BD;;YAA+B;YAAGE,OAAAC,IAAAF,CAAAE,mBAAiBC,QAAAA,CAAAA,EAAnDJ,CAAuBH,CAAsCd,EAAED,aAAFC;UAExEW,OAAAC,CAAAA,uBAAmB,SAACD,MAAD,EAAOE,QAAQH,MAAAA,CAAMC,GAAND,CAAf,EAA0BC,GAA1B,CAAA,KAAA,CAA6BH,QAAAA,CAAAA,CAAhDI;QARFD,CAAAA;QAaA,OAAAW,oBAAAA,iBAASC,OAATD,GAAAA,MAAAA,IAAAA,wCAAAA;AAAAA,UAAAA;;UACEA,OAAA7B,IAAA+B,KAAAA,CAAID,OAAJC,CAAYF,MAAAA,CAAAA,CADdA;YAAAA;YAAAA;UAAAA;QAAAA,CAAAA;MAlDF,4BAAS7B,IAAT;MAuDAA,IAAAgC,SAAAA,CAAQC,eAARD;MACAhC,IAAAgC,SAAAA,CAAQE,IAAAC,gBAAAD,YAARF;;AAEAI,MAAAA,0BAAAA,sBAAeN,OAAfM;AAAAA,QAAAA;;;QACEC,iBAAaP;QAEbQ,qBAAiB;QACjBC,0BAAsB;QAEtBC,qBAAiBC,IAAAC,iBAAAD;QAEjBE,kBAAc;QAEdC,kBAAcC,IAAAC,eAAAD;QAEdE,wBAAoBC;QAEpBC,mCAA+B;QAC/BC,oCAAgC;QAEhCC,sBAAkB;QAClBC,6BAAyB;QAEzBC,4BAAwB;QAExBC,cAAU;QAEVC,kBAAcC,IAAAC,YAAAD,eAAkBzB,KAAAA,CAAAA;QAChCK,OAAAsB,CAAAA,aAAS,KAATA;MAzBFtB,CAAAA;MA4BApC,IAAA2D,eAAAA,CAAc,YAAdA;MAKA3D,IAAAI,aAAAA,CAAY,eAAZA;MAKAJ,IAAAI,aAAAA,CAAY,YAAZA;MAKAJ,IAAAI,aAAAA,CAAY,kBAAZA;MAKAJ,IAAAI,aAAAA,CAAY,6BAAZA;MAKAJ,IAAAI,aAAAA,CAAY,8BAAZA;MAKAJ,IAAAI,aAAAA,CAAY,gBAAZA;MAKAJ,IAAAI,aAAAA,CAAY,uBAAZA;;AAKAwD,MAAAA,8BAAAA,aACE,eADFA,CAAAA;;AAOAC,MAAAA,mCAAAA,aACE,oBADFA,CAAAA;;AAOAC,MAAAA,2BAAAA,aACE,YADFA,CAAAA;;AAKAC,MAAAA,4BAAAA,iBACE,OADFA,EACW,IADXA,CAAAA;;AAMAlC,MAAAA,oBAAAA,sBAAAA;AAAAA,QAAAA;;;QACEC,UAAUkC,IAAAP,YAAAO,iBAAoBC,SAAAA,CAAS5B,cAA7B,EAAyCrC,IAArBiE;QAE9BC,SAAS,CAAA,QAAA1D,CAAAA,YAAAR,IAAAmE,cAAAA,CAAarC,OAAbqC,CAAA3D,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAyBR,IAAAoE,qBAAAA,CAAoB/B,cAApB+B,CAAzB,CAAA;QACT,KAAA,QAAkBF,MAAlB,CAAA;UAAA,OAAO;QAAP;QAEAA,MAAMG,WAAAA,CAASd,eAAWe,cAAAA,CAAAA,CAApBD;QACNH,MAAMK,oBAAAA,CAAkBhB,eAAWiB,uBAAAA,CAAAA,CAA7BD;QAEN,OAAOL;MATTrC,CAAAA;;AAgBA4C,MAAAA,2BAAAA,uBAAgBC,MAAhBD;AAAAA;QACEA,OAAAC;MADFD,CAAAA;;AASAE,MAAAA,4BAAAA,wBAAiBC,KAAD,EAAQN,YAAR,EAAsBO,MAAtB,EAA8BC,MAA9CH;AAAAA,QAAAA;;;QACEI,MAAM/E,IAAAgF,qBAAAA,CAAoBJ,KAApB,EAA2BN,YAA3B,EAAyCO,MAAzC,EAAiDC,MAAjDE;QACN,IAAA,QAAcD,GAAd,CAAA;UAAA,OAAOA;QAAP;QAEAE,aAAyB5D,MAAZiD,YAAYjD,OAAAA,EAAAA,EAAAA,EAAM,OAAD6D,SAAAA,CAAAA,CAAL7D;QACzB8D,aAAyB9D,MAAZiD,YAAYjD,OAAAA,EAAAA,EAAAA,EAAM,OAAD6D,SAAAA,CAAAA,CAAL7D;QACzB+D,aAAaD,UAAUE,KAAAA,CAAAA;QAEvBN,MAEE,CAAA,QAAK,CAACO,GAAD,CAAL,EADA9E,CAAAA,YAAKyE,UAALzE,CACA,CAAA,GAAA,CACER,IAAAuF,cAAAA,CAAaX,KAAb,EAAoBQ,UAApB,EAAgCP,MAAhC,EAAwCC,MAAxCS,CADF,IAEA,CAAA,QAAK,CAACC,EAAD,CAAL,EA1MR,SA0MQ,CAAA,GAAA,CACExF,IAAAyF,aAAAA,CAAYb,KAAZ,EAAmBQ,UAAnB,EAA+BP,MAA/B,EAAuCC,MAAvCW,CADF,IAEA,CAAA,QAAK,CAACzC,CAAD,EAAIA,CAAJ,CAAL,EA5MR,SA4MQ,CAAA,GAAA,CACEhD,IAAA0F,YAAAA,CAAWd,KAAX,EAAkBQ,UAAlB,EAA8BD,UAA9B,EAA0CN,MAA1C,EAAkDC,MAAlDY,CADF,IAAA,CALA,GAKA,CAAA,CAFA,CAFA;QAQF,IAAA,MAAcX,GAAd,EAAqBY,YAAMC,SAAAA,CAAAA,CAA3B,CAAA;UAAA,OAAO;QAAP;QACA,IAAA,QAAcb,GAAd,CAAA;UAAA,OAAOA;QAAP;QAEAA,MAEE,CAAA,QAAK,CAACc,EAAD,CAAL,EADArF,CAAAA,YAAKyE,UAAUa,MAAAA,CAAAA,CAAftF,CACA,CAAA,GAAA,CACER,IAAA+F,aAAAA,CAAYnB,KAAZ,EAAmBQ,UAAnB,EAA+BD,UAA/B,EAA2CN,MAA3C,EAAmDC,MAAnDiB,CADF,IAEA,CAAA,QAAK,CAAC/C,CAAD,CAAL,EAvNR,SAuNQ,CAAA,GAAA,CACEhD,IAAAgG,YAAAA,CAAWpB,KAAX,EAAkBQ,UAAlB,EAA8BD,UAA9B,EAA0CN,MAA1C,EAAkDC,MAAlDkB,CADF,IAAA,CAHA,GAGA,CAAA,CAFA;QAMF,IAAA,MAAcjB,GAAd,EAAqBY,YAAMC,SAAAA,CAAAA,CAA3B,CAAA;UAAA,OAAO;QAAP;QACA,IAAA,QAAcb,GAAd,CAAA;UAAA,OAAOA;QAAP;QAEA,OAAO/E,IAAAiG,YAAAA,CAAWrB,KAAX,EAAkBC,MAAlB,EAA0BC,MAA1BmB;MAhCTtB,CAAAA;;AAwCAuB,MAAAA,0BAAAA,YAtOJ,GAsOIA,CAAAA;MAEAlG,IAAAmG,SAAAA,CAAAA;;AAEA/B,MAAAA,mCAAAA,+BAAwBtC,OAAxBsC,GAAAA,MAAAA,IAAAA,wEAAAA;AAAAA,QAAAA;;;QACEtC,UAAU9B,IAAAyE,aAAAA,CAAY3C,OAAZ2C;QACa2B,MAAvB9E,IAAAC,mBAAAD,aAAuB8E,QAAAA,EAAAA,EAAAA,EAAvBC,aAAiCC,KAAjCD,EAAAE;AAAAA;;;UAAiC;UAC/BrC,SAASoC,KAAKzE,MAAAA,CAAMC,OAAX,EAAoB9B,IAApB,EAA0BuD,eAArB1B;UACd,IAAA,QAAiBqC,MAAjB,CAAA;YAAA,SAAA,QAAOA,MAAP;UAAA;YA9ORqC,OAAA;UA8OQ,EAFFF,CAAAA,GAAAA,2BAAAA,CAAuBD;QAKvB,OAAO,IAPThC;UAAAA;UAAAA;UAAAA;QAAAA;MAAAA,CAAAA;;AAUAD,MAAAA,4BAAAA,wBAAiBrC,OAAjBqC;AAAAA,QAAAA;;;QACE,IAAA,QAA4Bd,yBAA5B,CAAA;UAAAvB,UAAUA,OAAO0E,QAAAA,CAAAA;QAAjB;QAEAC,IAAIzG,IAAI0G,OAAAA,CAAAA,CAAM7F,kBAAAA,CAAAA,CAAiB8F,OAAAA,CAAO7E,OAAP6E;QAC/B,KAAA,QAAOF,CAAP,CAAA;UACE,OAAO;QADT;QAIAG,SAAUH,CAACI,OAAAA,CAACC,CAADD,CAAGE,SAAAA,CAAAA,CAALC,MAAAA,CAAAA;QACT,IAAA,QAA4BJ,MAA5B,CAAA;UAAA9E,UAAUA,OAAO+E,OAAAA,CAAC,OAAAC,CAAA,EAAGG,EAAH,QAADJ;QAAjB;QAEAK,SAASlH,IAAAmH,mCAAAA,CAAkCrF,OAAlCqF;QAET,IAAA,QAAGD,MAAME,UAAAA,CAAOzB,YAAPyB,CAAT,CAAA;;UACEF,MAAMG,YAAAA,CAAU,CAAA,QAAA7G,CAAAA,YAAA0G,MAAMI,YAAAA,CAAAA,CAAN9G,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAkBoG,MAAlB,CAAA,CAAVS;UACN,OAAOH;QAFT,OAGA,IAAM,CAAA,CAAA,QAAAA,MAAMH,SAAAA,CAAAA,CAAN,CAAA,IAAA,CAAA,QAAeG,MAAMlG,WAAAA,CAAAA,CAArB,CAAA,CAAA,CAAA,IAAA,CAAA,MAAgCkG,MAAhC,EAA0C/C,GAA1C,CAAA,CAAA,CAAN;UACE,OAAO;QADT;UAGE,OAAiBoD,MAAV5B,YAAM5D,KAAAA,CAAAA,CAAIwF,OAAAA,EAAAA,EAAAA,EAAVC,aAAmBC,CAAnBD,EAAAE;;;YAAmB;YACxBD,CAACE,UAAAA,CAAQT,MAAMU,MAAAA,CAAAA,CAAdD;YACDD,OAACL,MAAAA,CAAUT,MAAVS,CAAAA,EAAAA,MAADI,CAACJ,WAAAA,EAAAA,EAAAA,CAAAA,EAAAA,mBAFIG,CAAUD;QAHnB;MAhBFpD,CAAAA;;AA4BAgD,MAAAA,iDAAAA,YAhRJ,GAgRIA,CAAAA;;AAQAlB,MAAAA,0BAAAA,sBAAerB,KAAD,EAAQC,MAAR,EAAgBC,MAA9BmB;AAAAA,QAAAA;;QACE,IAAA,QAAGnB,MAAMsC,UAAAA,CAAOS,YAAPT,CAAT,CAAA;UACEnB,OAAA;QADF,OAEA,IAAA,QAAMrB,KAAKkD,MAAAA,CAAMjD,MAAX,EAAmBC,MAAdgD,CAAX,CAAA;UACE7B,OAAAN,YAAMoC,SAAAA,CAAS/H,IAAAgI,WAAAA,CAAU/B,SAAV+B,CAATD;QADR;UAGE9B,OAAAN,YAAMsC,SAAAA,CAASjI,IAAAgI,WAAAA,CAAU/B,SAAV+B,CAATC;QAHR;MAHFhC,CAAAA;;AAUAV,MAAAA,4BAAAA,YAlSJ,GAkSIA,CAAAA;;AAEAE,MAAAA,2BAAAA,YApSJ,GAoSIA,CAAAA;;AAEAM,MAAAA,2BAAAA,YAtSJ,GAsSIA,CAAAA;;AAEAL,MAAAA,0BAAAA,YAxSJ,GAwSIA,CAAAA;;AAEAM,MAAAA,0BAAAA,YA1SJ,GA0SIA,CAAAA;;AAEAkC,MAAAA,gCAAAA,4BAAqBC,KAArBD;AAAAA,QAAAA;;QACEA,OAAAlI,IAAAoI,kBAAAA,CAAiBD,KAAjB,EAAwBE,CAAxBD;MADFF,CAAAA;;AAIAI,MAAAA,gCAAAA,4BAAqBH,KAArBG;AAAAA,QAAAA;;QACEA,OAAAtI,IAAAoI,kBAAAA,CAAiBD,KAAjB,EAAwBrB,CAAxBsB;MADFE,CAAAA;;AAIAF,MAAAA,gCAAAA,4BAAqBD,KAAD,EAAQI,KAA5BH;AAAAA,QAAAA;;QACEA,OAAApI,IAAAwI,kBAAAA,CAAiBL,KAAjB,EAAwBI,KAAxB,EAA+BvF,CAA/BwF;MADFJ,CAAAA;;AAIAI,MAAAA,gCAAAA,4BAAqBL,KAAD,EAAQI,KAAR,EAAeE,QAAnCD;AAAAA,QAAAA;;;QACEE,MAAMnF,eAAWoF,UAAAA,CAAUJ,KAArB,EAA4BE,QAAjBE;QAEjBC,OAAO5I,IAAA6I,iBAAAA,CAAgBV,KAAKtB,OAAAA,CAAKiC,UAAJJ,GAAII,EAAEP,KAAFO,CAALjC,CAArBgC;QAEP,IAAA,QAAiBD,IAAI7B,SAAAA,CAAAA,CAArB,CAAA;UAAA,OAAA,CAAOyB,GAAP,EAAYO,CAAZ;QAAA;QAEA,OAAA,CAAOH,IAAP,EAAaF,GAAb;MAPFF,CAAAA;;AAUAQ,MAAAA,gCAAAA,4BAAqBb,KAArBa;AAAAA,QAAAA;;;QACEhJ,IAAAiJ,OAAAA,CAAMD,kBAANC;QAEAV,QAAQzB;QACR4B,MAAMnF,eAAWoF,UAAAA,CAAUJ,KAArB,EAA4BvF,CAAjB2F;QACjB3I,IAAAiJ,OAAAA,CAAMD,KAAN,EAAaN,GAAbO;QAEAC,QAAmBC,WAALL,UAAJJ,GAAII,EAAEhC,CAAFgC,CAAKK,EAAEd,CAAFc,CAAIC,MAAAA,CAAAA;QACvBpJ,IAAAiJ,OAAAA,CAAMD,OAAN,EAAeE,KAAfD;QAEAL,OAAOT,KAAKtB,OAAAA,CAACqC,KAADrC;QAEZ,IAAA,QAAiB+B,IAAI7B,SAAAA,CAAAA,CAArB,CAAA;UAAA,OAAA,CAAOiC,GAAP,EAAYD,CAAZ;QAAA;QAEA,OAAA,CAAOH,IAAP,EAAaF,GAAb;MAdFM,CAAAA;;AAkBAK,MAAAA,qCAAAA,iCAA0BlB,KAA1BkB;AAAAA,QAAAA;;;QACEC,SAAS/F,eAAWgG,UAAAA,CAAUC,IAAA9G,iBAAA8G,QAAVD;QACpB,OAAA,CAAOvJ,IAAAyJ,qBAAAA,CAAoBH,MAApB,EAA4BnB,KAA5BsB,CAAP,EAA2CH,MAA3C;MAFFD,CAAAA;;AAMAK,MAAAA,gCAAAA,4BAAqBvB,KAArBuB;AAAAA,QAAAA;;;QACEC,QAAQpG,eAAWqG,WAAAA,CAAW5G,CAAX4G;QACnBC,QAAQtG,eAAWqG,WAAAA,CAAW5G,CAAX4G;QAEnBlB,MAAsBnI,SAAJuJ,UAALhB,UAANa,KAAMb,EAAEhC,CAAFgC,CAAKgB,EAAE9G,CAAF8G,CAAIvJ,EAASuI,UAANe,KAAMf,EAAEhC,CAAFgC,CAATvI;QAEtBqI,OAAOT,KAAKtB,OAAAA,CAAC6B,GAAD7B;QAEZkD,YAAY,EAAA,GAAA,CAAGJ,KAAH,CAAA,GAAA,CAAWE,KAAX;QAEZ,IAAA,QAAyBjB,IAAI7B,SAAAA,CAAAA,CAA7B,CAAA;UAAA,OAAA,CAAO2C,GAAP,EAAYK,SAAZ;QAAA;QAEA,OAAA,CAAOnB,IAAP,EAAamB,SAAb;MAZFL,CAAAA;;AAgBAD,MAAAA,mCAAAA,+BAAwBP,KAAD,EAAQf,KAAR,EAAe6B,QAAtCP,GAAAA,MAAAA,IAAAA,8BAAAA;AAAAA,QAAAA;;;QAAsC,iCAAUA;QACzCrD,MAAL+B,KAAK/B,QAAAA,EAAAA,EAAAA,EAAL6D,aAAeC,IAAfD,EAAAE;;;UAAe;UACbb,SAASY,IAAIrD,OAAAA,CAACkC,CAADlC;UACb,IAAA,QAAUuD,OAAPd,MAAOc,EAAGlB,KAAHkB,CAAV,CAAA;YACE,SAAA,QAAOpK,IAAA6I,iBAAAA,CAAgBqB,IAAIrD,OAAAA,CAACC,CAADD,CAApBgC,CAAP;UADF;YA7WRsB,OAAA;UA6WQ,EAFFF,CAAAA,GAAAA,2BAAAA,CAAK7D;QAOL,OAAOpG,IAAA6I,iBAAAA,CAAgBmB,QAAhBnB,EARTY;UAAAA;UAAAA;QAAAA;MAAAA,CAAAA,IAAAA;;AAWAZ,MAAAA,+BAAAA,2BAAoBwB,IAApBxB;AAAAA;;QACE,IAAA,QAAGwB,IAAIjD,UAAAA,CAAOkD,UAAPlD,CAAP,CAAA;UACE,OAAOiD,IAAIE,MAAAA,CAAAA;QADb;QAIA,OAAOF;MALTxB,CAAAA;;AAQA2B,MAAAA,2BAAAA,uBAAgB1I,OAAD,EAAU2I,MAAzBD;AAAAA,QAAAA;;;QACErC,QAAQsC,MAAM5D,OAAAA,CAAC/E,OAAD+E;QACd,KAAA,QAAOsB,KAAP,CAAA;UACE,OAAO;QADT;QAIA,OAAOA,KAAKuC,MAAAA,CAAMnH,eAANmH,CAAkB9C,MAAAA,CAAAA;MANhC4C,CAAAA;MAYArK,OAAA8I,qBAAAA,iBAAUnE,MAAD,EAzYb,EAyYImE;AAAAA,QAAAA;;;QAzYJ;QAyYsB;QAChB,KAAA,QAAcvF,UAAd,CAAA;UAAA,OAAA;QAAA;QAEAiH,YAAY,CAAA,QAAA7F,MAAMsC,UAAAA,CAAOS,YAAPT,CAAN,CAAA,GAAA,CAAuBtC,MAAvB,IAAA,CAAgCA,MAAM8F,SAAAA,CAAAA,CAAtC,CAAA;QAEZ,IAAA,QAAGC,MAAM7J,WAAAA,CAAAA,CAAT,CAAA;UACEiI,OAAAjJ,IAAA8K,MAAAA,CAAKH,SAALG;QADF;;UAGEC,YAAkB1J,MAANwJ,MAAMxJ,OAAAA,EAAAA,EAAAA,EAAN2J,aAAeC,KAAfD;;YAAe;YACzB,IAAA,QAAAC,KAAK7D,UAAAA,CAAOS,YAAPT,CAAL,CAAA;cAAsB8D,OAAEA,IAAF,GAAA,CAAKD,KAAL,CAAA,GAAWC;YAAjC;cAAsCA,OAAAD,KAAKL,SAAAA,CAAAA;YAA3C,EADUI,CAAM3J;UAIlB4H,OAAAjJ,IAAA8K,MAAAA,CAAK,EAAA,GAAA,CAAGH,SAAH,CAAA,GAAa1B,IAAb,GAAA,CAAiB8B,SAAS9J,MAAAA,CAAMgI,IAANhI,CAA1B,CAAL6J;QAPF;MALF7B,CAAAA,IAAAA;IA5XF9I,GAAAA,WAAAA,EAAAA,IAAAA;EADFD,GAAAA,WAAAA;EA+YAiL,IAAAC,IAAAC,UAAAD,YAAAD,WAAqBnJ,SAAAA,CAASsJ,IAAAF,IAAAC,UAAAD,YAAAE,cAATtJ;EACrBqJ,UAAIE,WAAAA,CAAAA,CAAWC,OAAAA,CAAGC,SAAG5E,OAAAA,CAAC6E,UAAIzK,MAAAA,CAAM0K,QAAV,EAAmB5L,qBAAfkB,CAAL4F,CAAN2E;EACfH,UAAIO,oBAAAA,CAAkB,OAAlBA;EACJ7L,OAAc8L,MAAAA,CAAY,CAAC,OAAD,CAAZA,CAAAA,EAAAA,MAAdR,UAAIS,WAAAA,CAAAA,CAAUD,aAAAA,EAAAA,EAAAA,CAAAA,EAAAA;AA9Zd9L;"}}, {:offset=>{:line=>3678, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/sword_world/rating_lexer.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"strscan\"\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld < Base\n      class RatingLexer\n        SYMBOLS = {\n          \"+\" => :PLUS,\n          \"-\" => :MINUS,\n          \"*\" => :ASTERISK,\n          \"/\" => :SLASH,\n          \"(\" => :PARENL,\n          \")\" => :PARENR,\n          \"[\" => :BRACKETL,\n          \"]\" => :BRACKETR,\n          \"@\" => :AT,\n          \"#\" => :SHARP,\n          \"$\" => :DOLLAR,\n        }.freeze\n\n        def initialize(source)\n          # sourceが空文字だとString#splitが空になる\n          source = source&.split(\" \", 2)&.first || \"\"\n          @scanner = StringScanner.new(source)\n        end\n\n        def next_token\n          return [false, \"$\"] if @scanner.eos?\n\n          if (number = @scanner.scan(/\\d+/))\n            [:NUMBER, number.to_i]\n          else\n            char = @scanner.getch.upcase\n            type = SYMBOLS[char] || char.to_sym\n            [type, char]\n          end\n        end\n\n        def source\n          @scanner.string\n        end\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld>", "<class:RatingLexer>", "freeze", "initialize", "source", "$ret_or_1", "2", "@scanner", "StringScanner", "new", "next_token", "eos?", "number", "scan", "to_i", "char$", "getch", "upcase", "type", "SYMBOLS", "[]", "to_sym", "string", "Base"], :mappings=>"AAAAA,8DAAAA,gBAAAA;EAAAA;;;EAEAC,IAAAC,SAAAA,CAAQF,SAARE;EAEAF,OAAAG;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;QACEA,OAAAC;QAAAA;;UAAAA;;AAAAA;;UACE,mCAAU,iEAAA,KACD,MADC,EAAA,KAED,OAFC,EAAA,KAGD,UAHC,EAAA,KAID,OAJC,EAAA,KAKD,QALC,EAAA,KAMD,QANC,EAAA,KAOD,UAPC,EAAA,KAQD,UARC,EAAA,KASD,IATC,EAAA,KAUD,OAVC,EAAA,KAWD,QAXC,EAYTC,QAAAA,CAAAA,CAZD;;AAcAC,UAAAA,0BAAAA,sBAAeC,MAAfD;AAAAA,YAAAA;;;YAEEC,SAAS,CAAA,QAAAC,CAAAA,YAAA,CAAA,KAAA,CAAA,KAAAD,MAAA,qCAAA,EAAA,OAAA,CAAcD,GAAd,EAAmBG,CAAnB,CAAA,CAAA,qCAAA,EAAA,OAAA,CAAA,CAAA,CAAAD,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAgCF,EAAhC,CAAA;YACTA,OAAAI,CAAAA,eAAWC,mBAAaC,KAAAA,CAAKL,MAALK,CAAxBF;UAHFJ,CAAAA;;AAMAO,UAAAA,0BAAAA,sBAAAA;AAAAA,YAAAA;;;YACE,IAAA,QAAuBH,YAAQI,SAAAA,CAAAA,CAA/B,CAAA;cAAA,OAAO,CAAC,KAAD,EAAQD,GAAR;YAAP;YAEA,IAAA,QAAIE,CAAAA,SAASL,YAAQM,MAAAA,CAAM,KAANA,CAAjBD,CAAJ,CAAA;cACEF,OAAA,CAAC,QAAD,EAAUE,MAAME,MAAAA,CAAAA,CAAhB;YADF;;cAGEC,QAAOR,YAAQS,OAAAA,CAAAA,CAAMC,QAAAA,CAAAA;cACrBC,OAAO,CAAA,QAAAb,CAAAA,YAAAc,aAAOC,OAAAA,CAACL,KAADK,CAAPf,CAAA,CAAA,GAAA,CAAA,SAAA,IAAA,CAAiBU,KAAIM,QAAAA,CAAAA,CAArB,CAAA;cACPX,OAAA,CAACQ,IAAD,EAAOH,KAAP;YALF;UAHFL,CAAAA;UAYAT,OAAAG,sBAAAA,kBAAAA;AAAAA,YAAAA;;YACEA,OAAAG,YAAQe,QAAAA,CAAAA;UADVlB,CAAAA;QAjCFH,GAAAA,WAAAA,EAAAA,IAAAA;MADFD,GAAAA,WAAAA,EAAmBuB,UAAnBvB;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAJAH;"}}, {:offset=>{:line=>3742, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/sword_world/rating_parsed.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld < Base\n      class RatingParsed\n        # @return [Integer]\n        attr_accessor :rate\n\n        # @return [Integer]\n        attr_accessor :critical\n\n        # @return [Integer]\n        attr_accessor :kept_modify\n\n        # @return [Integer]\n        attr_accessor :first_to\n\n        # @return [Integer]\n        attr_accessor :first_modify\n\n        # @return [Integer]\n        attr_accessor :rateup\n\n        # @return [Boolean]\n        attr_accessor :greatest_fortune\n\n        # @return [Integer]\n        attr_accessor :semi_fixed_val\n\n        # @return [Integer]\n        attr_accessor :tmp_fixed_val\n\n        # @return [Integer]\n        attr_accessor :modifier\n\n        # @return [Integer, nil]\n        attr_accessor :modifier_after_half\n\n        # @return [Integer, nil]\n        attr_accessor :modifier_after_one_and_a_half\n\n        def initialize(rate, modifier)\n          @rate = rate\n          @modifier = modifier\n          @critical = 13\n          @kept_modify = 0\n          @first_to = 0\n          @first_modify = 0\n          @greatest_fortune = false\n          @rateup = 0\n          @semi_fixed_val = 0\n          @tmp_fixed_val = 0\n          @modifier_after_half = nil\n          @modifier_after_one_and_a_half = nil\n        end\n\n        # @return [Boolean]\n        def half\n          return !@modifier_after_half.nil?\n        end\n\n        # @return [Boolean]\n        def one_and_a_half\n          return !@modifier_after_one_and_a_half.nil?\n        end\n\n        # @return [Integer]\n        def min_critical\n          if @semi_fixed_val <= 1\n            return 3\n          else\n            return (@semi_fixed_val + @kept_modify + 2).clamp(3, 13)\n          end\n        end\n\n        # @return [Boolean]\n        def infinite_roll?\n          return critical < min_critical\n        end\n\n        # @return [String]\n        def to_s()\n          output = \"KeyNo.\#{@rate}\"\n\n          output += \"c[\#{critical}]\" if critical < 13\n          output += \"m[\#{Format.modifier(first_modify)}]\" if first_modify != 0\n          output += \"m[\#{first_to}]\" if first_to != 0\n          output += \"r[\#{rateup}]\" if rateup != 0\n          output += \"gf\" if @greatest_fortune\n          output += \"sf[\#{semi_fixed_val}]\" if semi_fixed_val != 0\n          output += \"tf[\#{tmp_fixed_val}]\" if tmp_fixed_val != 0\n          output += \"a[\#{Format.modifier(kept_modify)}]\" if kept_modify != 0\n\n          if @modifier != 0\n            output += Format.modifier(@modifier)\n          end\n          return output\n        end\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld>", "<class:RatingParsed>", "self", "attr_accessor", "initialize", "rate", "modifier", "@rate", "@modifier", "@critical", "13", "@kept_modify", "0", "@first_to", "@first_modify", "@greatest_fortune", "@rateup", "@semi_fixed_val", "@tmp_fixed_val", "@modifier_after_half", "@modifier_after_one_and_a_half", "half", "nil?", "!", "one_and_a_half", "min_critical", "<=", "1", "3", "+", "2", "clamp", "infinite_roll?", "<", "critical", "to_s", "output", "first_modify", "Format", "first_to", "rateup", "semi_fixed_val", "tmp_fixed_val", "kept_modify", "Base"], :mappings=>"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"}}, {:offset=>{:line=>3865, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/sword_world/rating_options.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld < Base\n      class RatingOptions\n        # @return [Integer, nil]\n        attr_accessor :critical\n\n        # @return [Integer, nil]\n        attr_accessor :kept_modify\n\n        # @return [Integer, nil]\n        attr_accessor :first_to\n\n        # @return [Integer, nil]\n        attr_accessor :first_modify\n\n        # @return [Integer, nil]\n        attr_accessor :rateup\n\n        # @return [Boolean, nil]\n        attr_accessor :greatest_fortune\n\n        # @return [Integer, nil]\n        attr_accessor :semi_fixed_val\n\n        # @return [Integer, nil]\n        attr_accessor :tmp_fixed_val\n\n        # @return [Integer, nil]\n        attr_accessor :modifier\n\n        # @return [Integer, nil]\n        attr_accessor :modifier_after_half\n\n        # @return [Integer, nil]\n        attr_accessor :modifier_after_one_and_a_half\n\n        def settable_first_roll_adjust_option?\n          return first_modify.nil? && first_to.nil?\n        end\n\n        def settable_non_2d_roll_option?\n          return greatest_fortune.nil? && semi_fixed_val.nil? && tmp_fixed_val.nil?\n        end\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld>", "<class:RatingOptions>", "self", "attr_accessor", "settable_first_roll_adjust_option?", "$ret_or_1", "first_modify", "nil?", "first_to", "settable_non_2d_roll_option?", "$ret_or_2", "greatest_fortune", "semi_fixed_val", "tmp_fixed_val", "Base"], :mappings=>"AAAAA,gEAAAA,gBAAAA;EAAAA;;EAEAA,OAAAC;EAAAA;;IAAAA;;IACEA,OAAAC;IAAAA;;MAAAA;;MACEA,OAAAC;MAAAA;;QAAAA;;QACEA,OAAAC;QAAAA;;;;UAEEC,IAAAC,eAAAA,CAAc,UAAdA;UAGAD,IAAAC,eAAAA,CAAc,aAAdA;UAGAD,IAAAC,eAAAA,CAAc,UAAdA;UAGAD,IAAAC,eAAAA,CAAc,cAAdA;UAGAD,IAAAC,eAAAA,CAAc,QAAdA;UAGAD,IAAAC,eAAAA,CAAc,kBAAdA;UAGAD,IAAAC,eAAAA,CAAc,gBAAdA;UAGAD,IAAAC,eAAAA,CAAc,eAAdA;UAGAD,IAAAC,eAAAA,CAAc,UAAdA;UAGAD,IAAAC,eAAAA,CAAc,qBAAdA;UAGAD,IAAAC,eAAAA,CAAc,+BAAdA;;AAEAC,UAAAA,kDAAAA,iEAAAA;AAAAA,YAAAA;;YACE,OAAO,CAAA,QAAAC,CAAAA,YAAAH,IAAAI,cAAAA,CAAAA,CAAYC,SAAAA,CAAAA,CAAZF,CAAA,CAAA,GAAA,CAAqBH,IAAAM,UAAAA,CAAAA,CAAQD,SAAAA,CAAAA,CAA7B,IAAA,CAAA,SAAA,CAAA;UADTH,CAAAA;UAIAH,OAAAQ,4CAAAA,2DAAAA;AAAAA,YAAAA;;YACE,OAAO,CAAA,QAAAJ,CAAAA,YAAA,CAAA,QAAAK,CAAAA,YAAAR,IAAAS,kBAAAA,CAAAA,CAAgBJ,SAAAA,CAAAA,CAAhBG,CAAA,CAAA,GAAA,CAAyBR,IAAAU,gBAAAA,CAAAA,CAAcL,SAAAA,CAAAA,CAAvC,IAAA,CAAA,SAAA,CAAA,CAAAF,CAAA,CAAA,GAAA,CAAgDH,IAAAW,eAAAA,CAAAA,CAAaN,SAAAA,CAAAA,CAA7D,IAAA,CAAA,SAAA,CAAA;UADTE,CAAAA;QAtCFR,GAAAA,WAAAA,EAAAA,IAAAA;MADFD,GAAAA,WAAAA,EAAmBc,UAAnBd;IADFD,GAAAA,WAAAA;EADFD,GAAAA,WAAAA;AAFAD;"}}, {:offset=>{:line=>3916, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/sword_world/rating_parser.rb"], :sourcesContent=>["#\n# DO NOT MODIFY!!!!\n# This file is automatically generated by Racc 1.7.3\n# from Racc grammar file \"rating_parser.y\".\n#\n\nrequire 'racc/parser.rb'\n\n\nrequire \"bcdice/arithmetic/node\"\nrequire \"bcdice/enum\"\nrequire \"bcdice/game_system/sword_world/rating_lexer\"\nrequire \"bcdice/game_system/sword_world/rating_parsed\"\nrequire \"bcdice/game_system/sword_world/rating_options\"\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld < Base\n    # SwordWorldの威力表コマンドをパースするクラス\n\nclass RatingParser < Racc::Parser\n\n\n# デフォルトの丸めを切り上げとしているが、SwordWorldには切り捨てもあるので決め切れない（四捨五入は現状ない）\ndef initialize(version: :v1_0, round_type: RoundType::CEIL)\n  super()\n  @version = version\n  @round_type = round_type\nend\n\ndef set_debug\n  @yydebug = true\n  return self\nend\n\n# @param source [String]\n# @return [BCDice::GameSystem::SwordWorld::RatingParsed, nil]\ndef parse(source)\n  @lexer = RatingLexer.new(source)\n  do_parse()\nrescue ParseError, ZeroDivisionError\n  nil\nend\n\nprivate\n\ndef parsed(rate, modifier, option)\n  RatingParsed.new(rate, modifier).tap do |p|\n    p.kept_modify = option.kept_modify&.eval(@round_type) || 0\n    p.first_to = option.first_to || 0\n    p.first_modify = option.first_modify || 0\n    p.rateup = option.rateup&.eval(@round_type) || 0\n    p.greatest_fortune = option.greatest_fortune if !option.greatest_fortune.nil?\n    p.semi_fixed_val = option.semi_fixed_val&.clamp(1, 6) || 0\n    p.tmp_fixed_val = option.tmp_fixed_val&.clamp(1, 6) || 0\n    p.modifier_after_half = option.modifier_after_half&.eval(@round_type)\n    p.modifier_after_one_and_a_half = option.modifier_after_one_and_a_half&.eval(@round_type)\n    p.critical = option.critical&.eval(@round_type)&.clamp(0, 13) || (p.half || p.one_and_a_half ? 13 : 10)\n  end\nend\n\ndef next_token\n  @lexer.next_token\nend\n\n##### State transition tables begin ###\n\nracc_action_table = [\n    18,    16,    17,    19,     6,    20,    21,    23,    24,    64,\n    65,    27,    28,    13,    66,    14,    22,    15,    18,    16,\n    17,    19,     5,    20,    21,    23,    24,     5,     9,     3,\n     4,    13,    10,    14,    22,    15,    18,    16,    17,    19,\n    11,    20,    21,    23,    24,    34,     5,    34,    40,    13,\n    42,    14,    22,    15,    30,    31,    30,    31,    33,    34,\n    33,    34,    62,    63,    62,    63,    34,    43,    30,    31,\n    30,    31,    33,    34,    33,    30,    31,    44,    34,    33,\n    34,    52,    30,    31,    57,    34,    33,    30,    31,    30,\n    31,    33,    34,    33,    30,    31,    58,    34,    33,    34,\n    60,    30,    31,    61,    34,    33,    30,    31,    30,    31,\n    33,    34,    33,    30,    31,   nil,    34,    33,    34,   nil,\n    30,    31,   nil,    34,    33,    30,    31,    30,    31,    33,\n    36,    33,    30,    31,    62,    63,    33,    62,    63,    37,\n    38,    62,    63,    62,    63,    62,    63 ]\n\nracc_action_check = [\n     7,     7,     7,     7,     1,     7,     7,     7,     7,    55,\n    55,    12,    12,     7,    55,     7,     7,     7,    25,    25,\n    25,    25,     3,    25,    25,    25,    25,     0,     4,     0,\n     0,    25,     5,    25,    25,    25,    49,    49,    49,    49,\n     6,    49,    49,    49,    49,    13,     9,    14,    17,    49,\n    19,    49,    49,    49,    13,    13,    14,    14,    13,    16,\n    14,    18,    46,    46,    48,    48,    22,    20,    16,    16,\n    18,    18,    16,    23,    18,    22,    22,    21,    24,    22,\n    27,    29,    23,    23,    37,    28,    23,    24,    24,    27,\n    27,    24,    30,    27,    28,    28,    38,    31,    28,    33,\n    43,    30,    30,    44,    40,    30,    31,    31,    33,    33,\n    31,    62,    33,    40,    40,   nil,    63,    40,    64,   nil,\n    62,    62,   nil,    65,    62,    63,    63,    64,    64,    63,\n    15,    64,    65,    65,    50,    50,    65,    51,    51,    15,\n    15,    56,    56,    69,    69,    70,    70 ]\n\nracc_action_pointer = [\n    24,     4,   nil,    19,    23,    30,    40,    -4,   nil,    43,\n   nil,   nil,     0,    43,    45,   128,    57,    43,    59,    42,\n    59,    69,    64,    71,    76,    14,   nil,    78,    83,    63,\n    90,    95,   nil,    97,   nil,   nil,   nil,    82,    94,   nil,\n   102,   nil,   nil,    98,   101,   nil,    49,   nil,    51,    32,\n   121,   124,   nil,   nil,   nil,    -2,   128,   nil,   nil,   nil,\n   nil,   nil,   109,   114,   116,   121,   nil,   nil,   nil,   130,\n   132 ]\n\nracc_action_default = [\n   -36,   -36,    -5,   -36,   -36,   -36,   -36,    -1,    -5,   -36,\n    -4,    71,    -6,   -36,   -36,   -36,   -12,   -36,   -36,   -36,\n   -36,   -36,   -36,   -36,   -36,    -2,    -5,   -36,   -36,   -36,\n   -36,   -36,   -33,   -36,   -35,    -8,    -9,   -36,   -36,   -13,\n   -14,   -16,   -17,   -36,   -36,   -20,   -21,   -30,   -22,    -3,\n   -23,   -24,    -7,   -31,   -32,   -36,   -27,   -10,   -11,   -15,\n   -18,   -19,   -36,   -36,   -36,   -36,   -34,   -28,   -29,   -25,\n   -26 ]\n\nracc_goto_table = [\n    29,    35,     7,    39,     1,    41,    46,    48,    25,    45,\n    50,    51,     2,    55,   nil,     8,    56,    53,    54,   nil,\n   nil,    26,   nil,   nil,   nil,   nil,    49,    59,   nil,   nil,\n   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,\n   nil,   nil,   nil,   nil,   nil,   nil,   nil,    69,    70,    67,\n    68 ]\n\nracc_goto_check = [\n     5,     5,     3,     5,     1,     5,     6,     6,     3,     5,\n     6,     6,     2,     7,   nil,     2,     6,     5,     5,   nil,\n   nil,     2,   nil,   nil,   nil,   nil,     3,     5,   nil,   nil,\n   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,\n   nil,   nil,   nil,   nil,   nil,   nil,   nil,     6,     6,     5,\n     5 ]\n\nracc_goto_pointer = [\n   nil,     4,    12,     0,   nil,   -13,   -17,   -20,   nil ]\n\nracc_goto_default = [\n   nil,   nil,   nil,   nil,    12,    47,   nil,   nil,    32 ]\n\nracc_reduce_table = [\n  0, 0, :racc_error,\n  2, 23, :_reduce_1,\n  3, 23, :_reduce_2,\n  4, 23, :_reduce_3,\n  2, 24, :_reduce_4,\n  0, 25, :_reduce_5,\n  2, 25, :_reduce_6,\n  4, 25, :_reduce_7,\n  3, 25, :_reduce_8,\n  3, 25, :_reduce_9,\n  4, 25, :_reduce_10,\n  4, 25, :_reduce_11,\n  2, 25, :_reduce_12,\n  3, 25, :_reduce_13,\n  3, 25, :_reduce_14,\n  4, 25, :_reduce_15,\n  3, 25, :_reduce_16,\n  3, 25, :_reduce_17,\n  4, 25, :_reduce_18,\n  4, 25, :_reduce_19,\n  3, 25, :_reduce_20,\n  2, 26, :_reduce_21,\n  2, 26, :_reduce_22,\n  3, 26, :_reduce_23,\n  3, 26, :_reduce_24,\n  3, 29, :_reduce_25,\n  3, 29, :_reduce_26,\n  1, 29, :_reduce_none,\n  3, 28, :_reduce_28,\n  3, 28, :_reduce_29,\n  1, 28, :_reduce_none,\n  2, 27, :_reduce_31,\n  2, 27, :_reduce_32,\n  1, 27, :_reduce_none,\n  3, 30, :_reduce_34,\n  1, 30, :_reduce_35 ]\n\nracc_reduce_n = 36\n\nracc_shift_n = 71\n\nracc_token_table = {\n  false => 0,\n  :error => 1,\n  :NUMBER => 2,\n  :K => 3,\n  :R => 4,\n  :H => 5,\n  :O => 6,\n  :G => 7,\n  :F => 8,\n  :S => 9,\n  :T => 10,\n  :PLUS => 11,\n  :MINUS => 12,\n  :ASTERISK => 13,\n  :SLASH => 14,\n  :PARENL => 15,\n  :PARENR => 16,\n  :BRACKETL => 17,\n  :BRACKETR => 18,\n  :AT => 19,\n  :SHARP => 20,\n  :DOLLAR => 21 }\n\nracc_nt_base = 22\n\nracc_use_result_var = true\n\nRacc_arg = [\n  racc_action_table,\n  racc_action_check,\n  racc_action_default,\n  racc_action_pointer,\n  racc_goto_table,\n  racc_goto_check,\n  racc_goto_default,\n  racc_goto_pointer,\n  racc_nt_base,\n  racc_reduce_table,\n  racc_token_table,\n  racc_shift_n,\n  racc_reduce_n,\n  racc_use_result_var ]\nRactor.make_shareable(Racc_arg) if defined?(Ractor)\n\nRacc_token_to_s_table = [\n  \"$end\",\n  \"error\",\n  \"NUMBER\",\n  \"K\",\n  \"R\",\n  \"H\",\n  \"O\",\n  \"G\",\n  \"F\",\n  \"S\",\n  \"T\",\n  \"PLUS\",\n  \"MINUS\",\n  \"ASTERISK\",\n  \"SLASH\",\n  \"PARENL\",\n  \"PARENR\",\n  \"BRACKETL\",\n  \"BRACKETR\",\n  \"AT\",\n  \"SHARP\",\n  \"DOLLAR\",\n  \"$start\",\n  \"expr\",\n  \"rate\",\n  \"option\",\n  \"modifier\",\n  \"unary\",\n  \"mul\",\n  \"add\",\n  \"term\" ]\nRactor.make_shareable(Racc_token_to_s_table) if defined?(Ractor)\n\nRacc_debug_parser = false\n\n##### State transition tables end #####\n\n# reduce 0 omitted\n\ndef _reduce_1(val, _values, result)\n          rate, option = val\n          modifier = option.modifier || Arithmetic::Node::Number.new(0)\n          result = parsed(rate, modifier.eval(@round_type), option)\n\n    result\nend\n\ndef _reduce_2(val, _values, result)\n          _, rate, option = val\n          raise ParseError if option.modifier_after_one_and_a_half\n          option.modifier_after_half ||= Arithmetic::Node::Number.new(0)\n          modifier = option.modifier || Arithmetic::Node::Number.new(0)\n          result = parsed(rate, modifier.eval(@round_type), option)\n\n    result\nend\n\ndef _reduce_3(val, _values, result)\n          _, _, rate, option = val\n          raise ParseError if option.modifier_after_half\n          option.modifier_after_one_and_a_half ||= Arithmetic::Node::Number.new(0)\n          modifier = option.modifier || Arithmetic::Node::Number.new(0)\n          result = parsed(rate, modifier.eval(@round_type), option)\n\n    result\nend\n\ndef _reduce_4(val, _values, result)\n result = val[1].to_i\n    result\nend\n\ndef _reduce_5(val, _values, result)\n            result = RatingOptions.new\n\n    result\nend\n\ndef _reduce_6(val, _values, result)\n            option, term = val\n            raise ParseError unless option.modifier.nil?\n\n            option.modifier = term\n            result = option\n\n    result\nend\n\ndef _reduce_7(val, _values, result)\n            option, _, term, _ = val\n            raise ParseError unless option.critical.nil?\n\n            option.critical = term\n            result = option\n\n    result\nend\n\ndef _reduce_8(val, _values, result)\n            option, _, term = val\n            raise ParseError unless option.critical.nil?\n\n            option.critical = term\n            result = option\n\n    result\nend\n\ndef _reduce_9(val, _values, result)\n            option, _, term = val\n            raise ParseError unless option.settable_first_roll_adjust_option?\n\n            option.first_to = term.to_i\n            result = option\n\n    result\nend\n\ndef _reduce_10(val, _values, result)\n            option, _, _, term = val\n            raise ParseError unless option.settable_first_roll_adjust_option?\n\n            option.first_modify = term.to_i\n            result = option\n\n    result\nend\n\ndef _reduce_11(val, _values, result)\n            option, _, _, term = val\n            raise ParseError unless option.settable_first_roll_adjust_option?\n\n            option.first_modify = -(term.to_i)\n            result = option\n\n    result\nend\n\ndef _reduce_12(val, _values, result)\n            option, _ = val\n            raise ParseError unless option.modifier_after_half.nil?\n\n            option.modifier_after_half = Arithmetic::Node::Number.new(0)\n            result = option\n\n    result\nend\n\ndef _reduce_13(val, _values, result)\n            option, _, term = val\n            raise ParseError unless option.modifier_after_half.nil?\n\n            option.modifier_after_half = term\n            result = option\n\n    result\nend\n\ndef _reduce_14(val, _values, result)\n            option, _, _ = val\n            raise ParseError if option.modifier_after_one_and_a_half\n\n            option.modifier_after_one_and_a_half = Arithmetic::Node::Number.new(0)\n            result = option\n\n    result\nend\n\ndef _reduce_15(val, _values, result)\n            option, _, _, term = val\n            raise ParseError if option.modifier_after_one_and_a_half\n\n            option.modifier_after_one_and_a_half = term\n            result = option\n\n    result\nend\n\ndef _reduce_16(val, _values, result)\n            option, _, term = val\n            raise ParseError unless [:v2_5, :v2_0].include?(@version) && option.rateup.nil?\n\n            option.rateup = term\n            result = option\n\n    result\nend\n\ndef _reduce_17(val, _values, result)\n            option, _, _ = val\n            raise ParseError unless [:v2_5, :v2_0].include?(@version) && option.settable_non_2d_roll_option?\n\n            option.greatest_fortune = true\n            result = option\n\n    result\nend\n\ndef _reduce_18(val, _values, result)\n            option, _, _, term = val\n            raise ParseError unless [:v2_5, :v2_0].include?(@version) && option.settable_non_2d_roll_option?\n\n            option.semi_fixed_val = term.to_i\n            result = option\n\n    result\nend\n\ndef _reduce_19(val, _values, result)\n            option, _, _, term = val\n            raise ParseError unless [:v2_5, :v2_0].include?(@version) && option.settable_non_2d_roll_option?\n\n            option.tmp_fixed_val = term.to_i\n            result = option\n\n    result\nend\n\ndef _reduce_20(val, _values, result)\n            option, _, term = val\n            raise ParseError unless @version == :v2_5 && option.kept_modify.nil?\n\n            option.kept_modify = term\n            result = option\n\n    result\nend\n\ndef _reduce_21(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_22(val, _values, result)\n result = Arithmetic::Node::Negative.new(val[1])\n    result\nend\n\ndef _reduce_23(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :+, val[2])\n    result\nend\n\ndef _reduce_24(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :-, val[2])\n    result\nend\n\ndef _reduce_25(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :+, val[2])\n    result\nend\n\ndef _reduce_26(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :-, val[2])\n    result\nend\n\n# reduce 27 omitted\n\ndef _reduce_28(val, _values, result)\n result = Arithmetic::Node::BinaryOp.new(val[0], :*, val[2])\n    result\nend\n\ndef _reduce_29(val, _values, result)\n         result = Arithmetic::Node::DivideWithGameSystemDefault.new(val[0], val[2])\n\n    result\nend\n\n# reduce 30 omitted\n\ndef _reduce_31(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_32(val, _values, result)\n result = Arithmetic::Node::Negative.new(val[1])\n    result\nend\n\n# reduce 33 omitted\n\ndef _reduce_34(val, _values, result)\n result = val[1]\n    result\nend\n\ndef _reduce_35(val, _values, result)\n result = Arithmetic::Node::Number.new(val[0])\n    result\nend\n\ndef _reduce_none(val, _values, result)\n  val[0]\nend\n\nend   # class RatingParser\n\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld>", "<class:RatingParser>", "initialize", "$kwargs", "RoundType::CEIL", "RoundType", "@version", "version", "@round_type", "round_type", "set_debug", "@yydebug", "parse", "source", "@lexer", "RatingLexer", "new", "do_parse", "ParseError", "ZeroDivisionError", "private", "parsed", "rate", "modifier", "option", "tap", "RatingParsed", "block in parsed", "p", "block (2 levels) in parsed", "kept_modify=", "$ret_or_1", "kept_modify", "0", "first_to=", "first_to", "first_modify=", "first_modify", "rateup=", "rateup", "greatest_fortune", "nil?", "greatest_fortune=", "semi_fixed_val=", "semi_fixed_val", "1", "6", "tmp_fixed_val=", "tmp_fixed_val", "modifier_after_half=", "modifier_after_half", "modifier_after_one_and_a_half=", "modifier_after_one_and_a_half", "critical=", "critical", "13", "half", "one_and_a_half", "10", "next_token", "racc_action_table", "racc_action_check", "racc_action_pointer", "racc_action_default", "racc_goto_table", "racc_goto_check", "racc_goto_pointer", "4", "12", "-13", "-17", "-20", "racc_goto_default", "47", "32", "racc_reduce_table", "racc_reduce_n", "36", "racc_shift_n", "71", "racc_token_table", "2", "3", "5", "7", "8", "9", "11", "14", "15", "16", "17", "18", "19", "20", "21", "racc_nt_base", "22", "racc_use_result_var", "Ractor", "make_shareable", "Racc_arg", "Racc_token_to_s_table", "_reduce_1", "val", "_values", "result", "Arithmetic::Node::Number", "Arithmetic::Node", "Arithmetic", "eval", "_reduce_2", "_", "raise", "_reduce_3", "_reduce_4", "[]", "to_i", "_reduce_5", "RatingOptions", "_reduce_6", "term", "modifier=", "_reduce_7", "_reduce_8", "_reduce_9", "settable_first_roll_adjust_option?", "_reduce_10", "_reduce_11", "-@", "_reduce_12", "_reduce_13", "_reduce_14", "_reduce_15", "_reduce_16", "include?", "_reduce_17", "settable_non_2d_roll_option?", "_reduce_18", "_reduce_19", "_reduce_20", "_reduce_21", "_reduce_22", "Arithmetic::Node::Negative", "_reduce_23", "Arithmetic::Node::BinaryOp", "_reduce_24", "_reduce_25", "_reduce_26", "_reduce_28", "_reduce_29", "Arithmetic::Node::DivideWithGameSystemDefault", "_reduce_31", "_reduce_32", "_reduce_34", "_reduce_35", "_reduce_none", "Racc::Parser", "Racc", "Base"], :mappings=>"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"}}, {:offset=>{:line=>4354, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/SwordWorld.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/base\"\nrequire \"bcdice/game_system/sword_world/rating_parser\"\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld < Base\n      # ゲームシステムの識別子\n      ID = 'SwordWorld'\n\n      # ゲームシステム名\n      NAME = 'ソード・ワールドRPG'\n\n      # ゲームシステム名の読みがな\n      SORT_KEY = 'そおとわあると'\n\n      # ダイスボットの使い方\n      HELP_MESSAGE = \"・SW　レーティング表　(Kx[c]+m$f) (x:キー, c:クリティカル値, m:ボーナス, f:出目修正)\\n\"\n\n      register_prefix('H?K')\n\n      def initialize(command)\n        super(command)\n        @rating_table = 0\n      end\n\n      def result_2d6(total, dice_total, _dice_list, cmp_op, target)\n        if dice_total >= 12\n          Result.critical(translate('SwordWorld.critical'))\n        elsif dice_total <= 2\n          Result.fumble(translate('SwordWorld.fumble'))\n        elsif cmp_op != :>= || target == \"?\"\n          nil\n        elsif total >= target\n          Result.success(translate('success'))\n        else\n          Result.failure(translate('failure'))\n        end\n      end\n\n      def eval_game_system_specific_command(command)\n        rating(command)\n      end\n\n      private\n\n      def rating_parser\n        return RatingParser.new\n      end\n\n      ####################        SWレーティング表       ########################\n      def rating(string) # レーティング表\n        debug(\"rating string\", string)\n        command = rating_parser.parse(string)\n\n        unless command\n          debug(\"not matched\")\n          return '1'\n        end\n\n        # 2.0対応\n        rate_sw2_0 = getSW2_0_RatingTable\n\n        keyMax = rate_sw2_0.length - 1\n        debug(\"keyMax\", keyMax)\n        if command.rate > keyMax\n          return Result.new(translate('SwordWorld.keynumber_exceeds', keyMax: keyMax))\n        end\n\n        if command.infinite_roll?\n          return Result.new(translate('SwordWorld.infinite_critical', min_critical: command.min_critical))\n        end\n\n        newRates = getNewRates(rate_sw2_0)\n\n        output = \"\#{command} ＞ \"\n\n        diceResultTotals = []\n        diceResults = []\n        rateResults = []\n        dice = 0\n        diceOnlyTotal = 0\n        totalValue = 0\n        round = 0\n        first_to = command.first_to\n        first_modify = command.first_modify\n\n        loop do\n          dice_raw, diceText = rollDice(command, round)\n          dice = dice_raw\n\n          if first_to != 0\n            dice = dice_raw = first_to\n            first_to = 0\n          elsif first_modify != 0\n            dice += first_modify\n            first_modify = 0\n          end\n\n          # 出目がピンゾロの時にはそこで終了\n          if dice_raw <= 2\n            diceResultTotals << dice_raw.to_s\n            diceResults << diceText.to_s\n            rateResults << \"**\"\n\n            round += 1\n            break\n          end\n\n          dice += command.kept_modify if (command.kept_modify != 0) && (dice != 2)\n\n          dice = 2 if dice < 2\n          dice = 12 if dice > 12\n\n          currentKey = (command.rate + round * command.rateup).clamp(0, keyMax)\n          debug(\"currentKey\", currentKey)\n          rateValue = newRates[dice][currentKey]\n          debug(\"rateValue\", rateValue)\n\n          totalValue += rateValue\n          diceOnlyTotal += dice\n\n          diceResultTotals << dice.to_s\n          diceResults << diceText.to_s\n          rateResults << (dice > 2 ? rateValue : \"**\")\n\n          round += 1\n\n          break unless dice >= command.critical\n        end\n\n        result_text, critical, fumble = getResultText(\n          totalValue, command, diceResults, diceResultTotals,\n          rateResults, diceOnlyTotal, round\n        )\n        output += result_text\n\n        return Result.new.tap do |r|\n          r.text = output\n          r.critical = critical\n          r.fumble = fumble\n        end\n      end\n\n      def getSW2_0_RatingTable\n        rate_sw2_0 = [\n          # 0\n          '*,0,0,0,1,2,2,3,3,4,4',\n          '*,0,0,0,1,2,3,3,3,4,4',\n          '*,0,0,0,1,2,3,4,4,4,4',\n          '*,0,0,1,1,2,3,4,4,4,5',\n          '*,0,0,1,2,2,3,4,4,5,5',\n          '*,0,1,1,2,2,3,4,5,5,5',\n          '*,0,1,1,2,3,3,4,5,5,5',\n          '*,0,1,1,2,3,4,4,5,5,6',\n          '*,0,1,2,2,3,4,4,5,6,6',\n          '*,0,1,2,3,3,4,4,5,6,7',\n          '*,1,1,2,3,3,4,5,5,6,7',\n          # 11\n          '*,1,2,2,3,3,4,5,6,6,7',\n          '*,1,2,2,3,4,4,5,6,6,7',\n          '*,1,2,3,3,4,4,5,6,7,7',\n          '*,1,2,3,4,4,4,5,6,7,8',\n          '*,1,2,3,4,4,5,5,6,7,8',\n          '*,1,2,3,4,4,5,6,7,7,8',\n          '*,1,2,3,4,5,5,6,7,7,8',\n          '*,1,2,3,4,5,6,6,7,7,8',\n          '*,1,2,3,4,5,6,7,7,8,9',\n          '*,1,2,3,4,5,6,7,8,9,10',\n          # 21\n          '*,1,2,3,4,6,6,7,8,9,10',\n          '*,1,2,3,5,6,6,7,8,9,10',\n          '*,2,2,3,5,6,7,7,8,9,10',\n          '*,2,3,4,5,6,7,7,8,9,10',\n          '*,2,3,4,5,6,7,8,8,9,10',\n          '*,2,3,4,5,6,8,8,9,9,10',\n          '*,2,3,4,6,6,8,8,9,9,10',\n          '*,2,3,4,6,6,8,9,9,10,10',\n          '*,2,3,4,6,7,8,9,9,10,10',\n          '*,2,4,4,6,7,8,9,10,10,10',\n          # 31\n          '*,2,4,5,6,7,8,9,10,10,11',\n          '*,3,4,5,6,7,8,10,10,10,11',\n          '*,3,4,5,6,8,8,10,10,10,11',\n          '*,3,4,5,6,8,9,10,10,11,11',\n          '*,3,4,5,7,8,9,10,10,11,12',\n          '*,3,5,5,7,8,9,10,11,11,12',\n          '*,3,5,6,7,8,9,10,11,12,12',\n          '*,3,5,6,7,8,10,10,11,12,13',\n          '*,4,5,6,7,8,10,11,11,12,13',\n          '*,4,5,6,7,9,10,11,11,12,13',\n          # 41\n          '*,4,6,6,7,9,10,11,12,12,13',\n          '*,4,6,7,7,9,10,11,12,13,13',\n          '*,4,6,7,8,9,10,11,12,13,14',\n          '*,4,6,7,8,10,10,11,12,13,14',\n          '*,4,6,7,9,10,10,11,12,13,14',\n          '*,4,6,7,9,10,10,12,13,13,14',\n          '*,4,6,7,9,10,11,12,13,13,15',\n          '*,4,6,7,9,10,12,12,13,13,15',\n          '*,4,6,7,10,10,12,12,13,14,15',\n          '*,4,6,8,10,10,12,12,13,15,15',\n          # 51\n          '*,5,7,8,10,10,12,12,13,15,15',\n          '*,5,7,8,10,11,12,12,13,15,15',\n          '*,5,7,9,10,11,12,12,14,15,15',\n          '*,5,7,9,10,11,12,13,14,15,16',\n          '*,5,7,10,10,11,12,13,14,16,16',\n          '*,5,8,10,10,11,12,13,15,16,16',\n          '*,5,8,10,11,11,12,13,15,16,17',\n          '*,5,8,10,11,12,12,13,15,16,17',\n          '*,5,9,10,11,12,12,14,15,16,17',\n          '*,5,9,10,11,12,13,14,15,16,18',\n          # 61\n          '*,5,9,10,11,12,13,14,16,17,18',\n          '*,5,9,10,11,13,13,14,16,17,18',\n          '*,5,9,10,11,13,13,15,17,17,18',\n          '*,5,9,10,11,13,14,15,17,17,18',\n          '*,5,9,10,12,13,14,15,17,18,18',\n          '*,5,9,10,12,13,15,15,17,18,19',\n          '*,5,9,10,12,13,15,16,17,19,19',\n          '*,5,9,10,12,14,15,16,17,19,19',\n          '*,5,9,10,12,14,16,16,17,19,19',\n          '*,5,9,10,12,14,16,17,18,19,19',\n          # 71\n          '*,5,9,10,13,14,16,17,18,19,20',\n          '*,5,9,10,13,15,16,17,18,19,20',\n          '*,5,9,10,13,15,16,17,19,20,21',\n          '*,6,9,10,13,15,16,18,19,20,21',\n          '*,6,9,10,13,16,16,18,19,20,21',\n          '*,6,9,10,13,16,17,18,19,20,21',\n          '*,6,9,10,13,16,17,18,20,21,22',\n          '*,6,9,10,13,16,17,19,20,22,23',\n          '*,6,9,10,13,16,18,19,20,22,23',\n          '*,6,9,10,13,16,18,20,21,22,23',\n          # 81\n          '*,6,9,10,13,17,18,20,21,22,23',\n          '*,6,9,10,14,17,18,20,21,22,24',\n          '*,6,9,11,14,17,18,20,21,23,24',\n          '*,6,9,11,14,17,19,20,21,23,24',\n          '*,6,9,11,14,17,19,21,22,23,24',\n          '*,7,10,11,14,17,19,21,22,23,25',\n          '*,7,10,12,14,17,19,21,22,24,25',\n          '*,7,10,12,14,18,19,21,22,24,25',\n          '*,7,10,12,15,18,19,21,22,24,26',\n          '*,7,10,12,15,18,19,21,23,25,26',\n          # 91\n          '*,7,11,13,15,18,19,21,23,25,26',\n          '*,7,11,13,15,18,20,21,23,25,27',\n          '*,8,11,13,15,18,20,22,23,25,27',\n          '*,8,11,13,16,18,20,22,23,25,28',\n          '*,8,11,14,16,18,20,22,23,26,28',\n          '*,8,11,14,16,19,20,22,23,26,28',\n          '*,8,12,14,16,19,20,22,24,26,28',\n          '*,8,12,15,16,19,20,22,24,27,28',\n          '*,8,12,15,17,19,20,22,24,27,29',\n          '*,8,12,15,18,19,20,22,24,27,30',\n        ]\n\n        return rate_sw2_0\n      end\n\n      def getNewRates(rate_sw2_0)\n        rate_3 = []\n        rate_4 = []\n        rate_5 = []\n        rate_6 = []\n        rate_7 = []\n        rate_8 = []\n        rate_9 = []\n        rate_10 = []\n        rate_11 = []\n        rate_12 = []\n        zeroArray = []\n\n        rate_sw2_0.each do |rateText|\n          rate_arr = rateText.split(/,/)\n          zeroArray.push(0)\n          rate_3.push(rate_arr[1].to_i)\n          rate_4.push(rate_arr[2].to_i)\n          rate_5.push(rate_arr[3].to_i)\n          rate_6.push(rate_arr[4].to_i)\n          rate_7.push(rate_arr[5].to_i)\n          rate_8.push(rate_arr[6].to_i)\n          rate_9.push(rate_arr[7].to_i)\n          rate_10.push(rate_arr[8].to_i)\n          rate_11.push(rate_arr[9].to_i)\n          rate_12.push(rate_arr[10].to_i)\n        end\n\n        if @rating_table == 1\n          # 完全版準拠に差し替え\n          rate_12[31] = rate_12[32] = rate_12[33] = 10\n        end\n\n        newRates = [zeroArray, zeroArray, zeroArray, rate_3, rate_4, rate_5, rate_6, rate_7, rate_8, rate_9, rate_10, rate_11, rate_12]\n\n        return newRates\n      end\n\n      def rollDice(_command, _round)\n        dice_list = @randomizer.roll_barabara(2, 6)\n        total = dice_list.sum()\n        dice_str = dice_list.join(\",\")\n        return total, dice_str\n      end\n\n      # @param rating_total [Integer]\n      # @param command [SwordWorld::RatingParsed]\n      # @param diceResults [Array<String>]\n      # @param diceResultTotals [Array<String>]\n      # @param rateResults  [Array<String>]\n      # @param dice_total [Integer]\n      # @param round [Integer]\n      # @return [Array(String, Boolean, Boolean)] output, critical, fumble\n      def getResultText(rating_total, command, diceResults, diceResultTotals,\n                        rateResults, dice_total, round)\n        sequence = []\n\n        sequence.push(\"2D:[\#{diceResults.join(' ')}]=\#{diceResultTotals.join(',')}\")\n\n        if dice_total <= 2\n          sequence.push(rateResults.join(','))\n          sequence.push(translate(\"SwordWorld.fumble\"))\n          return sequence.join(\" ＞ \"), false, true\n        end\n\n        # rate回数が1回で、修正値がない時には途中式と最終結果が一致するので、途中式を省略する\n        if rateResults.size > 1 || command.modifier != 0\n          text = rateResults.join(',') + Format.modifier(command.modifier)\n          if command.half\n            text = \"(\#{text})/2\"\n            if command.modifier_after_half != 0\n              text += Format.modifier(command.modifier_after_half)\n            end\n          elsif command.one_and_a_half\n            text = \"(\#{text})*1.5\"\n            if command.modifier_after_one_and_a_half != 0\n              text += Format.modifier(command.modifier_after_one_and_a_half)\n            end\n          end\n          sequence.push(text)\n        elsif command.half\n          text = \"\#{rateResults.first}/2\"\n          if command.modifier_after_half != 0\n            text += Format.modifier(command.modifier_after_half)\n          end\n          sequence.push(text)\n        elsif command.one_and_a_half\n          text = \"\#{rateResults.first}*1.5\"\n          if command.modifier_after_one_and_a_half != 0\n            text += Format.modifier(command.modifier_after_one_and_a_half)\n          end\n          sequence.push(text)\n        end\n\n        if round > 1\n          round_text = translate(\"SwordWorld.round_text\", reroll_count: round - 1)\n          sequence.push(round_text)\n        end\n\n        total = rating_total + command.modifier\n        if command.half\n          total = (total / 2.0).ceil\n          if command.modifier_after_half != 0\n            total += command.modifier_after_half\n          end\n        elsif command.one_and_a_half\n          total = (total * 1.5).ceil\n          if command.modifier_after_one_and_a_half != 0\n            total += command.modifier_after_one_and_a_half\n          end\n        end\n\n        total_text = total.to_s\n        sequence.push(total_text)\n\n        return sequence.join(\" ＞ \"), round > 1, false\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld>", "register_prefix", "initialize", "command", "@rating_table", "0", "result_2d6", "total", "dice_total", "_dice_list", "cmp_op", "target", ">=", "12", "Result", "critical", "translate", "<=", "2", "fumble", "success", "failure", "eval_game_system_specific_command", "rating", "private", "rating_parser", "RatingParser", "new", "string", "debug", "parse", "rate_sw2_0", "getSW2_0_RatingTable", "keyMax", "-", "length", "1", ">", "rate", "infinite_roll?", "min_critical", "newRates", "getNewRates", "output", "diceResultTotals", "diceResults", "rateResults", "dice", "diceOnlyTotal", "totalValue", "round", "first_to", "first_modify", "loop", "block in rating", "block (2 levels) in rating", "rollDice", "dice_raw", "diceText", "+", "<<", "to_s", "kept_modify", "<", "currentKey", "*", "rateup", "clamp", "rateValue", "[]", "getResultText", "result_text", "tap", "r", "text=", "critical=", "fumble=", "rate_3", "rate_4", "rate_5", "rate_6", "rate_7", "rate_8", "rate_9", "rate_10", "rate_11", "rate_12", "zeroArray", "each", "block in getNewRates", "rateText", "block (2 levels) in getNewRates", "rate_arr", "split", "push", "to_i", "3", "4", "5", "6", "7", "8", "9", "10", "[]=", "31", "32", "33", "_command", "_round", "dice_list", "@randomizer", "roll_barabara", "sum", "dice_str", "join", "rating_total", "sequence", "size", "modifier", "text", "Format", "half", "modifier_after_half", "one_and_a_half", "modifier_after_one_and_a_half", "first", "round_text", "/", "ceil", "total_text", "Base"], :mappings=>"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"}}, {:offset=>{:line=>4638, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/sword_world/transcendent_test.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire \"bcdice/result\"\nrequire \"bcdice/translate\"\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld2_0 < SwordWorld\n      # 超越判定のノード\n      class TranscendentTest\n        include Translate\n\n        # @param [Integer] critical_value クリティカル値\n        # @param [Integer] modifier 修正値\n        # @param [String, nil] cmp_op 比較演算子（> または >=）\n        # @param [Integer, nil] target 目標値\n        def initialize(critical_value, modifier, cmp_op, target, locale)\n          @critical_value = critical_value\n          @modifier = modifier\n          @cmp_op = cmp_op\n          @target = target\n          @locale = locale\n\n          @modifier_str = Format.modifier(@modifier)\n          @expression = node_expression()\n        end\n\n        # 超越判定を行う\n        # @param randomizer [Randomizer]\n        # @return [String]\n        def execute(randomizer)\n          if @critical_value < 3\n            return translate(\"SwordWorld2_0.transcendent_critical_too_small\", expression: @expression)\n          end\n\n          first_value_group = randomizer.roll_barabara(2, 6)\n          value_groups = [first_value_group]\n\n          fumble = first_value_group == [1, 1]\n          critical = first_value_group == [6, 6]\n\n          unless fumble\n            while sum_of_dice(value_groups.last) >= @critical_value\n              value_groups.push(randomizer.roll_barabara(2, 6))\n            end\n          end\n\n          sum = sum_of_dice(value_groups)\n          total_sum = sum + @modifier\n\n          result = result_status(total_sum, value_groups.length, fumble, critical)\n          result_str = {\n            success: translate(\"success\"),\n            failure: translate(\"failure\"),\n            super_success: translate(\"SwordWorld2_0.super_success\"),\n            critical: translate(\"SwordWorld.critical\"),\n            fumble: translate(\"SwordWorld.fumble\"),\n          }.freeze[result]\n\n          parts = [\n            \"(\#{@expression})\",\n            \"\#{dice_str(value_groups, sum)}\#{@modifier_str}\",\n            total_sum,\n            result_str,\n          ].compact\n\n          return Result.new.tap do |r|\n            r.text = parts.join(\" ＞ \")\n            r.fumble = result == :fumble\n            r.critical = result == :critical\n            r.success = [:success, :super_success, :critical].include?(result)\n            r.failure = [:failure, :fumble].include?(result)\n          end\n        end\n\n        private\n\n        # 数式表記を返す\n        # @return [String]\n        def node_expression\n          lhs = \"2D6@\#{@critical_value}\#{@modifier_str}\"\n\n          return @target ? \"\#{lhs}\#{@cmp_op}\#{@target}\" : lhs\n        end\n\n        # 出目の合計を返す\n        # @param [(Integer, Integer), Array<(Integer, Integer)>] value_groups\n        #   出目のグループまたはその配列\n        # @return [Integer]\n        def sum_of_dice(value_groups)\n          value_groups.flatten.sum\n        end\n\n        # ダイス部分の文字列を返す\n        # @param [Array<(Integer, Integer)>] value_groups 出目のグループの配列\n        # @param [Integer] sum 出目の合計\n        # @return [String]\n        def dice_str(value_groups, sum)\n          value_groups_str =\n            value_groups\n            .map { |values| \"[\#{values.join(',')}]\" }\n            .join\n\n          return \"\#{sum}\#{value_groups_str}\"\n        end\n\n        # 判定結果の文字列を返す\n        # @param [Integer] total_sum 合計値\n        # @param [Integer] n_value_groups 出目のグループの数\n        # @param [Boolean] fumble ファンブルかどうか\n        # @param [Boolean] critical クリティカルかどうか\n        # @return [Symbol]\n        def result_status(total_sum, n_value_groups, fumble, critical)\n          return :no_target unless @target\n          return :fumble if fumble\n          return :critical if critical\n\n          if total_sum.send(@cmp_op, @target)\n            # 振り足しが行われ、合計値が41以上ならば「超成功」\n            n_value_groups >= 2 && total_sum >= 41 ? :super_success : :success\n          else\n            :failure\n          end\n        end\n      end\n    end\n  end\nend\n"], :names=>["<top (required)>", "self", "require", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld2_0>", "<class:TranscendentTest>", "include", "Translate", "initialize", "critical_value", "modifier", "cmp_op", "target", "locale", "@critical_value", "@modifier", "@cmp_op", "@target", "@locale", "@modifier_str", "Format", "@expression", "node_expression", "execute", "randomizer", "<", "3", "translate", "first_value_group", "roll_barabara", "2", "6", "value_groups", "fumble", "==", "1", "critical", ">=", "sum_of_dice", "last", "push", "sum", "total_sum", "+", "result", "result_status", "length", "result_str", "freeze", "[]", "parts", "dice_str", "compact", "tap", "Result", "new", "block in execute", "r", "block (2 levels) in execute", "text=", "join", "fumble=", "critical=", "success=", "include?", "failure=", "private", "lhs", "flatten", "value_groups_str", "map", "block in dice_str", "values", "block (2 levels) in dice_str", "n_value_groups", "send", "41", "SwordWorld"], :mappings=>"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"}}, {:offset=>{:line=>4766, :column=>0}, :map=>{:version=>3, :sourceRoot=>"", :sources=>["bcdice/game_system/SwordWorld2_0.rb"], :sourcesContent=>["# frozen_string_literal: true\n\nrequire 'bcdice/arithmetic_evaluator'\n\nrequire 'bcdice/game_system/SwordWorld'\nrequire 'bcdice/game_system/sword_world/transcendent_test'\n\nmodule BCDice\n  module GameSystem\n    class SwordWorld2_0 < SwordWorld\n      # ゲームシステムの識別子\n      ID = 'SwordWorld2.0'\n\n      # ゲームシステム名\n      NAME = 'ソード・ワールド2.0'\n\n      # ゲームシステム名の読みがな\n      SORT_KEY = 'そおとわあると2.0'\n\n      # ダイスボットの使い方\n      HELP_MESSAGE = <<~INFO_MESSAGE_TEXT\n        自動的成功、成功、失敗、自動的失敗の自動判定を行います。\n\n        ・レーティング表　(Kx)\n        　\"Kキーナンバー+ボーナス\"の形で記入します。\n        　ボーナスの部分に「K20+K30」のようにレーティングを取ることは出来ません。\n        　また、ボーナスは複数取ることが出来ます。\n        　レーティング表もダイスロールと同様に、他のプレイヤーに隠れてロールすることも可能です。\n        　例）K20　　　K10+5　　　k30　　　k10+10　　　Sk10-1　　　k10+5+2\n\n        ・クリティカル値の設定\n        　クリティカル値は\"[クリティカル値]\"で指定します。\n        　指定しない場合はクリティカル値10とします。\n        　クリティカル処理が必要ないときは13などとしてください。(防御時などの対応)\n        　またタイプの軽減化のために末尾に「@クリティカル値」でも処理するようにしました。\n        　例）K20[10]　　　K10+5[9]　　　k30[10]　　　k10[9]+10　　　k10-5@9\n\n        ・レーティング表の半減 (HKx, KxH+N)\n        　レーティング表の先頭または末尾に\"H\"をつけると、レーティング表を振って最終結果を半減させます。\n        　末尾につけた場合、直後に修正ををつけることで、半減後の加減算を行うことができます。\n        　この際、複数の項による修正にはカッコで囲うことが必要です（カッコがないとパースに失敗します）\n        　クリティカル値を指定しない場合、クリティカルなしと扱われます。\n        　例）HK20　　K20h　　HK10-5@9　　K10-5@9H　　K20gfH　　K20+8H+2　　K20+8H(1+1)\n\n        ・ダイス目の修正（運命変転やクリティカルレイ用）\n        　末尾に「$修正値」でダイス目に修正がかかります。\n        　$＋１と修正表記ならダイス目に＋修正、＄９のように固定値ならダイス目をその出目に差し替え。\n        　クリティカルした場合でも固定値や修正値の適用は最初の一回だけです。\n        　例）K20$+1　　　K10+5$9　　　k10-5@9$+2　　　k10[9]+10$9\n\n        ・首切り刀用レーティング上昇 r10\n        　例）K20r10　K30+24@8R10　K40+24@8$12r10\n\n        ・グレイテストフォーチュンは末尾に gf\n        　例）K20gf　K30+24@8GF　K40+24@8$12r10gf\n\n        ・威力表を1d+sfで参照 クリティカル後も継続 sf4\n        　例）k10sf4　k0+5SF4@13　k70+26sf3@9\n\n        ・威力表を1d+tfで参照 クリティカル後は2dで参照 tf3\n        　例）k10tf3　k0+5TF4@13　k70+26tf3@9\n\n        ・超越判定用に2d6ロールに 2D6@10 書式でクリティカル値付与が可能に。\n        　例）2D6@10　2D6@10+11>=30\n\n        ・成長　(Gr)\n        　末尾に数字を付加することで、複数回の成長をまとめて行えます。\n        　例）Gr3\n\n        ・防御ファンブル表　(FT)\n        　防御ファンブル表を出すことができます。\n\n        ・絡み効果表　(TT)\n        　絡み効果表を出すことができます。\n      INFO_MESSAGE_TEXT\n\n      register_prefix('H?K', 'Gr', '2D6?@\\d+', 'FT', 'TT')\n\n      def initialize(command)\n        super(command)\n        @rating_table = 2\n      end\n\n      def eval_game_system_specific_command(command)\n        case command\n        when /^Gr(\\d+)?/i\n          if command =~ /^Gr(\\d+)/i\n            growth(Regexp.last_match(1).to_i)\n          else\n            growth\n          end\n        when /^2D6?@\\d+/i\n          transcendent_parser = Command::Parser.new(/2D6?/i, round_type: BCDice::RoundType::CEIL)\n                                               .enable_critical\n                                               .restrict_cmp_op_to(nil, :>=, :>)\n          cmd = transcendent_parser.parse(command)\n\n          unless cmd\n            return nil\n          end\n\n          node = TranscendentTest.new(cmd.critical, cmd.modify_number, cmd.cmp_op, cmd.target_number, @locale)\n          node.execute(@randomizer)\n        when 'FT'\n          get_fumble_table\n        when 'TT'\n          get_tangle_table\n        else\n          super(command)\n        end\n      end\n\n      def rating_parser\n        return RatingParser.new(version: :v2_0)\n      end\n\n      def rollDice(command, round)\n        if command.semi_fixed_val > 0\n          # 常に片方の出目を固定\n          dice = @randomizer.roll_once(6)\n          return dice + command.semi_fixed_val, \"\#{dice},\#{command.semi_fixed_val}\"\n        elsif round == 0 && command.tmp_fixed_val > 0\n          # 回転前だけ片方の出目を固定\n          dice = @randomizer.roll_once(6)\n          return dice + command.tmp_fixed_val, \"\#{dice},\#{command.tmp_fixed_val}\"\n        elsif command.greatest_fortune\n          # グレイテスト・フォーチュン\n          dice = @randomizer.roll_once(6)\n          return dice * 2, \"\#{dice},\#{dice}\"\n        else\n          return super(command, round)\n        end\n      end\n\n      def growth(count = 1)\n        ((1..count).map { growth_step }).join \" | \"\n      end\n\n      def growth_step\n        table = DiceTable::Table.from_i18n(\"SwordWorld2_0.GrowthTable\", @locale)\n        r1 = table.roll(@randomizer)\n        r2 = table.roll(@randomizer)\n\n        return r1.value != r2.value ? \"[\#{r1.value},\#{r2.value}]->(\#{r1.body} or \#{r2.body})\" : \"[\#{r1.value},\#{r2.value}]->(\#{r1.body})\"\n      end\n\n      def get_fumble_table()\n        table = DiceTable::Table.from_i18n(\"SwordWorld2_0.FumbleTable\", @locale)\n        return table.roll(@randomizer)\n      end\n\n      def get_tangle_table()\n        table = DiceTable::Table.from_i18n(\"SwordWorld2_0.TangleTable\", @locale)\n        return table.roll(@randomizer)\n      end\n    end\n  end\nend\n"], :names=>["<main>", "self", "require", "<module:BCDice>", "<module:GameSystem>", "<class:SwordWorld2_0>", "register_prefix", "initialize", "command", "@rating_table", "2", "eval_game_system_specific_command", "$ret_or_1", "=~", "growth", "Regexp", "last_match", "1", "to_i", "transcendent_parser", "Command::Parser", "Command", "new", "BCDice::RoundType::CEIL", "BCDice::RoundType", "BCDice", "enable_critical", "restrict_cmp_op_to", "cmd", "parse", "node", "TranscendentTest", "critical", "modify_number", "cmp_op", "target_number", "@locale", "execute", "@randomizer", "get_fumble_table", "get_tangle_table", "rating_parser", "RatingParser", "rollDice", "round", ">", "semi_fixed_val", "0", "dice", "roll_once", "6", "+", "tmp_fixed_val", "greatest_fortune", "*", "count", "map", "block in growth", "block (2 levels) in growth", "growth_step", "join", "table", "DiceTable::Table", "DiceTable", "from_i18n", "r1", "roll", "r2", "value", "body", "SwordWorld"], :mappings=>"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"}}]}